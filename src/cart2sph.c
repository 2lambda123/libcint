/*
 * File: cart2sph.h
 * Author: Qiming Sun <osirpt.sun@gmail.com>
 *
 * Cartisen GTO to spheric or spinor GTO transformation
 * (and reorder the integrals from block(i,j,k,l)_{contr_idx(I,K,L,J)}
 * to (iI,jJ,kK,lL))
 */

#include <stdlib.h>
#include "cint_const.h"
#include "cint_bas.h"
#include "misc.h"


/*
 * Cartesian to real-spheric coefficients
 * ref: H. B. Schlegel and M. J.  Frisch, Int. J. Quant. Chem., 54(1995), 83-87.
 * different from the usual definition such as
 *   p_-1 p_0 p_1 => (px, py, pz) ...
 * the map here is
 *   p_-1 p_0 p_1 => (py, pz, px) ...
void fill_cart2sph(const int l, double *t)
{
        int m, lx, ly, lz;
        for (m = -l; m <= l; m++) {
                for (lx = l; lx >= 0; lx--) {
                        for (ly = *lmax - lx; ly >= 0; ly--) {
                                lz = *lmax - lx - ly;
                                *t++ = dxyzfactor_real_spheric_UPI_(&lx, &ly, &lz, &m);
                        }
                }
        }
}
 */

static const double g_trans_cart2sph[476] = {
        0.282094791773878143,
        0,
        0.488602511902919921,
        0,
        0,
        0,
        0.488602511902919921,
        0.488602511902919921,
        0,
        0,
        0,
        1.092548430592079070,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1.092548430592079070,
        0,
        -0.315391565252520002,
        0,
        0,
        -0.315391565252520002,
        0,
        0.630783130505040012,
        0,
        0,
        1.092548430592079070,
        0,
        0,
        0,
        0.546274215296039535,
        0,
        0,
        -0.546274215296039537,
        0,
        0,
        0,
        1.770130769779930531,
        0,
        0,
        0,
        0,
        -0.590043589926643510,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.890611442640554055,
        0,
        0,
        0,
        0,
        0,
        0,
        -0.457045799464465739,
        0,
        0,
        0,
        0,
        -0.457045799464465739,
        0,
        1.828183197857862944,
        0,
        0,
        0,
        -1.119528997770346170,
        0,
        0,
        0,
        0,
        -1.119528997770346170,
        0,
        0.746352665180230782,
        -0.457045799464465739,
        0,
        0,
        -0.457045799464465739,
        0,
        1.828183197857862944,
        0,
        0,
        0,
        0,
        0,
        0,
        1.445305721320277027,
        0,
        0,
        0,
        0,
        -1.445305721320277020,
        0,
        0,
        0.590043589926643510,
        0,
        0,
        -1.770130769779930530,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.503342941796704538,
        0,
        0,
        0,
        0,
        -2.503342941796704530,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        5.310392309339791593,
        0,
        0,
        0,
        0,
        0,
        0,
        -1.770130769779930530,
        0,
        0,
        0,
        0,
        -0.946174695757560014,
        0,
        0,
        0,
        0,
        -0.946174695757560014,
        0,
        5.677048174545360108,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -2.007139630671867500,
        0,
        0,
        0,
        0,
        0,
        0,
        -2.007139630671867500,
        0,
        2.676186174229156671,
        0,
        0.317356640745612911,
        0,
        0,
        0.634713281491225822,
        0,
        -2.538853125964903290,
        0,
        0,
        0,
        0,
        0.317356640745612911,
        0,
        -2.538853125964903290,
        0,
        0.846284375321634430,
        0,
        0,
        -2.007139630671867500,
        0,
        0,
        0,
        0,
        -2.007139630671867500,
        0,
        2.676186174229156671,
        0,
        0,
        0,
        0,
        0,
        -0.473087347878780002,
        0,
        0,
        0,
        0,
        2.838524087272680054,
        0,
        0,
        0,
        0,
        0.473087347878780009,
        0,
        -2.838524087272680050,
        0,
        0,
        0,
        0,
        1.770130769779930531,
        0,
        0,
        0,
        0,
        -5.310392309339791590,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0.625835735449176134,
        0,
        0,
        -3.755014412695056800,
        0,
        0,
        0,
        0,
        0,
        0,
        0.625835735449176134,
        0,
        0,
        0,
        0,
        0,
        3.281910284200850514,
        0,
        0,
        0,
        0,
        -6.563820568401701020,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0.656382056840170102,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        8.302649259524165115,
        0,
        0,
        0,
        0,
        0,
        0,
        -8.302649259524165110,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -1.467714898305751160,
        0,
        0,
        0,
        0,
        -0.978476598870500779,
        0,
        11.741719186446009300,
        0,
        0,
        0,
        0,
        0,
        0,
        0.489238299435250387,
        0,
        -3.913906395482003100,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -4.793536784973323750,
        0,
        0,
        0,
        0,
        0,
        0,
        -4.793536784973323750,
        0,
        9.587073569946647510,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0.452946651195696921,
        0,
        0,
        0,
        0,
        0.905893302391393842,
        0,
        -5.435359814348363050,
        0,
        0,
        0,
        0,
        0,
        0,
        0.452946651195696921,
        0,
        -5.435359814348363050,
        0,
        3.623573209565575370,
        0,
        0,
        0,
        1.754254836801353946,
        0,
        0,
        0,
        0,
        3.508509673602707893,
        0,
        -4.678012898136943850,
        0,
        0,
        0,
        0,
        0,
        0,
        1.754254836801353946,
        0,
        -4.678012898136943850,
        0,
        0.935602579627388771,
        0.452946651195696921,
        0,
        0,
        0.905893302391393842,
        0,
        -5.435359814348363050,
        0,
        0,
        0,
        0,
        0.452946651195696921,
        0,
        -5.435359814348363050,
        0,
        3.623573209565575370,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -2.396768392486661870,
        0,
        0,
        0,
        0,
        0,
        0,
        4.793536784973323755,
        0,
        0,
        0,
        0,
        0,
        0,
        2.396768392486661877,
        0,
        -4.793536784973323750,
        0,
        0,
        -0.489238299435250389,
        0,
        0,
        0.978476598870500775,
        0,
        3.913906395482003101,
        0,
        0,
        0,
        0,
        1.467714898305751163,
        0,
        -11.741719186446009300,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.075662314881041278,
        0,
        0,
        0,
        0,
        -12.453973889286247600,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.075662314881041278,
        0,
        0,
        0,
        0,
        0.656382056840170102,
        0,
        0,
        -6.563820568401701020,
        0,
        0,
        0,
        0,
        0,
        0,
        3.281910284200850514,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0};

/*
 * / xyz_alpha \
 * \ xyz_beta  /
 */
static const double g_trans_cart2j[3808] = {
        0,  0,
        0.282094791773878143,  0,
        0.282094791773878143,  0,
        0,  0,
       -0.282094791773878143,  0,
        0,  0.282094791773878143,
        0,  0,
        0,  0,
        0,  0,
        0.282094791773878143,  0,
        0,  0,
        0,  0,
       -0.282094791773878143,  0,
       -0.282094791773878143,  0,
        0, -0.282094791773878143,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.345494149471335479,  0,
        0, -0.345494149471335479,
        0,  0,
        0.199471140200716338,  0,
        0, -0.199471140200716338,
        0,  0,
        0,  0,
        0,  0,
        0.398942280401432677,  0,
        0,  0,
        0,  0,
        0.398942280401432677,  0,
       -0.199471140200716338,  0,
        0, -0.199471140200716338,
        0,  0,
       -0.345494149471335479,  0,
        0, -0.345494149471335479,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.345494149471335479,  0,
        0,  0.690988298942670958,
        0,  0,
        0.345494149471335479,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.345494149471335479,  0,
        0,  0,
        0, -0.345494149471335479,
        0,  0,
        0,  0,
        0,  0,
       -0.598413420602149016,  0,
        0,  0,
        0,  0.598413420602149016,
        0,  0,
       -0.199471140200716338,  0,
        0,  0,
        0,  0,
       -0.199471140200716338,  0,
        0,  0,
        0.398942280401432677,  0,
        0.199471140200716338,  0,
        0,  0,
        0,  0,
        0.199471140200716338,  0,
        0,  0,
       -0.398942280401432677,  0,
        0,  0,
        0,  0,
       -0.598413420602149016,  0,
        0,  0,
        0, -0.598413420602149016,
        0,  0,
        0,  0,
        0,  0,
        0.345494149471335479,  0,
        0,  0,
        0,  0.345494149471335479,
        0,  0,
        0.345494149471335479,  0,
        0,  0.690988298942670958,
        0,  0,
       -0.345494149471335479,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0, -0.772548404046379160,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0,  0,
        0.172747074735667739,  0,
        0, -0.345494149471335479,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.690988298942670958,  0,
        0,  0,
        0, -0.690988298942670958,
        0,  0,
        0,  0,
        0,  0,
        0.488602511902919921,  0,
        0,  0,
        0, -0.488602511902919921,
        0,  0,
       -0.244301255951459960,  0,
        0,  0,
        0,  0,
       -0.244301255951459960,  0,
        0,  0,
        0.488602511902919921,  0,
       -0.244301255951459960,  0,
        0,  0,
        0,  0,
       -0.244301255951459960,  0,
        0,  0,
        0.488602511902919921,  0,
        0,  0,
        0,  0,
       -0.488602511902919921,  0,
        0,  0,
        0, -0.488602511902919921,
        0,  0,
        0,  0,
        0,  0,
       -0.690988298942670958,  0,
        0,  0,
        0, -0.690988298942670958,
        0,  0,
        0.172747074735667739,  0,
        0,  0.345494149471335479,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0,  0.772548404046379160,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0,  1.158822606069568741,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
        0,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
        0, -0.772548404046379160,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.863735373678338698,  0,
        0,  0,
        0,  1.727470747356677396,
        0,  0,
        0,  0,
        0.863735373678338698,  0,
        0,  0,
        0,  0,
       -0.172747074735667739,  0,
        0,  0.172747074735667739,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0.690988298942670958,  0,
        0,  0.172747074735667739,
        0,  0,
        0, -0.690988298942670958,
        0,  0,
        0.244301255951459960,  0,
        0, -0.244301255951459960,
        0,  0,
        0.244301255951459960,  0,
        0,  0,
       -0.977205023805839843,  0,
        0, -0.244301255951459960,
        0,  0,
        0,  0.977205023805839843,
        0,  0,
        0,  0,
        0,  0,
       -0.732903767854379882,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.732903767854379882,  0,
        0,  0,
        0.488602511902919921,  0,
        0,  0,
        0,  0,
        0.732903767854379882,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.732903767854379882,  0,
        0,  0,
       -0.488602511902919921,  0,
        0.244301255951459960,  0,
        0,  0.244301255951459960,
        0,  0,
        0.244301255951459960,  0,
        0,  0,
       -0.977205023805839843,  0,
        0,  0.244301255951459960,
        0,  0,
        0, -0.977205023805839843,
        0,  0,
       -0.172747074735667739,  0,
        0, -0.172747074735667739,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0.690988298942670958,  0,
        0, -0.172747074735667739,
        0,  0,
        0,  0.690988298942670958,
        0,  0,
        0,  0,
        0,  0,
        0.863735373678338698,  0,
        0,  0,
        0,  1.727470747356677396,
        0,  0,
        0,  0,
       -0.863735373678338698,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0, -0.772548404046379160,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0, -1.158822606069568741,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
        0,  0,
        0,  0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0, -1.251671470898352269,
        0,  0,
       -1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0.157695782626260003,  0,
        0, -0.473087347878780009,
        0,  0,
       -0.473087347878780009,  0,
        0,  0,
        0,  0,
        0,  0.157695782626260003,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0, -1.892349391515120036,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.546274215296039535,  0,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
        0,  0,
       -0.546274215296039535,  0,
        0,  0,
        0,  0,
       -0.273137107648019767,  0,
        0,  0.273137107648019767,
        0,  0,
       -0.273137107648019767,  0,
        0,  0,
        1.092548430592079070,  0,
        0,  0.273137107648019767,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
       -0.211571093830408607,  0,
        0,  0.211571093830408607,
        0,  0,
       -0.211571093830408607,  0,
        0,  0,
        0.846284375321634430,  0,
        0,  0.211571093830408607,
        0,  0,
        0, -0.846284375321634430,
        0,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0.564189583547756286,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0.564189583547756286,  0,
        0.211571093830408607,  0,
        0,  0.211571093830408607,
        0,  0,
        0.211571093830408607,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0.211571093830408607,
        0,  0,
        0, -0.846284375321634430,
        0,  0,
        0.273137107648019767,  0,
        0,  0.273137107648019767,
        0,  0,
        0.273137107648019767,  0,
        0,  0,
       -1.092548430592079070,  0,
        0,  0.273137107648019767,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
        0,  0,
        0,  0,
        0.546274215296039535,  0,
        0,  0,
        0,  1.092548430592079070,
        0,  0,
        0,  0,
       -0.546274215296039535,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0,  1.892349391515120036,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0,
       -0.157695782626260003,  0,
        0, -0.473087347878780009,
        0,  0,
        0.473087347878780009,  0,
        0,  0,
        0,  0,
        0,  0.157695782626260003,
        0,  0,
        0,  0,
        0,  0,
       -0.417223823632784089,  0,
        0, -1.251671470898352269,
        0,  0,
        1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.417223823632784089,  0,
        0,  1.668895294531136358,
        0,  0,
        2.503342941796704538,  0,
        0,  0,
        0,  0,
        0, -1.668895294531136358,
        0,  0,
        0,  0,
        0,  0,
       -0.417223823632784089,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  0,
        0, -1.251671470898352269,
        0,  0,
        0,  0,
       -1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.103870478383820021,  0,
        0,  0,
        0,  3.311611435151460063,
        0,  0,
        0,  0,
        3.311611435151460063,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -1.103870478383820021,
        0,  0,
        0,  0,
        0,  0,
       -0.157695782626260003,  0,
        0,  0.315391565252520006,
        0,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0.315391565252520006,
        0,  0,
        0, -1.892349391515120036,
        0,  0,
        0.157695782626260003,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0,
        0.273137107648019767,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  0,
        0,  0,
       -1.638822645888118605,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  3.277645291776237211,
        0,  0,
       -0.273137107648019767,  0,
        0,  0,
        1.638822645888118605,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        0,  0.819411322944059302,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        1.092548430592079070,  0,
        0,  0,
        0,  0.819411322944059302,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
        0, -1.057855469152043038,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
       -1.410473958869390717,  0,
        0,  0,
        0, -1.057855469152043038,
        0,  0,
        0,  1.410473958869390717,
        0,  0,
        0.211571093830408607,  0,
        0,  0,
        0,  0,
        0.423142187660817215,  0,
        0,  0,
       -1.692568750643268860,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.211571093830408607,  0,
        0,  0,
       -1.692568750643268860,  0,
        0,  0,
        0.564189583547756286,  0,
       -0.211571093830408607,  0,
        0,  0,
        0,  0,
       -0.423142187660817215,  0,
        0,  0,
        1.692568750643268860,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.211571093830408607,  0,
        0,  0,
        1.692568750643268860,  0,
        0,  0,
       -0.564189583547756286,  0,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
        0,  1.057855469152043038,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
       -1.410473958869390717,  0,
        0,  0,
        0,  1.057855469152043038,
        0,  0,
        0, -1.410473958869390717,
        0,  0,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        0, -0.819411322944059302,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        1.092548430592079070,  0,
        0,  0,
        0, -0.819411322944059302,
        0,  0,
        0,  1.092548430592079070,
        0,  0,
       -0.273137107648019767,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  0,
        0,  0,
        1.638822645888118605,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  3.277645291776237211,
        0,  0,
        0.273137107648019767,  0,
        0,  0,
       -1.638822645888118605,  0,
        0,  0,
        0,  0,
        0.157695782626260003,  0,
        0,  0.315391565252520006,
        0,  0,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0.315391565252520006,
        0,  0,
        0, -1.892349391515120036,
        0,  0,
       -0.157695782626260003,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.103870478383820021,  0,
        0,  0,
        0, -3.311611435151460063,
        0,  0,
        0,  0,
        3.311611435151460063,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.103870478383820021,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  0,
        0,  1.251671470898352269,
        0,  0,
        0,  0,
       -1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  1.668895294531136358,
        0,  0,
       -2.503342941796704538,  0,
        0,  0,
        0,  0,
        0, -1.668895294531136358,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0, -1.770130769779930531,
        0,  0,
       -2.655196154669895796,  0,
        0,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0, -0.590043589926643510,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        0,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.180087179853287020,  0,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
       -3.540261539559861062,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.590043589926643510,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
       -0.295021794963321755,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0.590043589926643510,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
       -0.193137101011594790,  0,
        0,  0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0,  0.386274202023189580,
        0,  0,
        0, -2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        1.545096808092758321,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0, -1.545096808092758321,
        0,  0,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        1.261566261010080024,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0, -1.261566261010080024,
        0,  0,
        0.236543673939390004,  0,
        0,  0,
        0,  0,
        0.473087347878780009,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.236543673939390004,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0.630783130505040012,  0,
        0.236543673939390004,  0,
        0,  0,
        0,  0,
        0.473087347878780009,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.236543673939390004,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0.630783130505040012,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
       -1.261566261010080024,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0, -1.261566261010080024,
        0,  0,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
       -1.545096808092758321,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0, -1.545096808092758321,
        0,  0,
       -0.193137101011594790,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        0,  0,
       -0.295021794963321755,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  3.540261539559861062,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.590043589926643510,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.180087179853287020,  0,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
        3.540261539559861062,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0,  0.590043589926643510,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        0,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  1.770130769779930531,
        0,  0,
       -2.655196154669895796,  0,
        0,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0,  2.212663462224913163,
        0,  0,
        4.425326924449826327,  0,
        0,  0,
        0,  0,
        0, -4.425326924449826327,
        0,  0,
        0,  0,
        0,  0,
       -2.212663462224913163,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.442532692444982632,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
       -2.655196154669895796,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.327598077334947898,  0,
        0,  0,
        0,  5.310392309339791593,
        0,  0,
        0,  0,
        7.965588464009687389,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -5.310392309339791593,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.327598077334947898,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.147510897481660877,  0,
        0,  0.442532692444982632,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
        1.180087179853287020,  0,
        0,  0.295021794963321755,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
       -3.540261539559861062,  0,
        0,  0,
        0,  0,
        0, -0.147510897481660877,
        0,  0,
        0,  1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0.295021794963321755,  0,
        0, -0.885065384889965265,
        0,  0,
       -0.590043589926643510,  0,
        0,  0,
       -2.360174359706574041,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  7.080523079119722124,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        7.080523079119722124,  0,
        0,  0,
        0,  0,
        0,  0.295021794963321755,
        0,  0,
        0, -2.360174359706574041,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
        0.885065384889965265,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.351959707081163531,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -2.703919414162327062,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  5.407838828324654124,
        0,  0,
        0,  0,
       -1.351959707081163531,  0,
        0,  0,
        2.703919414162327062,  0,
        0,  0,
        0,  0,
        0.193137101011594790,  0,
        0, -0.193137101011594790,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
       -2.317645212139137482,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -2.317645212139137482,  0,
        0,  0,
        1.545096808092758321,  0,
        0, -0.193137101011594790,
        0,  0,
        0,  2.317645212139137482,
        0,  0,
        0, -1.545096808092758321,
        0,  0,
       -0.236543673939390004,  0,
        0,  0.236543673939390004,
        0,  0,
       -0.473087347878780009,  0,
        0,  0,
        2.838524087272680054,  0,
        0,  0.473087347878780009,
        0,  0,
        0, -2.838524087272680054,
        0,  0,
       -0.236543673939390004,  0,
        0,  0,
        2.838524087272680054,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0.236543673939390004,
        0,  0,
        0, -2.838524087272680054,
        0,  0,
        0,  1.892349391515120036,
        0,  0,
        0,  0,
        0,  0,
        1.182718369696950022,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.365436739393900045,  0,
        0,  0,
       -3.153915652525200060,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.182718369696950022,  0,
        0,  0,
       -3.153915652525200060,  0,
        0,  0,
        0.630783130505040012,  0,
        0,  0,
        0,  0,
       -1.182718369696950022,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -2.365436739393900045,  0,
        0,  0,
        3.153915652525200060,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.182718369696950022,  0,
        0,  0,
        3.153915652525200060,  0,
        0,  0,
       -0.630783130505040012,  0,
       -0.236543673939390004,  0,
        0, -0.236543673939390004,
        0,  0,
       -0.473087347878780009,  0,
        0,  0,
        2.838524087272680054,  0,
        0, -0.473087347878780009,
        0,  0,
        0,  2.838524087272680054,
        0,  0,
       -0.236543673939390004,  0,
        0,  0,
        2.838524087272680054,  0,
        0,  0,
       -1.892349391515120036,  0,
        0, -0.236543673939390004,
        0,  0,
        0,  2.838524087272680054,
        0,  0,
        0, -1.892349391515120036,
        0,  0,
        0.193137101011594790,  0,
        0,  0.193137101011594790,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
       -2.317645212139137482,  0,
        0,  0.386274202023189580,
        0,  0,
        0, -2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -2.317645212139137482,  0,
        0,  0,
        1.545096808092758321,  0,
        0,  0.193137101011594790,
        0,  0,
        0, -2.317645212139137482,
        0,  0,
        0,  1.545096808092758321,
        0,  0,
        0,  0,
        0,  0,
       -1.351959707081163531,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.703919414162327062,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  5.407838828324654124,
        0,  0,
        0,  0,
        1.351959707081163531,  0,
        0,  0,
       -2.703919414162327062,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.885065384889965265,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0,
        0,  0,
        0.295021794963321755,  0,
        0,  0.885065384889965265,
        0,  0,
       -0.590043589926643510,  0,
        0,  0,
       -2.360174359706574041,  0,
        0,  0.590043589926643510,
        0,  0,
        0, -7.080523079119722124,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        7.080523079119722124,  0,
        0,  0,
        0,  0,
        0, -0.295021794963321755,
        0,  0,
        0,  2.360174359706574041,
        0,  0,
        0,  0,
        0,  0,
       -0.147510897481660877,  0,
        0, -0.442532692444982632,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
        1.180087179853287020,  0,
        0, -0.295021794963321755,
        0,  0,
        0,  3.540261539559861062,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
       -3.540261539559861062,  0,
        0,  0,
        0,  0,
        0,  0.147510897481660877,
        0,  0,
        0, -1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.327598077334947898,  0,
        0,  0,
        0,  5.310392309339791593,
        0,  0,
        0,  0,
       -7.965588464009687389,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -5.310392309339791593,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.327598077334947898,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
        2.655196154669895796,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0, -2.212663462224913163,
        0,  0,
        4.425326924449826327,  0,
        0,  0,
        0,  0,
        0,  4.425326924449826327,
        0,  0,
        0,  0,
        0,  0,
       -2.212663462224913163,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.442532692444982632,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.464132203440858160,  0,
        0, -2.320661017204290803,
        0,  0,
       -4.641322034408581606,  0,
        0,  0,
        0,  0,
        0,  4.641322034408581606,
        0,  0,
        0,  0,
        0,  0,
        2.320661017204290803,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.464132203440858160,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.139941124721293271,  0,
        0, -0.699705623606466358,
        0,  0,
       -1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  1.399411247212932717,
        0,  0,
        0,  0,
        0,  0,
        0.699705623606466358,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.139941124721293271,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0, -5.597644988851730871,
        0,  0,
        0,  0,
       -8.396467483277596306,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  5.597644988851730871,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0, -2.503342941796704538,
        0,  0,
        0,  0,
       -3.755014412695056807,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.312917867724588067,  0,
        0,  0.938753603173764201,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        2.503342941796704538,  0,
        0,  0.625835735449176134,
        0,  0,
        0, -7.510028825390113615,
        0,  0,
        0.938753603173764201,  0,
        0,  0,
       -7.510028825390113615,  0,
        0,  0,
        0,  0,
        0, -0.312917867724588067,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
       -0.180663215165034628,  0,
        0,  0.541989645495103885,
        0,  0,
        0.361326430330069256,  0,
        0,  0,
        1.445305721320277027,  0,
        0,  0.361326430330069256,
        0,  0,
        0, -4.335917163960831083,
        0,  0,
        0.541989645495103885,  0,
        0,  0,
       -4.335917163960831083,  0,
        0,  0,
        0,  0,
        0, -0.180663215165034628,
        0,  0,
        0,  1.445305721320277027,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.445305721320277027,  0,
        0,  0,
        0,  2.890611442640554055,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.890611442640554055,  0,
        0,  0,
        0,  2.890611442640554055,
        0,  0,
        0, -5.781222885281108110,
        0,  0,
        0,  0,
        1.445305721320277027,  0,
        0,  0,
       -2.890611442640554055,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.021985476433282363,  0,
        0,  0,
        0,  2.043970952866564726,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.043970952866564726,  0,
        0,  0,
        0,  2.043970952866564726,
        0,  0,
        0, -4.087941905733129453,
        0,  0,
        0,  0,
        1.021985476433282363,  0,
        0,  0,
       -2.043970952866564726,  0,
        0,  0,
        0,  0,
        0.255496369108320590,  0,
        0, -0.255496369108320590,
        0,  0,
        0.510992738216641181,  0,
        0,  0,
       -3.065956429299847090,  0,
        0, -0.510992738216641181,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
        0.255496369108320590,  0,
        0,  0,
       -3.065956429299847090,  0,
        0,  0,
        2.043970952866564726,  0,
        0, -0.255496369108320590,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0.215933843419584674,  0,
        0, -0.215933843419584674,
        0,  0,
        0.431867686839169349,  0,
        0,  0,
       -2.591206121035016094,  0,
        0, -0.431867686839169349,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
        0.215933843419584674,  0,
        0,  0,
       -2.591206121035016094,  0,
        0,  0,
        1.727470747356677396,  0,
        0, -0.215933843419584674,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
        0, -1.727470747356677396,
        0,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.591206121035016094,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0.690988298942670958,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.591206121035016094,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0.690988298942670958,  0,
       -0.215933843419584674,  0,
        0, -0.215933843419584674,
        0,  0,
       -0.431867686839169349,  0,
        0,  0,
        2.591206121035016094,  0,
        0, -0.431867686839169349,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
       -0.215933843419584674,  0,
        0,  0,
        2.591206121035016094,  0,
        0,  0,
       -1.727470747356677396,  0,
        0, -0.215933843419584674,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
        0, -1.727470747356677396,
        0,  0,
       -0.255496369108320590,  0,
        0, -0.255496369108320590,
        0,  0,
       -0.510992738216641181,  0,
        0,  0,
        3.065956429299847090,  0,
        0, -0.510992738216641181,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
       -0.255496369108320590,  0,
        0,  0,
        3.065956429299847090,  0,
        0,  0,
       -2.043970952866564726,  0,
        0, -0.255496369108320590,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0,  0,
        0,  0,
       -1.021985476433282363,  0,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.043970952866564726,  0,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0,  4.087941905733129453,
        0,  0,
        0,  0,
        1.021985476433282363,  0,
        0,  0,
       -2.043970952866564726,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.445305721320277027,  0,
        0,  0,
        0, -2.890611442640554055,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.890611442640554055,  0,
        0,  0,
        0, -2.890611442640554055,
        0,  0,
        0,  5.781222885281108110,
        0,  0,
        0,  0,
        1.445305721320277027,  0,
        0,  0,
       -2.890611442640554055,  0,
        0,  0,
        0,  0,
        0.180663215165034628,  0,
        0,  0.541989645495103885,
        0,  0,
       -0.361326430330069256,  0,
        0,  0,
       -1.445305721320277027,  0,
        0,  0.361326430330069256,
        0,  0,
        0, -4.335917163960831083,
        0,  0,
       -0.541989645495103885,  0,
        0,  0,
        4.335917163960831083,  0,
        0,  0,
        0,  0,
        0, -0.180663215165034628,
        0,  0,
        0,  1.445305721320277027,
        0,  0,
        0,  0,
        0,  0,
        0.312917867724588067,  0,
        0,  0.938753603173764201,
        0,  0,
       -0.625835735449176134,  0,
        0,  0,
       -2.503342941796704538,  0,
        0,  0.625835735449176134,
        0,  0,
        0, -7.510028825390113615,
        0,  0,
       -0.938753603173764201,  0,
        0,  0,
        7.510028825390113615,  0,
        0,  0,
        0,  0,
        0, -0.312917867724588067,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
       -3.755014412695056807,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  5.597644988851730871,
        0,  0,
        0,  0,
       -8.396467483277596306,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -5.597644988851730871,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.139941124721293271,  0,
        0, -0.699705623606466358,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  1.399411247212932717,
        0,  0,
        0,  0,
        0,  0,
       -0.699705623606466358,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.139941124721293271,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.464132203440858160,  0,
        0, -2.320661017204290803,
        0,  0,
        4.641322034408581606,  0,
        0,  0,
        0,  0,
        0,  4.641322034408581606,
        0,  0,
        0,  0,
        0,  0,
       -2.320661017204290803,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.464132203440858160,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0};

struct cart2sp_t {
        const double *cart2sph;
        const double *cart2j_lt_l; // j < l, kappa > 0
        const double *cart2j_gt_l; // j > l, kappa < 0
};

// [*] = n(n+1)(n+2)(n+3)/4+(n+1)(n+2)(n+3)/6
static struct cart2sp_t g_c2s[6] = {
        {g_trans_cart2sph    , g_trans_cart2j     , g_trans_cart2j     },
        {g_trans_cart2sph+1  , g_trans_cart2j+8   , g_trans_cart2j+32  },
        {g_trans_cart2sph+10 , g_trans_cart2j+80  , g_trans_cart2j+176 },
        {g_trans_cart2sph+40 , g_trans_cart2j+320 , g_trans_cart2j+560 },
        {g_trans_cart2sph+110, g_trans_cart2j+880 , g_trans_cart2j+1360},
        {g_trans_cart2sph+245, g_trans_cart2j+1960, g_trans_cart2j+2800}};




/*************************************************
 *
 * transform matrices
 *
 *************************************************/

#define C2S(KEY) \
void c2s_##KEY(double *opij, const double *gctr, \
               const int *shls, const int *bas) \
{ \
        const double Z1[] = {1, 0}; \
        KEY(opij, gctr, Z1, shls, bas); \
}

/* c2s transformation * #C(0 1) */
#define C2Si(KEY) \
void c2s_##KEY##i(double *opij, const double *gctr, \
                  const int *shls, const int *bas) \
{ \
        const double ZI[] = {0, 1}; \
        KEY(opij, gctr, ZI, shls, bas); \
}
/*
 * (i,k,l,j) -> (k,i,j,l)
 */
static void dswap_ik_jl(double *new, const double *old,
                        const int ni, const int nj, const int nk, const int nl)
{
        int j, l;
        int dlo = ni * nk; // shift of (i,k,l++,j)
        int djo = ni * nk * nl; // shift of (i,k,l,j++)
        int djn = nk * ni; // shift of (k,i,j++,l)
        int dln = nk * ni * nj; // shift of (k,i,j,l++)

        for (l = 0; l < nl; l++)
                for (j = 0; j < nj; j++) {
                        dmat_transpose(new + l * dln + j * djn,
                                       old + l * dlo + j * djo, ni, nk);
                }
}

/*
 * (i,k,l,j) -> (k,i,j,l)
 */
static void zswap_ik_jl(double *new, const double *old,
                        const int ni, const int nj, const int nk, const int nl)
{
        int j, l;
        int dlo = ni * nk * OF_CMPLX; // shift of (i,k,l++,j)
        int djo = ni * nk * nl * OF_CMPLX; // shift of (i,k,l,j++)
        int djn = nk * ni * OF_CMPLX; // shift of (k,i,j++,l)
        int dln = nk * ni * nj * OF_CMPLX; // shift of (k,i,j,l++)

        for (l = 0; l < nl; l++)
                for (j = 0; j < nj; j++) {
                        zmat_transpose(new + l * dln + j * djn,
                                       old + l * dlo + j * djo, ni, nk);
                }
}


static void dcopy_ij(double *opij, const double *gctr, 
                     const int ni, const int nj, const int mi, const int mj)
{
        int i, j, n;

        n = 0;
        for (j = 0; j < mj; j++) {
                for (i = 0; i < mi; i++) {
                        opij[i] = gctr[n];
                        n++;
                }
                opij += ni;
        }
}

/*
 * fijkl(ic:ic-1+di,jc:jc-1+dj,kc:kc-1+dk,lc:lc-1+dl)
 * fijkl(ni,nj,nk,nl), gctr(mk,mi,mj,ml)
 * gctr(k,i,j,l) -> fijkl(i,j,k,l)
 */
static void dcopy_kijl(double *fijkl, const double *gctr, 
                       const int ni, const int nj, const int nk, const int nl,
                       const int mi, const int mj, const int mk, const int ml)
{
        int i, j, k, l;
        double *pl, *pk, *pj;
        const double *pgctr;

        for (l = 0; l < ml; l++) {
                pl = fijkl + l * nk * ni * nj;
                for (k = 0; k < mk; k++) {
                        pk = pl + k * ni * nj;
                        pgctr = gctr + l * mk * mi * mj + k;
                        for (j = 0; j < mj; j++) {
                                pj = pk + j * ni;
                                for (i = 0; i < mi; i++) {
                                        pj[i] = *pgctr;
                                        pgctr += mk;
                                }
                        }
                }
        }
}

static void zcopy_kijl(double *fijkl, const double *gctr,
                       const int ni, const int nj, const int nk, const int nl,
                       const int mi, const int mj, const int mk, const int ml)
{
        int i, j, k, l;
        double *pl, *pk, *pj;
        const double *pgctr;

        for (l = 0; l < ml; l++) {
                pl = fijkl + l * nk * ni * nj * OF_CMPLX;
                for (k = 0; k < mk; k++) {
                        pk = pl + k * ni * nj * OF_CMPLX;
                        pgctr = gctr + (l * mk * mi * mj + k) * OF_CMPLX;
                        for (j = 0; j < mj; j++) {
                                pj = pk + j * ni * OF_CMPLX;
                                for (i = 0; i < mi * OF_CMPLX; i += OF_CMPLX) {
                                        pj[i+0] = pgctr[0];
                                        pj[i+1] = pgctr[1];
                                        pgctr += mk * OF_CMPLX;
                                }
                        }
                }
        }
}

/*
 * gctr(i,k,l,j) -> fijkl(i,j,k,l)
 */
static void dcopy_iklj(double *fijkl, const double *gctr, 
                       const int ni, const int nj, const int nk, const int nl,
                       const int mi, const int mj, const int mk, const int ml)
{
        int i, j, k, l;
        double *pl, *pk, *pj;
        const double *pgctr;

        for (l = 0; l < ml; l++) {
                pl = fijkl + l * nk * ni * nj;
                for (k = 0; k < mk; k++) {
                        pk = pl + k * ni * nj;
                        pgctr = gctr + l * mi * mk + k * mi;
                        for (j = 0; j < mj; j++) {
                                pj = pk + j * ni;
                                for (i = 0; i < mi; i++) {
                                        pj[i] = pgctr[i];
                                }
                                pgctr += mi * mk * ml;
                        }
                }
        }
}


/*
 * 1e integrals, cartesian to real spheric.
 */
void c2s_sph_1e(double *opij, const double *gctr, const int *shls,
                const int *bas)
{
        const double D0[] = {0};
        const double D1[] = {1};
        const char TRANS_N[] = {'N'};
        const char TRANS_T[] = {'T'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int di = i_l * 2 + 1;
        const int dj = j_l * 2 + 1;
        const int ni = di * i_ctr;
        const int nj = dj * j_ctr;
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nf = nfi * nfj;
        int ic, jc;
        double *const tmp1 = (double *)malloc(sizeof(double) * di*nfj);

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        dgemm_(TRANS_T, TRANS_N, &di, &nfj, &nfi,
                               D1, g_c2s[i_l].cart2sph, &nfi, gctr, &nfi,
                               D0, tmp1, &di);
                        dgemm_(TRANS_N, TRANS_N, &di, &dj, &nfj,
                               D1, tmp1, &di, g_c2s[j_l].cart2sph, &nfj,
                               D0, opij + ni * jc + ic, &ni);
                        gctr += nf;
                }
        free(tmp1);
}


/*
 * 1e integrals, cartesian to spin free spinor.
 */
static void sf_1e(double *opij, const double *gctr, const double *zfac,
                  const int *shls, const int *bas)
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_N[] = {'N'};
        const char TRANS_C[] = {'C'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int di = len_spinor(i_sh, bas);
        const int dj = len_spinor(j_sh, bas);
        const int ni = di * i_ctr;
        const int nj = dj * j_ctr;
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nf2i = nfi + nfi;
        const int nf2j = nfj + nfj;
        const int nf = nfi * nfj;
        const int nij = di * nfj;
        int ic, jc;
        const double *c2s_i, *c2s_j;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nf2j * OF_CMPLX);

        if (bas(KAPPA_OF, i_sh) < 0) { // j = l + 1/2
                c2s_i = g_c2s[i_l].cart2j_gt_l;
        } else {
                c2s_i = g_c2s[i_l].cart2j_lt_l;
        }
        if (bas(KAPPA_OF, j_sh) < 0) { // j = l + 1/2
                c2s_j = g_c2s[j_l].cart2j_gt_l;
        } else {
                c2s_j = g_c2s[j_l].cart2j_lt_l;
        }

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        dcmplx_re(nf, tmp1, gctr);
                        gctr += nf;

                        zgemm_(TRANS_C, TRANS_N, &di, &nfj, &nfi,
                               Z1, c2s_i, &nf2i, tmp1, &nfi,
                               Z0, tmp2, &di);
                        zgemm_(TRANS_C, TRANS_N, &di, &nfj, &nfi,
                               Z1, c2s_i + nfi * OF_CMPLX, &nf2i, tmp1, &nfi,
                               Z0, tmp2 + nij * OF_CMPLX, &di);

                        zgemm_(TRANS_N, TRANS_N, &di, &dj, &nf2j,
                               zfac, tmp2, &di, c2s_j, &nf2j, 
                               Z0, opij + (ni * jc + ic) * OF_CMPLX, &ni);
                }

        free(tmp1);
        free(tmp2);
}


/*
 * 1e integrals, cartesian to spinor.
 */
static void si_1e(double *opij, const double *gctr, const double *zfac,
                  const int *shls, const int *bas)
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_N[] = {'N'};
        const char TRANS_C[] = {'C'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int di = len_spinor(i_sh, bas);
        const int dj = len_spinor(j_sh, bas);
        const int ni = di * i_ctr;
        const int nj = dj * j_ctr;
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nf2i = nfi + nfi;
        const int nf2j = nfj + nfj;
        const int nf = nfi * nfj;
        int ic, jc;
        const double *c2s_i, *c2s_j;
        const double *gc_x = gctr;
        const double *gc_y = gc_x + nf * i_ctr * j_ctr;
        const double *gc_z = gc_y + nf * i_ctr * j_ctr;
        const double *gc_1 = gc_z + nf * i_ctr * j_ctr;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf * 2 * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nf2j * OF_CMPLX);

        if (bas(KAPPA_OF, i_sh) < 0) { // j = l + 1/2
                c2s_i = g_c2s[i_l].cart2j_gt_l;
        } else {
                c2s_i = g_c2s[i_l].cart2j_lt_l;
        }
        if (bas(KAPPA_OF, j_sh) < 0) { // j = l + 1/2
                c2s_j = g_c2s[j_l].cart2j_gt_l;
        } else {
                c2s_j = g_c2s[j_l].cart2j_lt_l;
        }

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        //cmplx( gctr.POS_1, gctr.POS_Z)
                        //cmplx( gctr.POS_Y, gctr.POS_X)
                        dcmplx_pp(nf, tmp1, gc_1, gc_z);
                        dcmplx_pp(nf, tmp1 + nf * OF_CMPLX, gc_y, gc_x);
                        zgemm_(TRANS_C, TRANS_N, &di, &nf2j, &nfi,
                               Z1, c2s_i, &nf2i, tmp1, &nfi,
                               Z0, tmp2, &di);

                        //cmplx(-gctr.POS_Y, gctr.POS_X)
                        //cmplx( gctr.POS_1,-gctr.POS_Z)
                        dcmplx_np(nf, tmp1, gc_y, gc_x);
                        dcmplx_pn(nf, tmp1 + nf * OF_CMPLX, gc_1, gc_z);
                        zgemm_(TRANS_C, TRANS_N, &di, &nf2j, &nfi,
                               Z1, c2s_i + nfi * OF_CMPLX, &nf2i, tmp1, &nfi,
                               Z1, tmp2, &di);

                        zgemm_(TRANS_N, TRANS_N, &di, &dj, &nf2j,
                               zfac, tmp2, &di, c2s_j, &nf2j, 
                               Z0, opij + (ni * jc + ic) * OF_CMPLX, &ni);

                        gc_x += nf;
                        gc_y += nf;
                        gc_z += nf;
                        gc_1 += nf;
                }
        free(tmp1);
        free(tmp2);
}


/*
 * 2e integrals, cartesian to real spheric.
 *
 * gctr: Cartesian GTO integrals, ordered as <ik|lj>
 */
void c2s_sph_2e1(double *fkijl, const double *gctr, const int *shls,
                 const int *bas)
{
        const double D0[] = {0};
        const double D1[] = {1};
        const char TRANS_N[] = {'N'};
        const char TRANS_T[] = {'T'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int k_sh = shls[2];
        const int l_sh = shls[3];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int k_l = bas(ANG_OF, k_sh);
        const int l_l = bas(ANG_OF, l_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int k_ctr = bas(NCTR_OF, k_sh);
        const int l_ctr = bas(NCTR_OF, l_sh);
        const int di = i_l * 2 + 1;
        const int dj = j_l * 2 + 1;
        const int dk = k_l * 2 + 1;
        const int dl = l_l * 2 + 1;
        const int ni = di * i_ctr;
        const int nj = dj * j_ctr;
        const int nk = dk * k_ctr;
        const int nl = dl * l_ctr;
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nfk = len_cart(k_l);
        const int nfl = len_cart(l_l);
        const int nf = nfi * nfk * nfl * nfj;
        const int d_i = di * nfk * nfl;
        const int d_j = nfk * nfl * nfj;
        const int d_k = dk * di * dj;
        const int d_l = di * dj * nfl;
        int ofj = ni;
        int ofk = ni * nj;
        int ofl = nk * ni * nj;
        int ic, jc, kc, lc;
        double *pfkijl;
        double *const tmp1 = (double *)malloc(sizeof(double) * di*nfk*nfl*nfj);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nfj);

        for (lc = 0; lc < nl; lc += dl)
                for (kc = 0; kc < nk; kc += dk)
                        for (jc = 0; jc < nj; jc += dj)
                                for (ic = 0; ic < ni; ic += di) {
                                        dgemm_(TRANS_T, TRANS_N, &di, &d_j, &nfi,
                                               D1, g_c2s[i_l].cart2sph, &nfi,
                                               gctr, &nfi,
                                               D0, tmp1, &di);
                                        dgemm_(TRANS_N, TRANS_N, &d_i, &dj, &nfj,
                                               D1, tmp1, &d_i,
                                               g_c2s[j_l].cart2sph, &nfj,
                                               D0, tmp2, &d_i);
                                        gctr += nf;

                                        dswap_ik_jl(tmp1, tmp2, di, dj, nfk, nfl);
                                        dgemm_(TRANS_T, TRANS_N, &dk, &d_l, &nfk,
                                               D1, g_c2s[k_l].cart2sph, &nfk,
                                               tmp1, &nfk,
                                               D0, tmp2, &dk);
                                        dgemm_(TRANS_N, TRANS_N, &d_k, &dl, &nfl,
                                               D1, tmp2, &d_k,
                                               g_c2s[l_l].cart2sph, &nfl,
                                               D0, tmp1, &d_k);
                                        pfkijl = fkijl + ofl * lc + ofk * kc
                                                + ofj * jc + ic;

                                        dcopy_kijl(pfkijl, tmp1, 
                                                   ni, nj, nk, nl,
                                                   di, dj, dk, dl);
                                }

        free(tmp1);
        free(tmp2);
}
void c2s_sph_2e2() {};


/*
 * 2e integrals, cartesian to spin free spinor for electron 1.
 *
 * gctr: Cartesian GTO integrals, ordered as <ik|lj>
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
static void sf_2e1(double *opij, const double *gctr, const double *zfac,
                   const int *shls, const int *bas)
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_N[] = {'N'};
        const char TRANS_C[] = {'C'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int k_sh = shls[2];
        const int l_sh = shls[3];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int k_l = bas(ANG_OF, k_sh);
        const int l_l = bas(ANG_OF, l_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int k_ctr = bas(NCTR_OF, k_sh);
        const int l_ctr = bas(NCTR_OF, l_sh);
        const int di = len_spinor(i_sh, bas);
        const int dj = len_spinor(j_sh, bas);
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nfk = len_cart(k_l);
        const int nfl = len_cart(l_l);
        const int nf2i = nfi + nfi;
        const int nf2j = nfj + nfj;
        const int nf = nfi * nfk * nfl * nfj;
        const int no = di * nfk * nfl * dj;
        const int d_i = di * nfk * nfl;
        const int d_j = nfk * nfl * nfj;
        const int nij = d_i * nfj;
        int i;
        const double *c2s_i, *c2s_j;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nf2j * OF_CMPLX);

        if (bas(KAPPA_OF, i_sh) < 0) { // j = l + 1/2
                c2s_i = g_c2s[i_l].cart2j_gt_l;
        } else {
                c2s_i = g_c2s[i_l].cart2j_lt_l;
        }
        if (bas(KAPPA_OF, j_sh) < 0) { // j = l + 1/2
                c2s_j = g_c2s[j_l].cart2j_gt_l;
        } else {
                c2s_j = g_c2s[j_l].cart2j_lt_l;
        }

        for (i = 0; i < i_ctr * j_ctr * k_ctr * l_ctr; i++) {
                dcmplx_re(nf, tmp1, gctr);
                gctr += nf;

                zgemm_(TRANS_C, TRANS_N, &di, &d_j, &nfi,
                       Z1, c2s_i, &nf2i, tmp1, &nfi,
                       Z0, tmp2, &di);
                zgemm_(TRANS_C, TRANS_N, &di, &d_j, &nfi,
                       Z1, c2s_i + nfi * OF_CMPLX, &nf2i, tmp1, &nfi,
                       Z0, tmp2 + nij * OF_CMPLX, &di);

                zgemm_(TRANS_N, TRANS_N, &d_i, &dj, &nf2j,
                       zfac, tmp2, &d_i, c2s_j, &nf2j, 
                       Z0, opij, &d_i);
                opij += no * OF_CMPLX;
        }

        free(tmp1);
        free(tmp2);
}


/*
 * 2e integrals, cartesian to spin free spinor for electron 2.
 *
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
static void sf_2e2(double *fkijl, const double *opij, const double *zfac,
                   const int *shls, const int *bas)
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_N[] = {'N'};
        const char TRANS_C[] = {'C'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int k_sh = shls[2];
        const int l_sh = shls[3];
        const int k_l = bas(ANG_OF, k_sh);
        const int l_l = bas(ANG_OF, l_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int k_ctr = bas(NCTR_OF, k_sh);
        const int l_ctr = bas(NCTR_OF, l_sh);
        const int di = len_spinor(i_sh, bas);
        const int dj = len_spinor(j_sh, bas);
        const int dk = len_spinor(k_sh, bas);
        const int dl = len_spinor(l_sh, bas);
        const int ni = di * i_ctr;
        const int nj = dj * j_ctr;
        const int nk = dk * k_ctr;
        const int nl = dl * l_ctr;
        const int nfk = len_cart(k_l);
        const int nfl = len_cart(l_l);
        const int nf2k = nfk + nfk;
        const int nf2l = nfl + nfl;
        const int d_k = dk * di * dj;
        const int d_l = di * dj * nfl;
        const int nop = nfk * di * dj * nfl;
        const int nkl = d_k * nfl;
        int ofj = ni;
        int ofk = ni * nj;
        int ofl = nk * ni * nj;
        int ic, jc, kc, lc;
        const double *c2s_k, *c2s_l;
        double *pfkijl;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2k*di*dj*nf2l * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * dk*di*dj*nf2l * OF_CMPLX);

        if (bas(KAPPA_OF, k_sh) < 0) { // j = l + 1/2
                c2s_k = g_c2s[k_l].cart2j_gt_l;
        } else {
                c2s_k = g_c2s[k_l].cart2j_lt_l;
        }
        if (bas(KAPPA_OF, l_sh) < 0) { // j = l + 1/2
                c2s_l = g_c2s[l_l].cart2j_gt_l;
        } else {
                c2s_l = g_c2s[l_l].cart2j_lt_l;
        }

        for (lc = 0; lc < nl; lc += dl)
                for (kc = 0; kc < nk; kc += dk)
                        for (jc = 0; jc < nj; jc += dj)
                                for (ic = 0; ic < ni; ic += di) {
                                        zswap_ik_jl(tmp1, opij, di, dj, nfk, nfl);

                                        zgemm_(TRANS_C, TRANS_N, &dk, &d_l, &nfk,
                                               Z1, c2s_k, &nf2k, tmp1, &nfk,
                                               Z0, tmp2, &dk);
                                        zgemm_(TRANS_C, TRANS_N, &dk, &d_l, &nfk,
                                               Z1, c2s_k + nfk * OF_CMPLX, &nf2k, tmp1, &nfk,
                                               Z0, tmp2 + nkl * OF_CMPLX, &dk);

                                        zgemm_(TRANS_N, TRANS_N, &d_k, &dl, &nf2l,
                                               zfac, tmp2, &d_k, c2s_l, &nf2l, 
                                               Z0, tmp1, &d_k);
                                        pfkijl = fkijl + (ofl * lc + ofk * kc
                                                + ofj * jc + ic) * OF_CMPLX;

                                        zcopy_kijl(pfkijl, tmp1, 
                                                   ni, nj, nk, nl,
                                                   di, dj, dk, dl);
                                        opij += nop * OF_CMPLX;
                                }

        free(tmp1);
        free(tmp2);
}

/*
 * 2e integrals, cartesian to spinor for electron 1.
 *
 * gctr: Cartesian GTO integrals, ordered as <ik|lj>
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
static void si_2e1(double *opij, const double *gctr, const double *zfac,
                   const int *shls, const int *bas)
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_N[] = {'N'};
        const char TRANS_C[] = {'C'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int k_sh = shls[2];
        const int l_sh = shls[3];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int k_l = bas(ANG_OF, k_sh);
        const int l_l = bas(ANG_OF, l_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int k_ctr = bas(NCTR_OF, k_sh);
        const int l_ctr = bas(NCTR_OF, l_sh);
        const int di = len_spinor(i_sh, bas);
        const int dj = len_spinor(j_sh, bas);
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nfk = len_cart(k_l);
        const int nfl = len_cart(l_l);
        const int nf2i = nfi + nfi;
        const int nf2j = nfj + nfj;
        const int nf = nfi * nfk * nfl * nfj;
        const int no = di * nfk * nfl * dj;
        const int d_i = di * nfk * nfl;
        const int d_j = nfk * nfl * nf2j;
        int i;
        const double *c2s_i, *c2s_j;
        const double *gc_x = gctr;
        const double *gc_y = gc_x + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        const double *gc_z = gc_y + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        const double *gc_1 = gc_z + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf * 2 * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nf2j * OF_CMPLX);

        if (bas(KAPPA_OF, i_sh) < 0) { // j = l + 1/2
                c2s_i = g_c2s[i_l].cart2j_gt_l;
        } else {
                c2s_i = g_c2s[i_l].cart2j_lt_l;
        }
        if (bas(KAPPA_OF, j_sh) < 0) { // j = l + 1/2
                c2s_j = g_c2s[j_l].cart2j_gt_l;
        } else {
                c2s_j = g_c2s[j_l].cart2j_lt_l;
        }

        for (i = 0; i < i_ctr * j_ctr * k_ctr * l_ctr; i++) {
                //cmplx( gctr.POS_1, gctr.POS_Z)
                //cmplx( gctr.POS_Y, gctr.POS_X)
                dcmplx_pp(nf, tmp1, gc_1, gc_z);
                dcmplx_pp(nf, tmp1 + nf * OF_CMPLX, gc_y, gc_x);
                zgemm_(TRANS_C, TRANS_N, &di, &d_j, &nfi,
                       Z1, c2s_i, &nf2i, tmp1, &nfi,
                       Z0, tmp2, &di);

                //cmplx(-gctr.POS_Y, gctr.POS_X)
                //cmplx( gctr.POS_1,-gctr.POS_Z)
                dcmplx_np(nf, tmp1, gc_y, gc_x);
                dcmplx_pn(nf, tmp1 + nf * OF_CMPLX, gc_1, gc_z);
                zgemm_(TRANS_C, TRANS_N, &di, &d_j, &nfi,
                       Z1, c2s_i + nfi * OF_CMPLX, &nf2i, tmp1, &nfi,
                       Z1, tmp2, &di);

                zgemm_(TRANS_N, TRANS_N, &d_i, &dj, &nf2j,
                       zfac, tmp2, &d_i, c2s_j, &nf2j, 
                       Z0, opij, &d_i);

                gc_x += nf;
                gc_y += nf;
                gc_z += nf;
                gc_1 += nf;
                opij += no * OF_CMPLX;
        }

        free(tmp1);
        free(tmp2);
}

/*
 * 2e integrals, cartesian to spinor for electron 2.
 *
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
static void si2e_swap(double *new, const double *oldx, const double *oldy,
                      const double *oldz, const double *old1,
                      const int ni, const int nj, const int nk, const int nl)
{
        int i, j, k, l;
        int dlo = ni * nk * OF_CMPLX; // shift of (i,k,l++,j)
        int djo = ni * nk * nl * OF_CMPLX; // shift of (i,k,l,j++)
        int djn = nk * ni * OF_CMPLX; // shift of (k,i,j++,l)
        int dln = nk * ni * nj * OF_CMPLX; // shift of (k,i,j,l++)
        double *new11 = new;
        double *new12 = new11 + nk * ni * nj * nl * OF_CMPLX;
        double *new21 = new12 + nk * ni * nj * nl * OF_CMPLX;
        double *new22 = new21 + nk * ni * nj * nl * OF_CMPLX;
        double *pn11, *pn12, *pn21, *pn22;
        const double *ox, *oy, *oz, *o1;
        const double *pox, *poy, *poz, *po1;

        //tmp1(k    ,i,j,l    ) = opij(m,n,POS_1) + IZ1*opij(m,n,POS_Z)
        //tmp1(k    ,i,j,l+nfl) = opij(m,n,POS_Y) + IZ1*opij(m,n,POS_X)
        //tmp1(k+nfk,i,j,l    ) =-opij(m,n,POS_Y) + IZ1*opij(m,n,POS_X)
        //tmp1(k+nfk,i,j,l+nfl) = opij(m,n,POS_1) - IZ1*opij(m,n,POS_Z)
        for (l = 0; l < nl; l++)
                for (j = 0; j < nj; j++) {
                        pn11 = new11 + l * dln + j * djn;
                        pn12 = new12 + l * dln + j * djn;
                        pn21 = new21 + l * dln + j * djn;
                        pn22 = new22 + l * dln + j * djn;
                        ox = oldx + l * dlo + j * djo;
                        oy = oldy + l * dlo + j * djo;
                        oz = oldz + l * dlo + j * djo;
                        o1 = old1 + l * dlo + j * djo;
                        for (i = 0; i < ni * OF_CMPLX; i += OF_CMPLX) {
                                pox = ox + i;
                                poy = oy + i;
                                poz = oz + i;
                                po1 = o1 + i;
                                for (k = 0; k < nk * OF_CMPLX; k += OF_CMPLX) {
                                        pn11[k  ] = po1[0] - poz[1];
                                        pn11[k+1] = po1[1] + poz[0];
                                        pn12[k  ] = poy[0] - pox[1];
                                        pn12[k+1] = poy[1] + pox[0];
                                        pn21[k  ] =-poy[0] - pox[1];
                                        pn21[k+1] =-poy[1] + pox[0];
                                        pn22[k  ] = po1[0] + poz[1];
                                        pn22[k+1] = po1[1] - poz[0];
                                        pox += ni * OF_CMPLX;
                                        poy += ni * OF_CMPLX;
                                        poz += ni * OF_CMPLX;
                                        po1 += ni * OF_CMPLX;
                                }
                                pn11 += nk * OF_CMPLX;
                                pn12 += nk * OF_CMPLX;
                                pn21 += nk * OF_CMPLX;
                                pn22 += nk * OF_CMPLX;
                        }
                }
}
static void si_2e2(double *fkijl, const double *opij, const double *zfac,
                   const int *shls, const int *bas)
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_N[] = {'N'};
        const char TRANS_C[] = {'C'};
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int k_sh = shls[2];
        const int l_sh = shls[3];
        const int k_l = bas(ANG_OF, k_sh);
        const int l_l = bas(ANG_OF, l_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int k_ctr = bas(NCTR_OF, k_sh);
        const int l_ctr = bas(NCTR_OF, l_sh);
        const int di = len_spinor(i_sh, bas);
        const int dj = len_spinor(j_sh, bas);
        const int dk = len_spinor(k_sh, bas);
        const int dl = len_spinor(l_sh, bas);
        const int ni = di * i_ctr;
        const int nj = dj * j_ctr;
        const int nk = dk * k_ctr;
        const int nl = dl * l_ctr;
        const int nfk = len_cart(k_l);
        const int nfl = len_cart(l_l);
        const int nf2k = nfk + nfk;
        const int nf2l = nfl + nfl;
        const int d_k = dk * di * dj;
        const int d_l = di * dj * nf2l;
        const int nop = nfk * di * dj * nfl;
        int ofj = ni;
        int ofk = ni * nj;
        int ofl = nk * ni * nj;
        int ic, jc, kc, lc;
        const double *c2s_k, *c2s_l;
        double *pfkijl;
        const double *ox = opij;
        const double *oy = ox + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        const double *oz = oy + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        const double *o1 = oz + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2k*di*dj*nf2l * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * dk*di*dj*nf2l * OF_CMPLX);

        if (bas(KAPPA_OF, k_sh) < 0) { // j = l + 1/2
                c2s_k = g_c2s[k_l].cart2j_gt_l;
        } else {
                c2s_k = g_c2s[k_l].cart2j_lt_l;
        }
        if (bas(KAPPA_OF, l_sh) < 0) { // j = l + 1/2
                c2s_l = g_c2s[l_l].cart2j_gt_l;
        } else {
                c2s_l = g_c2s[l_l].cart2j_lt_l;
        }

        for (lc = 0; lc < nl; lc += dl)
                for (kc = 0; kc < nk; kc += dk)
                        for (jc = 0; jc < nj; jc += dj)
                                for (ic = 0; ic < ni; ic += di) {
                                        si2e_swap(tmp1, ox, oy, oz, o1,
                                                  di, dj, nfk, nfl);

                                        zgemm_(TRANS_C, TRANS_N, &dk, &d_l, &nfk,
                                               Z1, c2s_k, &nf2k, tmp1, &nfk,
                                               Z0, tmp2, &dk);
                                        zgemm_(TRANS_C, TRANS_N, &dk, &d_l, &nfk,
                                               Z1, c2s_k + nfk * OF_CMPLX, &nf2k,
                                               tmp1 + nfk * d_l * OF_CMPLX, &nfk,
                                               Z1, tmp2, &dk);

                                        zgemm_(TRANS_N, TRANS_N, &d_k, &dl, &nf2l,
                                               zfac, tmp2, &d_k, c2s_l, &nf2l, 
                                               Z0, tmp1, &d_k);
                                        pfkijl = fkijl + (ofl * lc + ofk * kc
                                                + ofj * jc + ic) * OF_CMPLX;

                                        zcopy_kijl(pfkijl, tmp1, 
                                                   ni, nj, nk, nl,
                                                   di, dj, dk, dl);

                                        ox += nop * OF_CMPLX;
                                        oy += nop * OF_CMPLX;
                                        oz += nop * OF_CMPLX;
                                        o1 += nop * OF_CMPLX;
                                }

        free(tmp1);
        free(tmp2);
}

C2S (sf_1e);
C2Si(sf_1e);
C2S (si_1e);
C2Si(si_1e);

C2S (sf_2e1);
C2Si(sf_2e1);
C2S (sf_2e2);
C2Si(sf_2e2);
C2S (si_2e1);
C2Si(si_2e1);
C2S (si_2e2);
C2Si(si_2e2);

/*
 * 1e integrals, reorder cartesian integrals.
 */
void c2s_cart_1e(double *opij, const double *gctr, const int *shls,
                 const int *bas)
{
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nf = nfi * nfj;
        const int ni = nfi * i_ctr;
        const int nj = nfj * j_ctr;
        int ic, jc;
        double *popij;

        for (jc = 0; jc < nj; jc += nfj)
                for (ic = 0; ic < ni; ic += nfi) {
                        popij = opij + ni * jc + ic;
                        dcopy_ij(popij, gctr, ni, nj, nfi, nfj);
                        gctr += nf;
                }
}

/*
 * 2e integrals, reorder cartesian integrals.
 */
void c2s_cart_2e1(double *fkijl, const double *gctr, const int *shls,
                  const int *bas)
{
        const int i_sh = shls[0];
        const int j_sh = shls[1];
        const int k_sh = shls[2];
        const int l_sh = shls[3];
        const int i_l = bas(ANG_OF, i_sh);
        const int j_l = bas(ANG_OF, j_sh);
        const int k_l = bas(ANG_OF, k_sh);
        const int l_l = bas(ANG_OF, l_sh);
        const int i_ctr = bas(NCTR_OF, i_sh);
        const int j_ctr = bas(NCTR_OF, j_sh);
        const int k_ctr = bas(NCTR_OF, k_sh);
        const int l_ctr = bas(NCTR_OF, l_sh);
        const int nfi = len_cart(i_l);
        const int nfj = len_cart(j_l);
        const int nfk = len_cart(k_l);
        const int nfl = len_cart(l_l);
        const int ni = nfi * i_ctr;
        const int nj = nfj * j_ctr;
        const int nk = nfk * k_ctr;
        const int nl = nfl * l_ctr;
        const int nf = nfk * nfi * nfj * nfl;
        int ofj = ni;
        int ofk = ni * nj;
        int ofl = nk * ni * nj;
        int ic, jc, kc, lc;
        double *pfkijl;

        for (lc = 0; lc < nl; lc += nfl)
                for (kc = 0; kc < nk; kc += nfk)
                        for (jc = 0; jc < nj; jc += nfj)
                                for (ic = 0; ic < ni; ic += nfi) {
                                        pfkijl = fkijl + ofl * lc + ofk * kc
                                                + ofj * jc + ic;
                                        dcopy_kijl(pfkijl, gctr, 
                                                   ni, nj, nk, nl,
                                                   nfi, nfj, nfk, nfl);
                                        gctr += nf;
                                }
}
void c2s_cart_2e2() {};



/*************************************************
 *
 * transform vectors
 *
 *************************************************/
void c2s_sph_vec(double *sph, const double *cart, const int l, const int nvec)
{
        const double D0 = 0;
        const double D1 = 1;
        const char TRANS_T = 'T';
        const char TRANS_N = 'N';
        int ns = l + l + 1;
        int nc = len_cart(l);
        dgemm_(&TRANS_T, &TRANS_N, &ns, &nvec, &nc,
               &D1, g_c2s[l].cart2sph, &nc, cart, &nc,
               &D0, sph, &ns);
}
