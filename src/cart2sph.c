/*
 * File: cart2sph.c
 * Author: Qiming Sun <osirpt.sun@gmail.com>
 *
 * Cartisen GTO to spheric or spinor GTO transformation
 * (and reorder the integrals from block(i,j,k,l)_{contr_idx(I,K,L,J)}
 * to (iI,jJ,kK,lL))
 */

#include <stdlib.h>
#include "cint_const.h"
#include "cint_bas.h"
#include "misc.h"


/*
 * Cartesian to real-spheric coefficients
 * ref: H. B. Schlegel and M. J.  Frisch, Int. J. Quant. Chem., 54(1995), 83-87.
 * different from the usual definition such as
 *   p_-1 p_0 p_1 => (px, py, pz) ...
 * the map here is
 *   p_-1 p_0 p_1 => (py, pz, px) ...
void fill_cart2sph(const int l, double *t)
{
        int m, lx, ly, lz;
        for (m = -l; m <= l; m++) {
                for (lx = l; lx >= 0; lx--) {
                        for (ly = *lmax - lx; ly >= 0; ly--) {
                                lz = *lmax - lx - ly;
                                *t++ = dxyzfactor_real_spheric_UPI_(&lx, &ly, &lz, &m);
                        }
                }
        }
}
 */

static const double g_trans_cart2sph[476] = {
        0.282094791773878143,
        0,
        0.488602511902919921,
        0,
        0,
        0,
        0.488602511902919921,
        0.488602511902919921,
        0,
        0,
        0,
        1.092548430592079070,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1.092548430592079070,
        0,
        -0.315391565252520002,
        0,
        0,
        -0.315391565252520002,
        0,
        0.630783130505040012,
        0,
        0,
        1.092548430592079070,
        0,
        0,
        0,
        0.546274215296039535,
        0,
        0,
        -0.546274215296039537,
        0,
        0,
        0,
        1.770130769779930531,
        0,
        0,
        0,
        0,
        -0.590043589926643510,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.890611442640554055,
        0,
        0,
        0,
        0,
        0,
        0,
        -0.457045799464465739,
        0,
        0,
        0,
        0,
        -0.457045799464465739,
        0,
        1.828183197857862944,
        0,
        0,
        0,
        -1.119528997770346170,
        0,
        0,
        0,
        0,
        -1.119528997770346170,
        0,
        0.746352665180230782,
        -0.457045799464465739,
        0,
        0,
        -0.457045799464465739,
        0,
        1.828183197857862944,
        0,
        0,
        0,
        0,
        0,
        0,
        1.445305721320277027,
        0,
        0,
        0,
        0,
        -1.445305721320277020,
        0,
        0,
        0.590043589926643510,
        0,
        0,
        -1.770130769779930530,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.503342941796704538,
        0,
        0,
        0,
        0,
        -2.503342941796704530,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        5.310392309339791593,
        0,
        0,
        0,
        0,
        0,
        0,
        -1.770130769779930530,
        0,
        0,
        0,
        0,
        -0.946174695757560014,
        0,
        0,
        0,
        0,
        -0.946174695757560014,
        0,
        5.677048174545360108,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -2.007139630671867500,
        0,
        0,
        0,
        0,
        0,
        0,
        -2.007139630671867500,
        0,
        2.676186174229156671,
        0,
        0.317356640745612911,
        0,
        0,
        0.634713281491225822,
        0,
        -2.538853125964903290,
        0,
        0,
        0,
        0,
        0.317356640745612911,
        0,
        -2.538853125964903290,
        0,
        0.846284375321634430,
        0,
        0,
        -2.007139630671867500,
        0,
        0,
        0,
        0,
        -2.007139630671867500,
        0,
        2.676186174229156671,
        0,
        0,
        0,
        0,
        0,
        -0.473087347878780002,
        0,
        0,
        0,
        0,
        2.838524087272680054,
        0,
        0,
        0,
        0,
        0.473087347878780009,
        0,
        -2.838524087272680050,
        0,
        0,
        0,
        0,
        1.770130769779930531,
        0,
        0,
        0,
        0,
        -5.310392309339791590,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0.625835735449176134,
        0,
        0,
        -3.755014412695056800,
        0,
        0,
        0,
        0,
        0,
        0,
        0.625835735449176134,
        0,
        0,
        0,
        0,
        0,
        3.281910284200850514,
        0,
        0,
        0,
        0,
        -6.563820568401701020,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0.656382056840170102,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        8.302649259524165115,
        0,
        0,
        0,
        0,
        0,
        0,
        -8.302649259524165110,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -1.467714898305751160,
        0,
        0,
        0,
        0,
        -0.978476598870500779,
        0,
        11.741719186446009300,
        0,
        0,
        0,
        0,
        0,
        0,
        0.489238299435250387,
        0,
        -3.913906395482003100,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -4.793536784973323750,
        0,
        0,
        0,
        0,
        0,
        0,
        -4.793536784973323750,
        0,
        9.587073569946647510,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0.452946651195696921,
        0,
        0,
        0,
        0,
        0.905893302391393842,
        0,
        -5.435359814348363050,
        0,
        0,
        0,
        0,
        0,
        0,
        0.452946651195696921,
        0,
        -5.435359814348363050,
        0,
        3.623573209565575370,
        0,
        0,
        0,
        1.754254836801353946,
        0,
        0,
        0,
        0,
        3.508509673602707893,
        0,
        -4.678012898136943850,
        0,
        0,
        0,
        0,
        0,
        0,
        1.754254836801353946,
        0,
        -4.678012898136943850,
        0,
        0.935602579627388771,
        0.452946651195696921,
        0,
        0,
        0.905893302391393842,
        0,
        -5.435359814348363050,
        0,
        0,
        0,
        0,
        0.452946651195696921,
        0,
        -5.435359814348363050,
        0,
        3.623573209565575370,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        -2.396768392486661870,
        0,
        0,
        0,
        0,
        0,
        0,
        4.793536784973323755,
        0,
        0,
        0,
        0,
        0,
        0,
        2.396768392486661877,
        0,
        -4.793536784973323750,
        0,
        0,
        -0.489238299435250389,
        0,
        0,
        0.978476598870500775,
        0,
        3.913906395482003101,
        0,
        0,
        0,
        0,
        1.467714898305751163,
        0,
        -11.741719186446009300,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.075662314881041278,
        0,
        0,
        0,
        0,
        -12.453973889286247600,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        2.075662314881041278,
        0,
        0,
        0,
        0,
        0.656382056840170102,
        0,
        0,
        -6.563820568401701020,
        0,
        0,
        0,
        0,
        0,
        0,
        3.281910284200850514,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0};

/*
 * / xyz_alpha \
 * \ xyz_beta  /
 */
static const double g_trans_cart2j[3808] = {
        0,  0,
        0.282094791773878143,  0,
        0.282094791773878143,  0,
        0,  0,
       -0.282094791773878143,  0,
        0,  0.282094791773878143,
        0,  0,
        0,  0,
        0,  0,
        0.282094791773878143,  0,
        0,  0,
        0,  0,
       -0.282094791773878143,  0,
       -0.282094791773878143,  0,
        0, -0.282094791773878143,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.345494149471335479,  0,
        0, -0.345494149471335479,
        0,  0,
        0.199471140200716338,  0,
        0, -0.199471140200716338,
        0,  0,
        0,  0,
        0,  0,
        0.398942280401432677,  0,
        0,  0,
        0,  0,
        0.398942280401432677,  0,
       -0.199471140200716338,  0,
        0, -0.199471140200716338,
        0,  0,
       -0.345494149471335479,  0,
        0, -0.345494149471335479,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.345494149471335479,  0,
        0,  0.690988298942670958,
        0,  0,
        0.345494149471335479,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.345494149471335479,  0,
        0,  0,
        0, -0.345494149471335479,
        0,  0,
        0,  0,
        0,  0,
       -0.598413420602149016,  0,
        0,  0,
        0,  0.598413420602149016,
        0,  0,
       -0.199471140200716338,  0,
        0,  0,
        0,  0,
       -0.199471140200716338,  0,
        0,  0,
        0.398942280401432677,  0,
        0.199471140200716338,  0,
        0,  0,
        0,  0,
        0.199471140200716338,  0,
        0,  0,
       -0.398942280401432677,  0,
        0,  0,
        0,  0,
       -0.598413420602149016,  0,
        0,  0,
        0, -0.598413420602149016,
        0,  0,
        0,  0,
        0,  0,
        0.345494149471335479,  0,
        0,  0,
        0,  0.345494149471335479,
        0,  0,
        0.345494149471335479,  0,
        0,  0.690988298942670958,
        0,  0,
       -0.345494149471335479,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0, -0.772548404046379160,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0,  0,
        0.172747074735667739,  0,
        0, -0.345494149471335479,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.690988298942670958,  0,
        0,  0,
        0, -0.690988298942670958,
        0,  0,
        0,  0,
        0,  0,
        0.488602511902919921,  0,
        0,  0,
        0, -0.488602511902919921,
        0,  0,
       -0.244301255951459960,  0,
        0,  0,
        0,  0,
       -0.244301255951459960,  0,
        0,  0,
        0.488602511902919921,  0,
       -0.244301255951459960,  0,
        0,  0,
        0,  0,
       -0.244301255951459960,  0,
        0,  0,
        0.488602511902919921,  0,
        0,  0,
        0,  0,
       -0.488602511902919921,  0,
        0,  0,
        0, -0.488602511902919921,
        0,  0,
        0,  0,
        0,  0,
       -0.690988298942670958,  0,
        0,  0,
        0, -0.690988298942670958,
        0,  0,
        0.172747074735667739,  0,
        0,  0.345494149471335479,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0,  0.772548404046379160,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0,  1.158822606069568741,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
        0,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
        0, -0.772548404046379160,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.863735373678338698,  0,
        0,  0,
        0,  1.727470747356677396,
        0,  0,
        0,  0,
        0.863735373678338698,  0,
        0,  0,
        0,  0,
       -0.172747074735667739,  0,
        0,  0.172747074735667739,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0.690988298942670958,  0,
        0,  0.172747074735667739,
        0,  0,
        0, -0.690988298942670958,
        0,  0,
        0.244301255951459960,  0,
        0, -0.244301255951459960,
        0,  0,
        0.244301255951459960,  0,
        0,  0,
       -0.977205023805839843,  0,
        0, -0.244301255951459960,
        0,  0,
        0,  0.977205023805839843,
        0,  0,
        0,  0,
        0,  0,
       -0.732903767854379882,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.732903767854379882,  0,
        0,  0,
        0.488602511902919921,  0,
        0,  0,
        0,  0,
        0.732903767854379882,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.732903767854379882,  0,
        0,  0,
       -0.488602511902919921,  0,
        0.244301255951459960,  0,
        0,  0.244301255951459960,
        0,  0,
        0.244301255951459960,  0,
        0,  0,
       -0.977205023805839843,  0,
        0,  0.244301255951459960,
        0,  0,
        0, -0.977205023805839843,
        0,  0,
       -0.172747074735667739,  0,
        0, -0.172747074735667739,
        0,  0,
       -0.172747074735667739,  0,
        0,  0,
        0.690988298942670958,  0,
        0, -0.172747074735667739,
        0,  0,
        0,  0.690988298942670958,
        0,  0,
        0,  0,
        0,  0,
        0.863735373678338698,  0,
        0,  0,
        0,  1.727470747356677396,
        0,  0,
        0,  0,
       -0.863735373678338698,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0,  0,
        0, -0.772548404046379160,
        0,  0,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
        0,  0,
       -0.386274202023189580,  0,
        0, -1.158822606069568741,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
        0,  0,
        0,  0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0, -1.251671470898352269,
        0,  0,
       -1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0.157695782626260003,  0,
        0, -0.473087347878780009,
        0,  0,
       -0.473087347878780009,  0,
        0,  0,
        0,  0,
        0,  0.157695782626260003,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0, -1.892349391515120036,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.546274215296039535,  0,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
        0,  0,
       -0.546274215296039535,  0,
        0,  0,
        0,  0,
       -0.273137107648019767,  0,
        0,  0.273137107648019767,
        0,  0,
       -0.273137107648019767,  0,
        0,  0,
        1.092548430592079070,  0,
        0,  0.273137107648019767,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
       -0.211571093830408607,  0,
        0,  0.211571093830408607,
        0,  0,
       -0.211571093830408607,  0,
        0,  0,
        0.846284375321634430,  0,
        0,  0.211571093830408607,
        0,  0,
        0, -0.846284375321634430,
        0,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0.564189583547756286,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0,
        0.564189583547756286,  0,
        0.211571093830408607,  0,
        0,  0.211571093830408607,
        0,  0,
        0.211571093830408607,  0,
        0,  0,
       -0.846284375321634430,  0,
        0,  0.211571093830408607,
        0,  0,
        0, -0.846284375321634430,
        0,  0,
        0.273137107648019767,  0,
        0,  0.273137107648019767,
        0,  0,
        0.273137107648019767,  0,
        0,  0,
       -1.092548430592079070,  0,
        0,  0.273137107648019767,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
        0,  0,
        0,  0,
        0.546274215296039535,  0,
        0,  0,
        0,  1.092548430592079070,
        0,  0,
        0,  0,
       -0.546274215296039535,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0,  1.892349391515120036,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0,
       -0.157695782626260003,  0,
        0, -0.473087347878780009,
        0,  0,
        0.473087347878780009,  0,
        0,  0,
        0,  0,
        0,  0.157695782626260003,
        0,  0,
        0,  0,
        0,  0,
       -0.417223823632784089,  0,
        0, -1.251671470898352269,
        0,  0,
        1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.417223823632784089,  0,
        0,  1.668895294531136358,
        0,  0,
        2.503342941796704538,  0,
        0,  0,
        0,  0,
        0, -1.668895294531136358,
        0,  0,
        0,  0,
        0,  0,
       -0.417223823632784089,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  0,
        0, -1.251671470898352269,
        0,  0,
        0,  0,
       -1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.103870478383820021,  0,
        0,  0,
        0,  3.311611435151460063,
        0,  0,
        0,  0,
        3.311611435151460063,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -1.103870478383820021,
        0,  0,
        0,  0,
        0,  0,
       -0.157695782626260003,  0,
        0,  0.315391565252520006,
        0,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0.315391565252520006,
        0,  0,
        0, -1.892349391515120036,
        0,  0,
        0.157695782626260003,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0,
        0.273137107648019767,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  0,
        0,  0,
       -1.638822645888118605,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  3.277645291776237211,
        0,  0,
       -0.273137107648019767,  0,
        0,  0,
        1.638822645888118605,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        0,  0.819411322944059302,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        1.092548430592079070,  0,
        0,  0,
        0,  0.819411322944059302,
        0,  0,
        0, -1.092548430592079070,
        0,  0,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
        0, -1.057855469152043038,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
       -1.410473958869390717,  0,
        0,  0,
        0, -1.057855469152043038,
        0,  0,
        0,  1.410473958869390717,
        0,  0,
        0.211571093830408607,  0,
        0,  0,
        0,  0,
        0.423142187660817215,  0,
        0,  0,
       -1.692568750643268860,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.211571093830408607,  0,
        0,  0,
       -1.692568750643268860,  0,
        0,  0,
        0.564189583547756286,  0,
       -0.211571093830408607,  0,
        0,  0,
        0,  0,
       -0.423142187660817215,  0,
        0,  0,
        1.692568750643268860,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.211571093830408607,  0,
        0,  0,
        1.692568750643268860,  0,
        0,  0,
       -0.564189583547756286,  0,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
        0,  1.057855469152043038,
        0,  0,
        0,  0,
        1.057855469152043038,  0,
        0,  0,
       -1.410473958869390717,  0,
        0,  0,
        0,  1.057855469152043038,
        0,  0,
        0, -1.410473958869390717,
        0,  0,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        0, -0.819411322944059302,
        0,  0,
        0,  0,
       -0.819411322944059302,  0,
        0,  0,
        1.092548430592079070,  0,
        0,  0,
        0, -0.819411322944059302,
        0,  0,
        0,  1.092548430592079070,
        0,  0,
       -0.273137107648019767,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  0,
        0,  0,
        1.638822645888118605,  0,
        0, -0.546274215296039535,
        0,  0,
        0,  3.277645291776237211,
        0,  0,
        0.273137107648019767,  0,
        0,  0,
       -1.638822645888118605,  0,
        0,  0,
        0,  0,
        0.157695782626260003,  0,
        0,  0.315391565252520006,
        0,  0,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0.315391565252520006,
        0,  0,
        0, -1.892349391515120036,
        0,  0,
       -0.157695782626260003,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.103870478383820021,  0,
        0,  0,
        0, -3.311611435151460063,
        0,  0,
        0,  0,
        3.311611435151460063,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.103870478383820021,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  0,
        0,  1.251671470898352269,
        0,  0,
        0,  0,
       -1.251671470898352269,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.417223823632784089,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  1.668895294531136358,
        0,  0,
       -2.503342941796704538,  0,
        0,  0,
        0,  0,
        0, -1.668895294531136358,
        0,  0,
        0,  0,
        0,  0,
        0.417223823632784089,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0, -1.770130769779930531,
        0,  0,
       -2.655196154669895796,  0,
        0,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0, -0.590043589926643510,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        0,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.180087179853287020,  0,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
       -3.540261539559861062,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.590043589926643510,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
       -0.295021794963321755,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0.590043589926643510,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
       -0.193137101011594790,  0,
        0,  0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0,  0.386274202023189580,
        0,  0,
        0, -2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        1.545096808092758321,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0, -1.545096808092758321,
        0,  0,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0,  0,
       -0.946174695757560018,  0,
        0,  0,
        1.261566261010080024,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0, -1.261566261010080024,
        0,  0,
        0.236543673939390004,  0,
        0,  0,
        0,  0,
        0.473087347878780009,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.236543673939390004,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0.630783130505040012,  0,
        0.236543673939390004,  0,
        0,  0,
        0,  0,
        0.473087347878780009,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.236543673939390004,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0,
        0.630783130505040012,  0,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0,  0,
        0.946174695757560018,  0,
        0,  0,
       -1.261566261010080024,  0,
        0,  0,
        0,  0.946174695757560018,
        0,  0,
        0, -1.261566261010080024,
        0,  0,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0,  0,
       -1.545096808092758321,  0,
        0,  0,
        0,  1.158822606069568741,
        0,  0,
        0, -1.545096808092758321,
        0,  0,
       -0.193137101011594790,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  0,
        0,  0,
        1.158822606069568741,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -1.158822606069568741,  0,
        0,  0,
        0,  0,
       -0.295021794963321755,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  3.540261539559861062,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.590043589926643510,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.180087179853287020,  0,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
        3.540261539559861062,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0,  0.590043589926643510,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        0,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  0,
        0,  0,
        0.147510897481660877,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  1.770130769779930531,
        0,  0,
       -2.655196154669895796,  0,
        0,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0,  2.212663462224913163,
        0,  0,
        4.425326924449826327,  0,
        0,  0,
        0,  0,
        0, -4.425326924449826327,
        0,  0,
        0,  0,
        0,  0,
       -2.212663462224913163,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0.442532692444982632,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0.0000000000000001985,
       -2.655196154669895796,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.327598077334947898,  0,
        0,  0,
        0,  5.310392309339791593,
        0,  0,
        0,  0,
        7.965588464009687389,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -5.310392309339791593,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.327598077334947898,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.147510897481660877,  0,
        0,  0.442532692444982632,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
        1.180087179853287020,  0,
        0,  0.295021794963321755,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
       -3.540261539559861062,  0,
        0,  0,
        0,  0,
        0, -0.147510897481660877,
        0,  0,
        0,  1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0.295021794963321755,  0,
        0, -0.885065384889965265,
        0,  0,
       -0.590043589926643510,  0,
        0,  0,
       -2.360174359706574041,  0,
        0, -0.590043589926643510,
        0,  0,
        0,  7.080523079119722124,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        7.080523079119722124,  0,
        0,  0,
        0,  0,
        0,  0.295021794963321755,
        0,  0,
        0, -2.360174359706574041,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
        0.885065384889965265,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.351959707081163531,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -2.703919414162327062,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  5.407838828324654124,
        0,  0,
        0,  0,
       -1.351959707081163531,  0,
        0,  0,
        2.703919414162327062,  0,
        0,  0,
        0,  0,
        0.193137101011594790,  0,
        0, -0.193137101011594790,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
       -2.317645212139137482,  0,
        0, -0.386274202023189580,
        0,  0,
        0,  2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -2.317645212139137482,  0,
        0,  0,
        1.545096808092758321,  0,
        0, -0.193137101011594790,
        0,  0,
        0,  2.317645212139137482,
        0,  0,
        0, -1.545096808092758321,
        0,  0,
       -0.236543673939390004,  0,
        0,  0.236543673939390004,
        0,  0,
       -0.473087347878780009,  0,
        0,  0,
        2.838524087272680054,  0,
        0,  0.473087347878780009,
        0,  0,
        0, -2.838524087272680054,
        0,  0,
       -0.236543673939390004,  0,
        0,  0,
        2.838524087272680054,  0,
        0,  0,
       -1.892349391515120036,  0,
        0,  0.236543673939390004,
        0,  0,
        0, -2.838524087272680054,
        0,  0,
        0,  1.892349391515120036,
        0,  0,
        0,  0,
        0,  0,
        1.182718369696950022,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.365436739393900045,  0,
        0,  0,
       -3.153915652525200060,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.182718369696950022,  0,
        0,  0,
       -3.153915652525200060,  0,
        0,  0,
        0.630783130505040012,  0,
        0,  0,
        0,  0,
       -1.182718369696950022,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -2.365436739393900045,  0,
        0,  0,
        3.153915652525200060,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.182718369696950022,  0,
        0,  0,
        3.153915652525200060,  0,
        0,  0,
       -0.630783130505040012,  0,
       -0.236543673939390004,  0,
        0, -0.236543673939390004,
        0,  0,
       -0.473087347878780009,  0,
        0,  0,
        2.838524087272680054,  0,
        0, -0.473087347878780009,
        0,  0,
        0,  2.838524087272680054,
        0,  0,
       -0.236543673939390004,  0,
        0,  0,
        2.838524087272680054,  0,
        0,  0,
       -1.892349391515120036,  0,
        0, -0.236543673939390004,
        0,  0,
        0,  2.838524087272680054,
        0,  0.0000000000000001984,
        0, -1.892349391515120036,
        0,  0,
        0.193137101011594790,  0,
        0,  0.193137101011594790,
        0,  0,
        0.386274202023189580,  0,
        0,  0,
       -2.317645212139137482,  0,
        0,  0.386274202023189580,
        0,  0,
        0, -2.317645212139137482,
        0,  0,
        0.193137101011594790,  0,
        0,  0,
       -2.317645212139137482,  0,
        0,  0,
        1.545096808092758321,  0,
        0,  0.193137101011594790,
        0,  0,
        0, -2.317645212139137482,
        0,  0,
        0,  1.545096808092758321,
        0,  0,
        0,  0,
        0,  0,
       -1.351959707081163531,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.703919414162327062,  0,
        0,  0,
        0, -2.703919414162327062,
        0,  0,
        0,  5.407838828324654124,
        0,  0,
        0,  0,
        1.351959707081163531,  0,
        0,  0,
       -2.703919414162327062,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.885065384889965265,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.770130769779930531,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0, -3.540261539559861062,
        0,  0,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        1.770130769779930531,  0,
        0,  0,
        0,  0,
        0.295021794963321755,  0,
        0,  0.885065384889965265,
        0,  0,
       -0.590043589926643510,  0,
        0,  0,
       -2.360174359706574041,  0,
        0,  0.590043589926643510,
        0,  0,
        0, -7.080523079119722124,
        0,  0,
       -0.885065384889965265,  0,
        0,  0,
        7.080523079119722124,  0,
        0,  0,
        0,  0,
        0, -0.295021794963321755,
        0,  0,
        0,  2.360174359706574041,
        0,  0,
        0,  0,
        0,  0,
       -0.147510897481660877,  0,
        0, -0.442532692444982632,
        0,  0,
        0.295021794963321755,  0,
        0,  0,
        1.180087179853287020,  0,
        0, -0.295021794963321755,
        0,  0,
        0,  3.540261539559861062,
        0,  0,
        0.442532692444982632,  0,
        0,  0,
       -3.540261539559861062,  0,
        0,  0,
        0,  0,
        0,  0.147510897481660877,
        0,  0,
        0, -1.180087179853287020,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.327598077334947898,  0,
        0,  0,
        0,  5.310392309339791593,
        0,  0,
        0,  0,
       -7.965588464009687389,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -5.310392309339791593,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.327598077334947898,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0,  0,
        0, -1.770130769779930531,
        0,  0,
        0,  0,
        2.655196154669895796,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  1.770130769779930531,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.442532692444982632,  0,
        0, -2.212663462224913163,
        0,  0,
        4.425326924449826327,  0,
        0,  0,
        0,  0,
        0,  4.425326924449826327,
        0,  0,
        0,  0,
        0,  0,
       -2.212663462224913163,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.442532692444982632,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.464132203440858160,  0,
        0, -2.320661017204290803,
        0,  0,
       -4.641322034408581606,  0,
        0,  0,
        0,  0,
        0,  4.641322034408581606,
        0,  0,
        0,  0,
        0,  0,
        2.320661017204290803,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.464132203440858160,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.139941124721293271,  0,
        0, -0.699705623606466358,
        0,  0,
       -1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  1.399411247212932717,
        0,  0,
        0,  0,
        0,  0,
        0.699705623606466358,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.139941124721293271,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0, -5.597644988851730871,
        0,  0,
        0,  0,
       -8.396467483277596306,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  5.597644988851730871,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0, -2.503342941796704538,
        0,  0,
        0,  0,
       -3.755014412695056807,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.312917867724588067,  0,
        0,  0.938753603173764201,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        2.503342941796704538,  0,
        0,  0.625835735449176134,
        0,  0,
        0, -7.510028825390113615,
        0,  0,
        0.938753603173764201,  0,
        0,  0,
       -7.510028825390113615,  0,
        0,  0,
        0,  0,
        0, -0.312917867724588067,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
       -0.180663215165034628,  0,
        0,  0.541989645495103885,
        0,  0,
        0.361326430330069256,  0,
        0,  0,
        1.445305721320277027,  0,
        0,  0.361326430330069256,
        0,  0,
        0, -4.335917163960831083,
        0,  0,
        0.541989645495103885,  0,
        0,  0,
       -4.335917163960831083,  0,
        0,  0,
        0,  0,
        0, -0.180663215165034628,
        0,  0,
        0,  1.445305721320277027,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.445305721320277027,  0,
        0,  0,
        0,  2.890611442640554055,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.890611442640554055,  0,
        0,  0,
        0,  2.890611442640554055,
        0,  0,
        0, -5.781222885281108110,
        0,  0,
        0,  0,
        1.445305721320277027,  0,
        0,  0,
       -2.890611442640554055,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.021985476433282363,  0,
        0,  0,
        0,  2.043970952866564726,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.043970952866564726,  0,
        0,  0,
        0,  2.043970952866564726,
        0,  0,
        0, -4.087941905733129453,
        0,  0,
        0,  0,
        1.021985476433282363,  0,
        0,  0,
       -2.043970952866564726,  0,
        0,  0,
        0,  0,
        0.255496369108320590,  0,
        0, -0.255496369108320590,
        0,  0,
        0.510992738216641181,  0,
        0,  0,
       -3.065956429299847090,  0,
        0, -0.510992738216641181,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
        0.255496369108320590,  0,
        0,  0,
       -3.065956429299847090,  0,
        0,  0,
        2.043970952866564726,  0,
        0, -0.255496369108320590,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0.215933843419584674,  0,
        0, -0.215933843419584674,
        0,  0,
        0.431867686839169349,  0,
        0,  0,
       -2.591206121035016094,  0,
        0, -0.431867686839169349,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
        0.215933843419584674,  0,
        0,  0,
       -2.591206121035016094,  0,
        0,  0,
        1.727470747356677396,  0,
        0, -0.215933843419584674,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
        0, -1.727470747356677396,
        0,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.591206121035016094,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0.690988298942670958,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.591206121035016094,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.295603060517508047,  0,
        0,  0,
       -3.454941494713354792,  0,
        0,  0,
        0.690988298942670958,  0,
       -0.215933843419584674,  0,
        0, -0.215933843419584674,
        0,  0,
       -0.431867686839169349,  0,
        0,  0,
        2.591206121035016094,  0,
        0, -0.431867686839169349,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
       -0.215933843419584674,  0,
        0,  0,
        2.591206121035016094,  0,
        0,  0,
       -1.727470747356677396,  0,
        0, -0.215933843419584674,
        0,  0,
        0,  2.591206121035016094,
        0,  0,
        0, -1.727470747356677396,
        0,  0,
       -0.255496369108320590,  0,
        0, -0.255496369108320590,
        0,  0,
       -0.510992738216641181,  0,
        0,  0,
        3.065956429299847090,  0,
        0, -0.510992738216641181,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
       -0.255496369108320590,  0,
        0,  0,
        3.065956429299847090,  0,
        0,  0,
       -2.043970952866564726,  0,
        0, -0.255496369108320590,
        0,  0,
        0,  3.065956429299847090,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0,  0,
        0,  0,
       -1.021985476433282363,  0,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.043970952866564726,  0,
        0,  0,
        0, -2.043970952866564726,
        0,  0,
        0,  4.087941905733129453,
        0,  0,
        0,  0,
        1.021985476433282363,  0,
        0,  0,
       -2.043970952866564726,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -1.445305721320277027,  0,
        0,  0,
        0, -2.890611442640554055,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        2.890611442640554055,  0,
        0,  0,
        0, -2.890611442640554055,
        0,  0,
        0,  5.781222885281108110,
        0,  0,
        0,  0,
        1.445305721320277027,  0,
        0,  0,
       -2.890611442640554055,  0,
        0,  0,
        0,  0,
        0.180663215165034628,  0,
        0,  0.541989645495103885,
        0,  0,
       -0.361326430330069256,  0,
        0,  0,
       -1.445305721320277027,  0,
        0,  0.361326430330069256,
        0,  0,
        0, -4.335917163960831083,
        0,  0,
       -0.541989645495103885,  0,
        0,  0,
        4.335917163960831083,  0,
        0,  0,
        0,  0,
        0, -0.180663215165034628,
        0,  0,
        0,  1.445305721320277027,
        0,  0,
        0,  0,
        0,  0,
        0.312917867724588067,  0,
        0,  0.938753603173764201,
        0,  0,
       -0.625835735449176134,  0,
        0,  0,
       -2.503342941796704538,  0,
        0,  0.625835735449176134,
        0,  0,
        0, -7.510028825390113615,
        0,  0,
       -0.938753603173764201,  0,
        0,  0,
        7.510028825390113615,  0,
        0,  0,
        0,  0,
        0, -0.312917867724588067,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0,  2.503342941796704538,
        0,  0,
        0,  0,
       -3.755014412695056807,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -2.503342941796704538,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0.625835735449176134,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  5.597644988851730871,
        0,  0,
        0,  0,
       -8.396467483277596306,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -5.597644988851730871,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.139941124721293271,  0,
        0, -0.699705623606466358,
        0,  0,
        1.399411247212932717,  0,
        0,  0,
        0,  0,
        0,  1.399411247212932717,
        0,  0,
        0,  0,
        0,  0,
       -0.699705623606466358,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.139941124721293271,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
       -0.464132203440858160,  0,
        0, -2.320661017204290803,
        0,  0,
        4.641322034408581606,  0,
        0,  0,
        0,  0,
        0,  4.641322034408581606,
        0,  0,
        0,  0,
        0,  0,
       -2.320661017204290803,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0, -0.464132203440858160,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0,
        0,  0};

struct cart2sp_t {
        const double *cart2sph;
        const double *cart2j_lt_l; // j < l, kappa > 0
        const double *cart2j_gt_l; // j > l, kappa < 0
};

// [*] = n(n+1)(n+2)(n+3)/4+(n+1)(n+2)(n+3)/6
static struct cart2sp_t g_c2s[6] = {
        {g_trans_cart2sph    , g_trans_cart2j     , g_trans_cart2j     },
        {g_trans_cart2sph+1  , g_trans_cart2j+8   , g_trans_cart2j+32  },
        {g_trans_cart2sph+10 , g_trans_cart2j+80  , g_trans_cart2j+176 },
        {g_trans_cart2sph+40 , g_trans_cart2j+320 , g_trans_cart2j+560 },
        {g_trans_cart2sph+110, g_trans_cart2j+880 , g_trans_cart2j+1360},
        {g_trans_cart2sph+245, g_trans_cart2j+1960, g_trans_cart2j+2800}};

// transform integrals from cartesian to spheric
static void a_bra_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nket,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double D0 = 0;
        const double D1 = 1;
        const char TRANS_T = 'T';
        const char TRANS_N = 'N';
        const unsigned int l = bas(ANG_OF, bas_id);
        const unsigned int nf = len_cart(l);
        const unsigned int nd = l * 2 + 1;
        dgemm_(&TRANS_T, &TRANS_N, &nd, &nket, &nf,
               &D1, g_c2s[l].cart2sph, &nf, gcart, &nf,
               &D0, gsph, &dgsph);
}

static void a_ket_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double D0 = 0;
        const double D1 = 1;
        const char TRANS_N = 'N';
        const unsigned int l = bas(ANG_OF, bas_id);
        const unsigned int nf = len_cart(l);
        const unsigned int nd = l * 2 + 1;
        dgemm_(&TRANS_N, &TRANS_N, &nbra, &nd, &nf,
               &D1, gcart, &nbra, g_c2s[l].cart2sph, &nf,
               &D0, gsph, &dgsph);
}

// transform s function from cartesian to spheric
static void s_bra_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nket,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[0].cart2sph;
        unsigned int i;
        for (i = 0; i < nket; i++) {
                *gsph = coeff_c2s[0] * gcart[i];
                gsph += dgsph;
        }
}
static void s_ket_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[0].cart2sph;
        unsigned int i;
        for (i = 0; i < nbra; i++) {
                gsph[i] = coeff_c2s[0] * gcart[i];
        }
}

// transform p function from cartesian to spheric
static void p_bra_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nket,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[1].cart2sph;
        unsigned int i;
        for (i = 0; i < nket; i++) {
                gsph[0] = coeff_c2s[1] * gcart[1];
                gsph[1] = coeff_c2s[5] * gcart[2];
                gsph[2] = coeff_c2s[6] * gcart[0];
                gsph += dgsph;
                gcart += 3;
        }
}
static void p_ket_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[1].cart2sph;
        unsigned int i;
        for (i = 0; i < nbra; i++) {
                gsph[0*dgsph+i] = coeff_c2s[1] * gcart[1*nbra+i];
                gsph[1*dgsph+i] = coeff_c2s[5] * gcart[2*nbra+i];
                gsph[2*dgsph+i] = coeff_c2s[6] * gcart[0*nbra+i];
        }
}

// transform d function from cartesian to spheric
static void d_bra_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nket,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[2].cart2sph;
        unsigned int i;
        for (i = 0; i < nket; i++) {
                gsph[0] = coeff_c2s[ 1] * gcart[1];
                gsph[1] = coeff_c2s[10] * gcart[4];
                gsph[2] = coeff_c2s[12] * gcart[0]
                        + coeff_c2s[15] * gcart[3]
                        + coeff_c2s[17] * gcart[5];
                gsph[3] = coeff_c2s[20] * gcart[2];
                gsph[4] = coeff_c2s[24] * gcart[0]
                        + coeff_c2s[27] * gcart[3];
                gsph += dgsph;
                gcart += 6;
        }
}
static void d_ket_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[2].cart2sph;
        unsigned int i;
        for (i = 0; i < nbra; i++) {
                gsph[0*dgsph+i] = coeff_c2s[ 1] * gcart[1*nbra+i];
                gsph[1*dgsph+i] = coeff_c2s[10] * gcart[4*nbra+i];
                gsph[2*dgsph+i] = coeff_c2s[12] * gcart[0*nbra+i]
                                + coeff_c2s[15] * gcart[3*nbra+i]
                                + coeff_c2s[17] * gcart[5*nbra+i];
                gsph[3*dgsph+i] = coeff_c2s[20] * gcart[2*nbra+i];
                gsph[4*dgsph+i] = coeff_c2s[24] * gcart[0*nbra+i]
                                + coeff_c2s[27] * gcart[3*nbra+i];
        }
}

// transform f function from cartesian to spheric
static void f_bra_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nket,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[3].cart2sph;
        unsigned int i;
        for (i = 0; i < nket; i++) {
                gsph[0] = coeff_c2s[ 1] * gcart[1]
                        + coeff_c2s[ 6] * gcart[6];
                gsph[1] = coeff_c2s[14] * gcart[4];
                gsph[2] = coeff_c2s[21] * gcart[1]
                        + coeff_c2s[26] * gcart[6]
                        + coeff_c2s[28] * gcart[8];
                gsph[3] = coeff_c2s[32] * gcart[2]
                        + coeff_c2s[37] * gcart[7]
                        + coeff_c2s[39] * gcart[9];
                gsph[4] = coeff_c2s[40] * gcart[0]
                        + coeff_c2s[43] * gcart[3]
                        + coeff_c2s[45] * gcart[5];
                gsph[5] = coeff_c2s[52] * gcart[2]
                        + coeff_c2s[57] * gcart[7];
                gsph[6] = coeff_c2s[60] * gcart[0]
                        + coeff_c2s[63] * gcart[3];
                gsph += dgsph;
                gcart += 10;
        }

}
static void f_ket_cart2spheric(double *gsph, unsigned int dgsph, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[3].cart2sph;
        unsigned int i;
        for (i = 0; i < nbra; i++) {
                gsph[0*dgsph+i] = coeff_c2s[ 1] * gcart[1*nbra+i]
                                + coeff_c2s[ 6] * gcart[6*nbra+i];
                gsph[1*dgsph+i] = coeff_c2s[14] * gcart[4*nbra+i];
                gsph[2*dgsph+i] = coeff_c2s[21] * gcart[1*nbra+i]
                                + coeff_c2s[26] * gcart[6*nbra+i]
                                + coeff_c2s[28] * gcart[8*nbra+i];
                gsph[3*dgsph+i] = coeff_c2s[32] * gcart[2*nbra+i]
                                + coeff_c2s[37] * gcart[7*nbra+i]
                                + coeff_c2s[39] * gcart[9*nbra+i];
                gsph[4*dgsph+i] = coeff_c2s[40] * gcart[0*nbra+i]
                                + coeff_c2s[43] * gcart[3*nbra+i]
                                + coeff_c2s[45] * gcart[5*nbra+i];
                gsph[5*dgsph+i] = coeff_c2s[52] * gcart[2*nbra+i]
                                + coeff_c2s[57] * gcart[7*nbra+i];
                gsph[6*dgsph+i] = coeff_c2s[60] * gcart[0*nbra+i]
                                + coeff_c2s[63] * gcart[3*nbra+i];
        }
}

static void (*f_bra_sph[6])() = {
        s_bra_cart2spheric,
        p_bra_cart2spheric,
        d_bra_cart2spheric,
        f_bra_cart2spheric,
        a_bra_cart2spheric,
        a_bra_cart2spheric,
};

static void (*f_ket_sph[6])() = {
        s_ket_cart2spheric,
        p_ket_cart2spheric,
        d_ket_cart2spheric,
        f_ket_cart2spheric,
        a_ket_cart2spheric,
        a_ket_cart2spheric,
};


// transform spin free integrals from cartesian to spinor
static void a_bra_cart2spinor_sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_C = 'C';
        const char TRANS_N = 'N';
        const unsigned int l = bas(ANG_OF, bas_id);
        const int kappa = bas(KAPPA_OF, bas_id);
        const unsigned int nf = len_cart(l);
        const unsigned int nf2 = nf * 2;
        const unsigned int nd = len_spinor(bas_id, bas);
        const double *coeff_c2s;

        if (kappa < 0) { // j = l + 1/2
                coeff_c2s = g_c2s[l].cart2j_gt_l;
        } else {
                coeff_c2s = g_c2s[l].cart2j_lt_l;
        }
        zgemm_(&TRANS_C, &TRANS_N, &nd, &nket, &nf,
               Z1, coeff_c2s, &nf2, gcart, &nf, Z0, gsp, &dgsp);
        zgemm_(&TRANS_C, &TRANS_N, &nd, &nket, &nf,
               Z1, coeff_c2s+nf*OF_CMPLX, &nf2, gcart, &nf,
               Z0, gsp+dgsp*nket*OF_CMPLX, &dgsp);
}
static void a_bra_cart2spinor_e1sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                   double *gcart, unsigned int bas_id, int bas[])
{
        const unsigned int l = bas(ANG_OF, bas_id);
        const unsigned int nf = len_cart(l);
        double *tmp1 = (double *)malloc(sizeof(double)*nf*nket*OF_CMPLX);

        dcmplx_re(nf*nket, tmp1, gcart);
        a_bra_cart2spinor_sf(gsp, dgsp, nket, tmp1, bas_id, bas);
        free(tmp1);
}

static void a_bra_cart2spinor_si(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_C = 'C';
        const char TRANS_N = 'N';
        const unsigned int l = bas(ANG_OF, bas_id);
        const int kappa = bas(KAPPA_OF, bas_id);
        const unsigned int nf = len_cart(l);
        const unsigned int nf2 = nf * 2;
        const unsigned int nd = len_spinor(bas_id, bas);
        const double *coeff_c2s;

        if (kappa < 0) { // j = l + 1/2
                coeff_c2s = g_c2s[l].cart2j_gt_l;
        } else {
                coeff_c2s = g_c2s[l].cart2j_lt_l;
        }
        zgemm_(&TRANS_C, &TRANS_N, &nd, &nket, &nf,
               Z1, coeff_c2s, &nf2, gcart, &nf, Z0, gsp, &dgsp);
        zgemm_(&TRANS_C, &TRANS_N, &nd, &nket, &nf,
               Z1, coeff_c2s+nf*OF_CMPLX, &nf2,
               gcart+nf*nket*OF_CMPLX, &nf, Z1, gsp, &dgsp);
}

static void a_ket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                              double *gcart, unsigned int bas_id, int bas[])
{
        const double Z0[] = {0, 0};
        const double Z1[] = {1, 0};
        const char TRANS_N = 'N';
        const unsigned int l = bas(ANG_OF, bas_id);
        const int kappa = bas(KAPPA_OF, bas_id);
        const unsigned int nf = len_cart(l);
        const unsigned int nf2 = nf * 2;
        const unsigned int nd = len_spinor(bas_id, bas);
        const double *coeff_c2s;

        if (kappa < 0) { // j = l + 1/2
                coeff_c2s = g_c2s[l].cart2j_gt_l;
        } else {
                coeff_c2s = g_c2s[l].cart2j_lt_l;
        }
        zgemm_(&TRANS_N, &TRANS_N, &nbra, &nd, &nf2,
               Z1, gcart, &nbra, coeff_c2s, &nf2, Z0, gsp, &dgsp);
}
// with phase "i"
static void a_iket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double Z0[] = {0, 0};
        const double ZI[] = {0, 1};
        const char TRANS_N = 'N';
        const unsigned int l = bas(ANG_OF, bas_id);
        const int kappa = bas(KAPPA_OF, bas_id);
        const unsigned int nf = len_cart(l);
        const unsigned int nf2 = nf * 2;
        const unsigned int nd = len_spinor(bas_id, bas);
        const double *coeff_c2s;

        if (kappa < 0) { // j = l + 1/2
                coeff_c2s = g_c2s[l].cart2j_gt_l;
        } else {
                coeff_c2s = g_c2s[l].cart2j_lt_l;
        }
        zgemm_(&TRANS_N, &TRANS_N, &nbra, &nd, &nf2,
               ZI, gcart, &nbra, coeff_c2s, &nf2, Z0, gsp, &dgsp);
}

static void s_bra_cart2spinor_sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[0].cart2j_lt_l;;
        double *gcart0 = gcart;
        unsigned int i;
        for (i = 0; i < nket; i++) {
                gsp[0] = 0;
                gsp[1] = 0;
                gsp[2] = coeff_c2s[4] * gcart[0];
                gsp[3] = coeff_c2s[4] * gcart[1];
                gsp += dgsp * OF_CMPLX;
                gcart += OF_CMPLX;
        }
        gcart = gcart0;
        for (i = 0; i < nket; i++) {
                gsp[0] = coeff_c2s[2] * gcart[0];
                gsp[1] = coeff_c2s[2] * gcart[1];
                gsp[2] = 0;
                gsp[3] = 0;
                gsp += dgsp * OF_CMPLX;
                gcart += OF_CMPLX;
        }
}
static void s_bra_cart2spinor_e1sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                   double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[0].cart2j_lt_l;;
        unsigned int i;
        for (i = 0; i < nket; i++) {
                gsp[0] = 0;
                gsp[1] = 0;
                gsp[2] = coeff_c2s[4] * gcart[i];
                gsp[3] = 0;
                gsp += dgsp * OF_CMPLX;
        }
        for (i = 0; i < nket; i++) {
                gsp[0] = coeff_c2s[2] * gcart[i];
                gsp[1] = 0;
                gsp[2] = 0;
                gsp[3] = 0;
                gsp += dgsp * OF_CMPLX;
        }
}
static void s_bra_cart2spinor_si(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[0].cart2j_lt_l;;
        double *gsp0 = gsp;
        unsigned int i;
        for (i = 0; i < nket; i++) {
                gsp[2] = coeff_c2s[4] * gcart[0];
                gsp[3] = coeff_c2s[4] * gcart[1];
                gsp += dgsp * OF_CMPLX;
                gcart += OF_CMPLX;
        }
        gsp = gsp0;
        for (i = 0; i < nket; i++) {
                gsp[0] = coeff_c2s[2] * gcart[0];
                gsp[1] = coeff_c2s[2] * gcart[1];
                gsp += dgsp * OF_CMPLX;
                gcart += OF_CMPLX;
        }
}
static void s_ket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                              double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[0].cart2j_lt_l;;
        unsigned int i;
        for (i = 0; i < nbra; i++) {
                gsp[             +0] = coeff_c2s[2] * gcart[2*nbra];
                gsp[             +1] = coeff_c2s[2] * gcart[2*nbra+1];
                gsp[dgsp*OF_CMPLX+0] = coeff_c2s[4] * gcart[0*nbra];
                gsp[dgsp*OF_CMPLX+1] = coeff_c2s[4] * gcart[0*nbra+1];
                gsp += OF_CMPLX;
                gcart += OF_CMPLX;
        }
}
static void s_iket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const double *coeff_c2s = g_c2s[0].cart2j_lt_l;;
        unsigned int i;
        for (i = 0; i < nbra; i++) {
                gsp[             +0] =-coeff_c2s[2] * gcart[2*nbra+1];
                gsp[             +1] = coeff_c2s[2] * gcart[2*nbra];
                gsp[dgsp*OF_CMPLX+0] =-coeff_c2s[4] * gcart[0*nbra+1];
                gsp[dgsp*OF_CMPLX+1] = coeff_c2s[4] * gcart[0*nbra];
                gsp += OF_CMPLX;
                gcart += OF_CMPLX;
        }
}

static void p_bra_cart2spinor_sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[1].cart2j_lt_l;
                // spin-up part
                for (i = 0; i < nket; i++) {
                        gsp[0] = coeff_c2s[0]*gcart[0] + coeff_c2s[3]*gcart[3];
                        gsp[1] = coeff_c2s[0]*gcart[1] - coeff_c2s[3]*gcart[2];
                        gsp[2] = coeff_c2s[16]*gcart[4];
                        gsp[3] = coeff_c2s[16]*gcart[5];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
                gcart = gcart0;
                // spin-down part
                for (i = 0; i < nket; i++) {
                        gsp[0] = coeff_c2s[10]*gcart[4];
                        gsp[1] = coeff_c2s[10]*gcart[5];
                        gsp[2] = coeff_c2s[18]*gcart[0] + coeff_c2s[21]*gcart[3];
                        gsp[3] = coeff_c2s[18]*gcart[1] - coeff_c2s[21]*gcart[2];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + 4;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[1].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
                        gsp[0] = 0;
                        gsp[1] = 0;
                        gsp[2] = coeff_c2s[12]*gcart[0] + coeff_c2s[15]*gcart[3];
                        gsp[3] = coeff_c2s[12]*gcart[1] - coeff_c2s[15]*gcart[2];
                        gsp[4] = coeff_c2s[28]*gcart[4];
                        gsp[5] = coeff_c2s[28]*gcart[5];
                        gsp[6] = coeff_c2s[36]*gcart[0] + coeff_c2s[39]*gcart[3];
                        gsp[7] = coeff_c2s[36]*gcart[1] - coeff_c2s[39]*gcart[2];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
                        gsp[0] = coeff_c2s[6]*gcart[0] + coeff_c2s[9]*gcart[3];
                        gsp[1] = coeff_c2s[6]*gcart[1] - coeff_c2s[9]*gcart[2];
                        gsp[2] = coeff_c2s[22]*gcart[4];
                        gsp[3] = coeff_c2s[22]*gcart[5];
                        gsp[4] = coeff_c2s[30]*gcart[0] + coeff_c2s[33]*gcart[3];
                        gsp[5] = coeff_c2s[30]*gcart[1] - coeff_c2s[33]*gcart[2];
                        gsp[6] = 0;
                        gsp[7] = 0;
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
        }
}
static void p_bra_cart2spinor_e1sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                   double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[1].cart2j_lt_l;
                // spin-up part
                for (i = 0; i < nket; i++) {
                        gsp[0] = coeff_c2s[0]*gcart[0];
                        gsp[1] =-coeff_c2s[3]*gcart[1];
                        gsp[2] = coeff_c2s[16]*gcart[2];
                        gsp[3] = 0;
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3;
                }
                gcart = gcart0;
                // spin-down part
                for (i = 0; i < nket; i++) {
                        gsp[0] = coeff_c2s[10]*gcart[2];
                        gsp[1] = 0;
                        gsp[2] = coeff_c2s[18]*gcart[0];
                        gsp[3] =-coeff_c2s[21]*gcart[1];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3;
                }
                gcart = gcart0;
                gsp = gsp0 + 4;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[1].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
                        gsp[0] = 0;
                        gsp[1] = 0;
                        gsp[2] = coeff_c2s[12]*gcart[0];
                        gsp[3] =-coeff_c2s[15]*gcart[1];
                        gsp[4] = coeff_c2s[28]*gcart[2];
                        gsp[5] = 0;
                        gsp[6] = coeff_c2s[36]*gcart[0];
                        gsp[7] =-coeff_c2s[39]*gcart[1];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
                        gsp[0] = coeff_c2s[6]*gcart[0];
                        gsp[1] =-coeff_c2s[9]*gcart[1];
                        gsp[2] = coeff_c2s[22]*gcart[2];
                        gsp[3] = 0;
                        gsp[4] = coeff_c2s[30]*gcart[0];
                        gsp[5] =-coeff_c2s[33]*gcart[1];
                        gsp[6] = 0;
                        gsp[7] = 0;
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3;
                }
        }
}
static void p_bra_cart2spinor_si(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[1].cart2j_lt_l;
                // spin-up part
                for (i = 0; i < nket; i++) {
                        gsp[0] = coeff_c2s[0]*gcart[0] + coeff_c2s[3]*gcart[3];
                        gsp[1] = coeff_c2s[0]*gcart[1] - coeff_c2s[3]*gcart[2];
                        gsp[2] = coeff_c2s[16]*gcart[4];
                        gsp[3] = coeff_c2s[16]*gcart[5];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
                gsp = gsp0;
                // spin-down part
                for (i = 0; i < nket; i++) {
                        gsp[0] += coeff_c2s[10]*gcart[4];
                        gsp[1] += coeff_c2s[10]*gcart[5];
                        gsp[2] += coeff_c2s[18]*gcart[0] + coeff_c2s[21]*gcart[3];
                        gsp[3] += coeff_c2s[18]*gcart[1] - coeff_c2s[21]*gcart[2];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + 4;
                gsp0 = gsp0 + 4;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[1].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
                        gsp[0] = 0;
                        gsp[1] = 0;
                        gsp[2] = coeff_c2s[12]*gcart[0] + coeff_c2s[15]*gcart[3];
                        gsp[3] = coeff_c2s[12]*gcart[1] - coeff_c2s[15]*gcart[2];
                        gsp[4] = coeff_c2s[28]*gcart[4];
                        gsp[5] = coeff_c2s[28]*gcart[5];
                        gsp[6] = coeff_c2s[36]*gcart[0] + coeff_c2s[39]*gcart[3];
                        gsp[7] = coeff_c2s[36]*gcart[1] - coeff_c2s[39]*gcart[2];
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
                gsp = gsp0;
                for (i = 0; i < nket; i++) {
                        gsp[0] += coeff_c2s[6]*gcart[0] + coeff_c2s[9]*gcart[3];
                        gsp[1] += coeff_c2s[6]*gcart[1] - coeff_c2s[9]*gcart[2];
                        gsp[2] += coeff_c2s[22]*gcart[4];
                        gsp[3] += coeff_c2s[22]*gcart[5];
                        gsp[4] += coeff_c2s[30]*gcart[0] + coeff_c2s[33]*gcart[3];
                        gsp[5] += coeff_c2s[30]*gcart[1] - coeff_c2s[33]*gcart[2];
                        gsp[6] += 0;
                        gsp[7] += 0;
                        gsp += dgsp * OF_CMPLX;
                        gcart += 3 * OF_CMPLX;
                }
        }
}
static void p_ket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                              double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[1].cart2j_lt_l;
                for (i = 0; i < nbra; i++) {
        gsp[              0] = coeff_c2s[0]*gcart[0*nbra] - coeff_c2s[3]*gcart[2*nbra+1] + coeff_c2s[10]*gcart[10*nbra];
        gsp[              1] = coeff_c2s[0]*gcart[0*nbra+1] + coeff_c2s[3]*gcart[2*nbra] + coeff_c2s[10]*gcart[10*nbra+1];
        gsp[dgsp*OF_CMPLX+0] = coeff_c2s[16]*gcart[4*nbra] + coeff_c2s[18]*gcart[6*nbra] - coeff_c2s[21]*gcart[8*nbra+1];
        gsp[dgsp*OF_CMPLX+1] = coeff_c2s[16]*gcart[4*nbra+1] + coeff_c2s[18]*gcart[6*nbra+1] + coeff_c2s[21]*gcart[8*nbra];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + dgsp * OF_CMPLX * 2;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[1].cart2j_gt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] = coeff_c2s[6]*gcart[6*nbra] - coeff_c2s[9]*gcart[8*nbra+1];
        gsp[0*dgsp*OF_CMPLX+1] = coeff_c2s[6]*gcart[6*nbra+1] + coeff_c2s[9]*gcart[8*nbra];
        gsp[1*dgsp*OF_CMPLX+0] = coeff_c2s[12]*gcart[0*nbra] - coeff_c2s[15]*gcart[2*nbra+1] + coeff_c2s[22]*gcart[10*nbra];
        gsp[1*dgsp*OF_CMPLX+1] = coeff_c2s[12]*gcart[0*nbra+1] + coeff_c2s[15]*gcart[2*nbra] + coeff_c2s[22]*gcart[10*nbra+1];
        gsp[2*dgsp*OF_CMPLX+0] = coeff_c2s[28]*gcart[4*nbra] + coeff_c2s[30]*gcart[6*nbra] - coeff_c2s[33]*gcart[8*nbra+1];
        gsp[2*dgsp*OF_CMPLX+1] = coeff_c2s[28]*gcart[4*nbra+1] + coeff_c2s[30]*gcart[6*nbra+1] + coeff_c2s[33]*gcart[8*nbra];
        gsp[3*dgsp*OF_CMPLX+0] = coeff_c2s[36]*gcart[0*nbra] - coeff_c2s[39]*gcart[2*nbra+1];
        gsp[3*dgsp*OF_CMPLX+1] = coeff_c2s[36]*gcart[0*nbra+1] + coeff_c2s[39]*gcart[2*nbra];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
        }
}
static void p_iket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[1].cart2j_lt_l;
                for (i = 0; i < nbra; i++) {
        gsp[              0] =-(coeff_c2s[0]*gcart[0*nbra+1] + coeff_c2s[3]*gcart[2*nbra] + coeff_c2s[10]*gcart[10*nbra+1]);
        gsp[              1] =  coeff_c2s[0]*gcart[0*nbra] - coeff_c2s[3]*gcart[2*nbra+1] + coeff_c2s[10]*gcart[10*nbra];
        gsp[dgsp*OF_CMPLX+0] =-(coeff_c2s[16]*gcart[4*nbra+1] + coeff_c2s[18]*gcart[6*nbra+1] + coeff_c2s[21]*gcart[8*nbra]);
        gsp[dgsp*OF_CMPLX+1] =  coeff_c2s[16]*gcart[4*nbra] + coeff_c2s[18]*gcart[6*nbra] - coeff_c2s[21]*gcart[8*nbra+1];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + dgsp * OF_CMPLX * 2;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[1].cart2j_gt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] =-(coeff_c2s[6]*gcart[6*nbra+1] + coeff_c2s[9]*gcart[8*nbra]);
        gsp[0*dgsp*OF_CMPLX+1] =  coeff_c2s[6]*gcart[6*nbra] - coeff_c2s[9]*gcart[8*nbra+1];
        gsp[1*dgsp*OF_CMPLX+0] =-(coeff_c2s[12]*gcart[0*nbra+1] + coeff_c2s[15]*gcart[2*nbra] + coeff_c2s[22]*gcart[10*nbra+1]);
        gsp[1*dgsp*OF_CMPLX+1] =  coeff_c2s[12]*gcart[0*nbra] - coeff_c2s[15]*gcart[2*nbra+1] + coeff_c2s[22]*gcart[10*nbra];
        gsp[2*dgsp*OF_CMPLX+0] =-(coeff_c2s[28]*gcart[4*nbra+1] + coeff_c2s[30]*gcart[6*nbra+1] + coeff_c2s[33]*gcart[8*nbra]);
        gsp[2*dgsp*OF_CMPLX+1] =  coeff_c2s[28]*gcart[4*nbra] + coeff_c2s[30]*gcart[6*nbra] - coeff_c2s[33]*gcart[8*nbra+1];
        gsp[3*dgsp*OF_CMPLX+0] =-(coeff_c2s[36]*gcart[0*nbra+1] + coeff_c2s[39]*gcart[2*nbra]);
        gsp[3*dgsp*OF_CMPLX+1] =  coeff_c2s[36]*gcart[0*nbra] - coeff_c2s[39]*gcart[2*nbra+1];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
        }
}

static void d_bra_cart2spinor_sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[2].cart2j_lt_l;
                // spin-up part
                for (i = 0; i < nket; i++) {
        gsp[0] = coeff_c2s[0]*gcart[0] + coeff_c2s[6]*gcart[6] + coeff_c2s[3]*gcart[3];
        gsp[1] = coeff_c2s[0]*gcart[1] + coeff_c2s[6]*gcart[7] - coeff_c2s[3]*gcart[2];
        gsp[2] = coeff_c2s[28]*gcart[4] + coeff_c2s[33]*gcart[9];
        gsp[3] = coeff_c2s[28]*gcart[5] - coeff_c2s[33]*gcart[8];
        gsp[4] = coeff_c2s[48]*gcart[0] + coeff_c2s[54]*gcart[6] + coeff_c2s[58]*gcart[10];
        gsp[5] = coeff_c2s[48]*gcart[1] + coeff_c2s[54]*gcart[7] + coeff_c2s[58]*gcart[11];
        gsp[6] = coeff_c2s[76]*gcart[4] + coeff_c2s[81]*gcart[9];
        gsp[7] = coeff_c2s[76]*gcart[5] - coeff_c2s[81]*gcart[8];
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
                gcart = gcart0;
                // spin-down part
                for (i = 0; i < nket; i++) {
        gsp[0] = coeff_c2s[16]*gcart[4] + coeff_c2s[21]*gcart[9];
        gsp[1] = coeff_c2s[16]*gcart[5] - coeff_c2s[21]*gcart[8];
        gsp[2] = coeff_c2s[36]*gcart[0] + coeff_c2s[42]*gcart[6] + coeff_c2s[46]*gcart[10];
        gsp[3] = coeff_c2s[36]*gcart[1] + coeff_c2s[42]*gcart[7] + coeff_c2s[46]*gcart[11];
        gsp[4] = coeff_c2s[64]*gcart[4] + coeff_c2s[69]*gcart[9];
        gsp[5] = coeff_c2s[64]*gcart[5] - coeff_c2s[69]*gcart[8];
        gsp[6] = coeff_c2s[84]*gcart[0] + coeff_c2s[90]*gcart[6] + coeff_c2s[87]*gcart[3];
        gsp[7] = coeff_c2s[84]*gcart[1] + coeff_c2s[90]*gcart[7] - coeff_c2s[87]*gcart[2];
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + 8;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[2].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = 0;
        gsp[1 ] = 0;
        gsp[2 ] = coeff_c2s[24]*gcart[0] + coeff_c2s[30]*gcart[6] + coeff_c2s[27]*gcart[3];
        gsp[3 ] = coeff_c2s[24]*gcart[1] + coeff_c2s[30]*gcart[7] - coeff_c2s[27]*gcart[2];
        gsp[4 ] = coeff_c2s[52]*gcart[4] + coeff_c2s[57]*gcart[9];
        gsp[5 ] = coeff_c2s[52]*gcart[5] - coeff_c2s[57]*gcart[8];
        gsp[6 ] = coeff_c2s[72]*gcart[0] + coeff_c2s[78]*gcart[6] + coeff_c2s[82]*gcart[10];
        gsp[7 ] = coeff_c2s[72]*gcart[1] + coeff_c2s[78]*gcart[7] + coeff_c2s[82]*gcart[11];
        gsp[8 ] = coeff_c2s[100]*gcart[4] + coeff_c2s[105]*gcart[9];
        gsp[9 ] = coeff_c2s[100]*gcart[5] - coeff_c2s[105]*gcart[8];
        gsp[10] = coeff_c2s[120]*gcart[0] + coeff_c2s[126]*gcart[6] + coeff_c2s[123]*gcart[3];
        gsp[11] = coeff_c2s[120]*gcart[1] + coeff_c2s[126]*gcart[7] - coeff_c2s[123]*gcart[2];
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[12]*gcart[0] + coeff_c2s[18]*gcart[6] + coeff_c2s[15]*gcart[3];
        gsp[1 ] = coeff_c2s[12]*gcart[1] + coeff_c2s[18]*gcart[7] - coeff_c2s[15]*gcart[2];
        gsp[2 ] = coeff_c2s[40]*gcart[4] + coeff_c2s[45]*gcart[9];
        gsp[3 ] = coeff_c2s[40]*gcart[5] - coeff_c2s[45]*gcart[8];
        gsp[4 ] = coeff_c2s[60]*gcart[0] + coeff_c2s[66]*gcart[6] + coeff_c2s[70]*gcart[10];
        gsp[5 ] = coeff_c2s[60]*gcart[1] + coeff_c2s[66]*gcart[7] + coeff_c2s[70]*gcart[11];
        gsp[6 ] = coeff_c2s[88]*gcart[4] + coeff_c2s[93]*gcart[9];
        gsp[7 ] = coeff_c2s[88]*gcart[5] - coeff_c2s[93]*gcart[8];
        gsp[8 ] = coeff_c2s[108]*gcart[0] + coeff_c2s[114]*gcart[6] + coeff_c2s[111]*gcart[3];
        gsp[9 ] = coeff_c2s[108]*gcart[1] + coeff_c2s[114]*gcart[7] - coeff_c2s[111]*gcart[2];
        gsp[10] = 0;
        gsp[11] = 0;
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
        }
}
static void d_bra_cart2spinor_e1sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                   double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[2].cart2j_lt_l;
                // spin-up part
                for (i = 0; i < nket; i++) {
        gsp[0] = coeff_c2s[0]*gcart[0] + coeff_c2s[6]*gcart[3];
        gsp[1] =-coeff_c2s[3]*gcart[1];
        gsp[2] = coeff_c2s[28]*gcart[2];
        gsp[3] =-coeff_c2s[33]*gcart[4];
        gsp[4] = coeff_c2s[48]*gcart[0] + coeff_c2s[54]*gcart[3] + coeff_c2s[58]*gcart[5];
        gsp[5] = 0;
        gsp[6] = coeff_c2s[76]*gcart[2];
        gsp[7] =-coeff_c2s[81]*gcart[4];
        gsp += dgsp * OF_CMPLX;
        gcart += 6;
                }
                gcart = gcart0;
                // spin-down part
                for (i = 0; i < nket; i++) {
        gsp[0] = coeff_c2s[16]*gcart[2];
        gsp[1] =-coeff_c2s[21]*gcart[4];
        gsp[2] = coeff_c2s[36]*gcart[0] + coeff_c2s[42]*gcart[3] + coeff_c2s[46]*gcart[5];
        gsp[3] = 0;
        gsp[4] = coeff_c2s[64]*gcart[2];
        gsp[5] =-coeff_c2s[69]*gcart[4];
        gsp[6] = coeff_c2s[84]*gcart[0] + coeff_c2s[90]*gcart[3];
        gsp[7] =-coeff_c2s[87]*gcart[1];
        gsp += dgsp * OF_CMPLX;
        gcart += 6;
                }
                gcart = gcart0;
                gsp = gsp0 + 8;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[2].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = 0;
        gsp[1 ] = 0;
        gsp[2 ] = coeff_c2s[24]*gcart[0] + coeff_c2s[30]*gcart[3];
        gsp[3 ] =-coeff_c2s[27]*gcart[1];
        gsp[4 ] = coeff_c2s[52]*gcart[2];
        gsp[5 ] =-coeff_c2s[57]*gcart[4];
        gsp[6 ] = coeff_c2s[72]*gcart[0] + coeff_c2s[78]*gcart[3] + coeff_c2s[82]*gcart[5];
        gsp[7 ] = 0;
        gsp[8 ] = coeff_c2s[100]*gcart[2];
        gsp[9 ] =-coeff_c2s[105]*gcart[4];
        gsp[10] = coeff_c2s[120]*gcart[0] + coeff_c2s[126]*gcart[3];
        gsp[11] =-coeff_c2s[123]*gcart[1];
        gsp += dgsp * OF_CMPLX;
        gcart += 6;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[12]*gcart[0] + coeff_c2s[18]*gcart[3];
        gsp[1 ] =-coeff_c2s[15]*gcart[1];
        gsp[2 ] = coeff_c2s[40]*gcart[2];
        gsp[3 ] =-coeff_c2s[45]*gcart[4];
        gsp[4 ] = coeff_c2s[60]*gcart[0] + coeff_c2s[66]*gcart[3] + coeff_c2s[70]*gcart[5];
        gsp[5 ] = 0;
        gsp[6 ] = coeff_c2s[88]*gcart[2];
        gsp[7 ] =-coeff_c2s[93]*gcart[4];
        gsp[8 ] = coeff_c2s[108]*gcart[0] + coeff_c2s[114]*gcart[3];
        gsp[9 ] =-coeff_c2s[111]*gcart[1];
        gsp[10] = 0;
        gsp[11] = 0;
        gsp += dgsp * OF_CMPLX;
        gcart += 6;
                }
        }
}
static void d_bra_cart2spinor_si(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[2].cart2j_lt_l;
                for (i = 0; i < nket; i++) {
        gsp[0] = coeff_c2s[0]*gcart[0] + coeff_c2s[6]*gcart[6] + coeff_c2s[3]*gcart[3];
        gsp[1] = coeff_c2s[0]*gcart[1] + coeff_c2s[6]*gcart[7] - coeff_c2s[3]*gcart[2];
        gsp[2] = coeff_c2s[28]*gcart[4] + coeff_c2s[33]*gcart[9];
        gsp[3] = coeff_c2s[28]*gcart[5] - coeff_c2s[33]*gcart[8];
        gsp[4] = coeff_c2s[48]*gcart[0] + coeff_c2s[54]*gcart[6] + coeff_c2s[58]*gcart[10];
        gsp[5] = coeff_c2s[48]*gcart[1] + coeff_c2s[54]*gcart[7] + coeff_c2s[58]*gcart[11];
        gsp[6] = coeff_c2s[76]*gcart[4] + coeff_c2s[81]*gcart[9];
        gsp[7] = coeff_c2s[76]*gcart[5] - coeff_c2s[81]*gcart[8];
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
                gsp = gsp0;
                for (i = 0; i < nket; i++) {
        gsp[0] += coeff_c2s[16]*gcart[4] + coeff_c2s[21]*gcart[9];
        gsp[1] += coeff_c2s[16]*gcart[5] - coeff_c2s[21]*gcart[8];
        gsp[2] += coeff_c2s[36]*gcart[0] + coeff_c2s[42]*gcart[6] + coeff_c2s[46]*gcart[10];
        gsp[3] += coeff_c2s[36]*gcart[1] + coeff_c2s[42]*gcart[7] + coeff_c2s[46]*gcart[11];
        gsp[4] += coeff_c2s[64]*gcart[4] + coeff_c2s[69]*gcart[9];
        gsp[5] += coeff_c2s[64]*gcart[5] - coeff_c2s[69]*gcart[8];
        gsp[6] += coeff_c2s[84]*gcart[0] + coeff_c2s[90]*gcart[6] + coeff_c2s[87]*gcart[3];
        gsp[7] += coeff_c2s[84]*gcart[1] + coeff_c2s[90]*gcart[7] - coeff_c2s[87]*gcart[2];
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + 8;
                gsp0 = gsp0 + 8;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[2].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = 0;
        gsp[1 ] = 0;
        gsp[2 ] = coeff_c2s[24]*gcart[0] + coeff_c2s[30]*gcart[6] + coeff_c2s[27]*gcart[3];
        gsp[3 ] = coeff_c2s[24]*gcart[1] + coeff_c2s[30]*gcart[7] - coeff_c2s[27]*gcart[2];
        gsp[4 ] = coeff_c2s[52]*gcart[4] + coeff_c2s[57]*gcart[9];
        gsp[5 ] = coeff_c2s[52]*gcart[5] - coeff_c2s[57]*gcart[8];
        gsp[6 ] = coeff_c2s[72]*gcart[0] + coeff_c2s[78]*gcart[6] + coeff_c2s[82]*gcart[10];
        gsp[7 ] = coeff_c2s[72]*gcart[1] + coeff_c2s[78]*gcart[7] + coeff_c2s[82]*gcart[11];
        gsp[8 ] = coeff_c2s[100]*gcart[4] + coeff_c2s[105]*gcart[9];
        gsp[9 ] = coeff_c2s[100]*gcart[5] - coeff_c2s[105]*gcart[8];
        gsp[10] = coeff_c2s[120]*gcart[0] + coeff_c2s[126]*gcart[6] + coeff_c2s[123]*gcart[3];
        gsp[11] = coeff_c2s[120]*gcart[1] + coeff_c2s[126]*gcart[7] - coeff_c2s[123]*gcart[2];
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
                gsp = gsp0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] += coeff_c2s[12]*gcart[0] + coeff_c2s[18]*gcart[6] + coeff_c2s[15]*gcart[3];
        gsp[1 ] += coeff_c2s[12]*gcart[1] + coeff_c2s[18]*gcart[7] - coeff_c2s[15]*gcart[2];
        gsp[2 ] += coeff_c2s[40]*gcart[4] + coeff_c2s[45]*gcart[9];
        gsp[3 ] += coeff_c2s[40]*gcart[5] - coeff_c2s[45]*gcart[8];
        gsp[4 ] += coeff_c2s[60]*gcart[0] + coeff_c2s[66]*gcart[6] + coeff_c2s[70]*gcart[10];
        gsp[5 ] += coeff_c2s[60]*gcart[1] + coeff_c2s[66]*gcart[7] + coeff_c2s[70]*gcart[11];
        gsp[6 ] += coeff_c2s[88]*gcart[4] + coeff_c2s[93]*gcart[9];
        gsp[7 ] += coeff_c2s[88]*gcart[5] - coeff_c2s[93]*gcart[8];
        gsp[8 ] += coeff_c2s[108]*gcart[0] + coeff_c2s[114]*gcart[6] + coeff_c2s[111]*gcart[3];
        gsp[9 ] += coeff_c2s[108]*gcart[1] + coeff_c2s[114]*gcart[7] - coeff_c2s[111]*gcart[2];
        gsp[10] += 0;
        gsp[11] += 0;
        gsp += dgsp * OF_CMPLX;
        gcart += 6 * OF_CMPLX;
                }
        }
}
static void d_ket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                              double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[2].cart2j_lt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] = coeff_c2s[0]*gcart[0*nbra] + coeff_c2s[6]*gcart[6*nbra] - coeff_c2s[3]*gcart[2*nbra+1] + coeff_c2s[16]*gcart[16*nbra] - coeff_c2s[21]*gcart[20*nbra+1];
        gsp[0*dgsp*OF_CMPLX+1] = coeff_c2s[0]*gcart[0*nbra+1] + coeff_c2s[6]*gcart[6*nbra+1] + coeff_c2s[3]*gcart[2*nbra] + coeff_c2s[16]*gcart[16*nbra+1] + coeff_c2s[21]*gcart[20*nbra];
        gsp[1*dgsp*OF_CMPLX+0] = coeff_c2s[28]*gcart[4*nbra] - coeff_c2s[33]*gcart[8*nbra+1] + coeff_c2s[36]*gcart[12*nbra] + coeff_c2s[42]*gcart[18*nbra] + coeff_c2s[46]*gcart[22*nbra];
        gsp[1*dgsp*OF_CMPLX+1] = coeff_c2s[28]*gcart[4*nbra+1] + coeff_c2s[33]*gcart[8*nbra] + coeff_c2s[36]*gcart[12*nbra+1] + coeff_c2s[42]*gcart[18*nbra+1] + coeff_c2s[46]*gcart[22*nbra+1];
        gsp[2*dgsp*OF_CMPLX+0] = coeff_c2s[48]*gcart[0*nbra] + coeff_c2s[54]*gcart[6*nbra] + coeff_c2s[58]*gcart[10*nbra] + coeff_c2s[64]*gcart[16*nbra] - coeff_c2s[69]*gcart[20*nbra+1];
        gsp[2*dgsp*OF_CMPLX+1] = coeff_c2s[48]*gcart[0*nbra+1] + coeff_c2s[54]*gcart[6*nbra+1] + coeff_c2s[58]*gcart[10*nbra+1] + coeff_c2s[64]*gcart[16*nbra+1] + coeff_c2s[69]*gcart[20*nbra];
        gsp[3*dgsp*OF_CMPLX+0] = coeff_c2s[76]*gcart[4*nbra] - coeff_c2s[81]*gcart[8*nbra+1] + coeff_c2s[84]*gcart[12*nbra] + coeff_c2s[90]*gcart[18*nbra] - coeff_c2s[87]*gcart[14*nbra+1];
        gsp[3*dgsp*OF_CMPLX+1] = coeff_c2s[76]*gcart[4*nbra+1] + coeff_c2s[81]*gcart[8*nbra] + coeff_c2s[84]*gcart[12*nbra+1] + coeff_c2s[90]*gcart[18*nbra+1] + coeff_c2s[87]*gcart[14*nbra];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + dgsp*OF_CMPLX*4;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[2].cart2j_gt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] = coeff_c2s[12]*gcart[12*nbra] + coeff_c2s[18]*gcart[18*nbra] - coeff_c2s[15]*gcart[14*nbra+1];
        gsp[0*dgsp*OF_CMPLX+1] = coeff_c2s[12]*gcart[12*nbra+1] + coeff_c2s[18]*gcart[18*nbra+1] + coeff_c2s[15]*gcart[14*nbra];
        gsp[1*dgsp*OF_CMPLX+0] = coeff_c2s[24]*gcart[0*nbra] + coeff_c2s[30]*gcart[6*nbra] - coeff_c2s[27]*gcart[2*nbra+1] + coeff_c2s[40]*gcart[16*nbra] - coeff_c2s[45]*gcart[20*nbra+1];
        gsp[1*dgsp*OF_CMPLX+1] = coeff_c2s[24]*gcart[0*nbra+1] + coeff_c2s[30]*gcart[6*nbra+1] + coeff_c2s[27]*gcart[2*nbra] + coeff_c2s[40]*gcart[16*nbra+1] + coeff_c2s[45]*gcart[20*nbra];
        gsp[2*dgsp*OF_CMPLX+0] = coeff_c2s[52]*gcart[4*nbra] - coeff_c2s[57]*gcart[8*nbra+1] + coeff_c2s[60]*gcart[12*nbra] + coeff_c2s[66]*gcart[18*nbra] + coeff_c2s[70]*gcart[22*nbra];
        gsp[2*dgsp*OF_CMPLX+1] = coeff_c2s[52]*gcart[4*nbra+1] + coeff_c2s[57]*gcart[8*nbra] + coeff_c2s[60]*gcart[12*nbra+1] + coeff_c2s[66]*gcart[18*nbra+1] + coeff_c2s[70]*gcart[22*nbra+1];
        gsp[3*dgsp*OF_CMPLX+0] = coeff_c2s[72]*gcart[0*nbra] + coeff_c2s[78]*gcart[6*nbra] + coeff_c2s[82]*gcart[10*nbra] + coeff_c2s[88]*gcart[16*nbra] - coeff_c2s[93]*gcart[20*nbra+1];
        gsp[3*dgsp*OF_CMPLX+1] = coeff_c2s[72]*gcart[0*nbra+1] + coeff_c2s[78]*gcart[6*nbra+1] + coeff_c2s[82]*gcart[10*nbra+1] + coeff_c2s[88]*gcart[16*nbra+1] + coeff_c2s[93]*gcart[20*nbra];
        gsp[4*dgsp*OF_CMPLX+0] = coeff_c2s[100]*gcart[4*nbra] - coeff_c2s[105]*gcart[8*nbra+1] + coeff_c2s[108]*gcart[12*nbra] + coeff_c2s[114]*gcart[18*nbra] - coeff_c2s[111]*gcart[14*nbra+1];
        gsp[4*dgsp*OF_CMPLX+1] = coeff_c2s[100]*gcart[4*nbra+1] + coeff_c2s[105]*gcart[8*nbra] + coeff_c2s[108]*gcart[12*nbra+1] + coeff_c2s[114]*gcart[18*nbra+1] + coeff_c2s[111]*gcart[14*nbra];
        gsp[5*dgsp*OF_CMPLX+0] = coeff_c2s[120]*gcart[0*nbra] + coeff_c2s[126]*gcart[6*nbra] - coeff_c2s[123]*gcart[2*nbra+1];
        gsp[5*dgsp*OF_CMPLX+1] = coeff_c2s[120]*gcart[0*nbra+1] + coeff_c2s[126]*gcart[6*nbra+1] + coeff_c2s[123]*gcart[2*nbra];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
        }
}
static void d_iket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[2].cart2j_lt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] =-(coeff_c2s[0]*gcart[0*nbra+1] + coeff_c2s[6]*gcart[6*nbra+1] + coeff_c2s[3]*gcart[2*nbra] + coeff_c2s[16]*gcart[16*nbra+1] + coeff_c2s[21]*gcart[20*nbra]);
        gsp[0*dgsp*OF_CMPLX+1] =  coeff_c2s[0]*gcart[0*nbra] + coeff_c2s[6]*gcart[6*nbra] - coeff_c2s[3]*gcart[2*nbra+1] + coeff_c2s[16]*gcart[16*nbra] - coeff_c2s[21]*gcart[20*nbra+1];
        gsp[1*dgsp*OF_CMPLX+0] =-(coeff_c2s[28]*gcart[4*nbra+1] + coeff_c2s[33]*gcart[8*nbra] + coeff_c2s[36]*gcart[12*nbra+1] + coeff_c2s[42]*gcart[18*nbra+1] + coeff_c2s[46]*gcart[22*nbra+1]);
        gsp[1*dgsp*OF_CMPLX+1] =  coeff_c2s[28]*gcart[4*nbra] - coeff_c2s[33]*gcart[8*nbra+1] + coeff_c2s[36]*gcart[12*nbra] + coeff_c2s[42]*gcart[18*nbra] + coeff_c2s[46]*gcart[22*nbra];
        gsp[2*dgsp*OF_CMPLX+0] =-(coeff_c2s[48]*gcart[0*nbra+1] + coeff_c2s[54]*gcart[6*nbra+1] + coeff_c2s[58]*gcart[10*nbra+1] + coeff_c2s[64]*gcart[16*nbra+1] + coeff_c2s[69]*gcart[20*nbra]);
        gsp[2*dgsp*OF_CMPLX+1] =  coeff_c2s[48]*gcart[0*nbra] + coeff_c2s[54]*gcart[6*nbra] + coeff_c2s[58]*gcart[10*nbra] + coeff_c2s[64]*gcart[16*nbra] - coeff_c2s[69]*gcart[20*nbra+1];
        gsp[3*dgsp*OF_CMPLX+0] =-(coeff_c2s[76]*gcart[4*nbra+1] + coeff_c2s[81]*gcart[8*nbra] + coeff_c2s[84]*gcart[12*nbra+1] + coeff_c2s[90]*gcart[18*nbra+1] + coeff_c2s[87]*gcart[14*nbra]);
        gsp[3*dgsp*OF_CMPLX+1] =  coeff_c2s[76]*gcart[4*nbra] - coeff_c2s[81]*gcart[8*nbra+1] + coeff_c2s[84]*gcart[12*nbra] + coeff_c2s[90]*gcart[18*nbra] - coeff_c2s[87]*gcart[14*nbra+1];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + dgsp*OF_CMPLX*4;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[2].cart2j_gt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] =-(coeff_c2s[12]*gcart[12*nbra+1] + coeff_c2s[18]*gcart[18*nbra+1] + coeff_c2s[15]*gcart[14*nbra]);
        gsp[0*dgsp*OF_CMPLX+1] =  coeff_c2s[12]*gcart[12*nbra] + coeff_c2s[18]*gcart[18*nbra] - coeff_c2s[15]*gcart[14*nbra+1];
        gsp[1*dgsp*OF_CMPLX+0] =-(coeff_c2s[24]*gcart[0*nbra+1] + coeff_c2s[30]*gcart[6*nbra+1] + coeff_c2s[27]*gcart[2*nbra] + coeff_c2s[40]*gcart[16*nbra+1] + coeff_c2s[45]*gcart[20*nbra]);
        gsp[1*dgsp*OF_CMPLX+1] =  coeff_c2s[24]*gcart[0*nbra] + coeff_c2s[30]*gcart[6*nbra] - coeff_c2s[27]*gcart[2*nbra+1] + coeff_c2s[40]*gcart[16*nbra] - coeff_c2s[45]*gcart[20*nbra+1];
        gsp[2*dgsp*OF_CMPLX+0] =-(coeff_c2s[52]*gcart[4*nbra+1] + coeff_c2s[57]*gcart[8*nbra] + coeff_c2s[60]*gcart[12*nbra+1] + coeff_c2s[66]*gcart[18*nbra+1] + coeff_c2s[70]*gcart[22*nbra+1]);
        gsp[2*dgsp*OF_CMPLX+1] =  coeff_c2s[52]*gcart[4*nbra] - coeff_c2s[57]*gcart[8*nbra+1] + coeff_c2s[60]*gcart[12*nbra] + coeff_c2s[66]*gcart[18*nbra] + coeff_c2s[70]*gcart[22*nbra];
        gsp[3*dgsp*OF_CMPLX+0] =-(coeff_c2s[72]*gcart[0*nbra+1] + coeff_c2s[78]*gcart[6*nbra+1] + coeff_c2s[82]*gcart[10*nbra+1] + coeff_c2s[88]*gcart[16*nbra+1] + coeff_c2s[93]*gcart[20*nbra]);
        gsp[3*dgsp*OF_CMPLX+1] =  coeff_c2s[72]*gcart[0*nbra] + coeff_c2s[78]*gcart[6*nbra] + coeff_c2s[82]*gcart[10*nbra] + coeff_c2s[88]*gcart[16*nbra] - coeff_c2s[93]*gcart[20*nbra+1];
        gsp[4*dgsp*OF_CMPLX+0] =-(coeff_c2s[100]*gcart[4*nbra+1] + coeff_c2s[105]*gcart[8*nbra] + coeff_c2s[108]*gcart[12*nbra+1] + coeff_c2s[114]*gcart[18*nbra+1] + coeff_c2s[111]*gcart[14*nbra]);
        gsp[4*dgsp*OF_CMPLX+1] =  coeff_c2s[100]*gcart[4*nbra] - coeff_c2s[105]*gcart[8*nbra+1] + coeff_c2s[108]*gcart[12*nbra] + coeff_c2s[114]*gcart[18*nbra] - coeff_c2s[111]*gcart[14*nbra+1];
        gsp[5*dgsp*OF_CMPLX+0] =-(coeff_c2s[120]*gcart[0*nbra+1] + coeff_c2s[126]*gcart[6*nbra+1] + coeff_c2s[123]*gcart[2*nbra]);
        gsp[5*dgsp*OF_CMPLX+1] =  coeff_c2s[120]*gcart[0*nbra] + coeff_c2s[126]*gcart[6*nbra] - coeff_c2s[123]*gcart[2*nbra+1];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
        }
}

static void f_bra_cart2spinor_sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[3].cart2j_lt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[0]*gcart[0] + coeff_c2s[3]*gcart[3] + coeff_c2s[6]*gcart[6] + coeff_c2s[13]*gcart[13];
        gsp[1 ] = coeff_c2s[0]*gcart[1] - coeff_c2s[3]*gcart[2] + coeff_c2s[6]*gcart[7] - coeff_c2s[13]*gcart[12];
        gsp[2 ] = coeff_c2s[44]*gcart[4] + coeff_c2s[49]*gcart[9] + coeff_c2s[54]*gcart[14];
        gsp[3 ] = coeff_c2s[44]*gcart[5] - coeff_c2s[49]*gcart[8] + coeff_c2s[54]*gcart[15];
        gsp[4 ] = coeff_c2s[80]*gcart[0] + coeff_c2s[83]*gcart[3] + coeff_c2s[86]*gcart[6] + coeff_c2s[90]*gcart[10] + coeff_c2s[93]*gcart[13] + coeff_c2s[97]*gcart[17];
        gsp[5 ] = coeff_c2s[80]*gcart[1] - coeff_c2s[83]*gcart[2] + coeff_c2s[86]*gcart[7] + coeff_c2s[90]*gcart[11] - coeff_c2s[93]*gcart[12] - coeff_c2s[97]*gcart[16];
        gsp[6 ] = coeff_c2s[124]*gcart[4] + coeff_c2s[134]*gcart[14] + coeff_c2s[138]*gcart[18];
        gsp[7 ] = coeff_c2s[124]*gcart[5] + coeff_c2s[134]*gcart[15] + coeff_c2s[138]*gcart[19];
        gsp[8 ] = coeff_c2s[160]*gcart[0] + coeff_c2s[163]*gcart[3] + coeff_c2s[166]*gcart[6] + coeff_c2s[170]*gcart[10] + coeff_c2s[173]*gcart[13] + coeff_c2s[177]*gcart[17];
        gsp[9 ] = coeff_c2s[160]*gcart[1] - coeff_c2s[163]*gcart[2] + coeff_c2s[166]*gcart[7] + coeff_c2s[170]*gcart[11] - coeff_c2s[173]*gcart[12] - coeff_c2s[177]*gcart[16];
        gsp[10] = coeff_c2s[204]*gcart[4] + coeff_c2s[209]*gcart[9] + coeff_c2s[214]*gcart[14];
        gsp[11] = coeff_c2s[204]*gcart[5] - coeff_c2s[209]*gcart[8] + coeff_c2s[214]*gcart[15];
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[24]*gcart[4] + coeff_c2s[29]*gcart[9] + coeff_c2s[34]*gcart[14];
        gsp[1 ] = coeff_c2s[24]*gcart[5] - coeff_c2s[29]*gcart[8] + coeff_c2s[34]*gcart[15];
        gsp[2 ] = coeff_c2s[60]*gcart[0] + coeff_c2s[63]*gcart[3] + coeff_c2s[66]*gcart[6] + coeff_c2s[70]*gcart[10] + coeff_c2s[73]*gcart[13] + coeff_c2s[77]*gcart[17];
        gsp[3 ] = coeff_c2s[60]*gcart[1] - coeff_c2s[63]*gcart[2] + coeff_c2s[66]*gcart[7] + coeff_c2s[70]*gcart[11] - coeff_c2s[73]*gcart[12] - coeff_c2s[77]*gcart[16];
        gsp[4 ] = coeff_c2s[104]*gcart[4] + coeff_c2s[114]*gcart[14] + coeff_c2s[118]*gcart[18];
        gsp[5 ] = coeff_c2s[104]*gcart[5] + coeff_c2s[114]*gcart[15] + coeff_c2s[118]*gcart[19];
        gsp[6 ] = coeff_c2s[140]*gcart[0] + coeff_c2s[143]*gcart[3] + coeff_c2s[146]*gcart[6] + coeff_c2s[150]*gcart[10] + coeff_c2s[153]*gcart[13] + coeff_c2s[157]*gcart[17];
        gsp[7 ] = coeff_c2s[140]*gcart[1] - coeff_c2s[143]*gcart[2] + coeff_c2s[146]*gcart[7] + coeff_c2s[150]*gcart[11] - coeff_c2s[153]*gcart[12] - coeff_c2s[157]*gcart[16];
        gsp[8 ] = coeff_c2s[184]*gcart[4] + coeff_c2s[189]*gcart[9] + coeff_c2s[194]*gcart[14];
        gsp[9 ] = coeff_c2s[184]*gcart[5] - coeff_c2s[189]*gcart[8] + coeff_c2s[194]*gcart[15];
        gsp[10] = coeff_c2s[220]*gcart[0] + coeff_c2s[223]*gcart[3] + coeff_c2s[226]*gcart[6] + coeff_c2s[233]*gcart[13];
        gsp[11] = coeff_c2s[220]*gcart[1] - coeff_c2s[223]*gcart[2] + coeff_c2s[226]*gcart[7] - coeff_c2s[233]*gcart[12];
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + 12;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[3].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = 0;
        gsp[1 ] = 0;
        gsp[2 ] = coeff_c2s[40]*gcart[0] + coeff_c2s[43]*gcart[3] + coeff_c2s[46]*gcart[6] + coeff_c2s[53]*gcart[13];
        gsp[3 ] = coeff_c2s[40]*gcart[1] - coeff_c2s[43]*gcart[2] + coeff_c2s[46]*gcart[7] - coeff_c2s[53]*gcart[12];
        gsp[4 ] = coeff_c2s[84]*gcart[4] + coeff_c2s[89]*gcart[9] + coeff_c2s[94]*gcart[14];
        gsp[5 ] = coeff_c2s[84]*gcart[5] - coeff_c2s[89]*gcart[8] + coeff_c2s[94]*gcart[15];
        gsp[6 ] = coeff_c2s[120]*gcart[0] + coeff_c2s[123]*gcart[3] + coeff_c2s[126]*gcart[6] + coeff_c2s[130]*gcart[10] + coeff_c2s[133]*gcart[13] + coeff_c2s[137]*gcart[17];
        gsp[7 ] = coeff_c2s[120]*gcart[1] - coeff_c2s[123]*gcart[2] + coeff_c2s[126]*gcart[7] + coeff_c2s[130]*gcart[11] - coeff_c2s[133]*gcart[12] - coeff_c2s[137]*gcart[16];
        gsp[8 ] = coeff_c2s[164]*gcart[4] + coeff_c2s[174]*gcart[14] + coeff_c2s[178]*gcart[18];
        gsp[9 ] = coeff_c2s[164]*gcart[5] + coeff_c2s[174]*gcart[15] + coeff_c2s[178]*gcart[19];
        gsp[10] = coeff_c2s[200]*gcart[0] + coeff_c2s[203]*gcart[3] + coeff_c2s[206]*gcart[6] + coeff_c2s[210]*gcart[10] + coeff_c2s[213]*gcart[13] + coeff_c2s[217]*gcart[17];
        gsp[11] = coeff_c2s[200]*gcart[1] - coeff_c2s[203]*gcart[2] + coeff_c2s[206]*gcart[7] + coeff_c2s[210]*gcart[11] - coeff_c2s[213]*gcart[12] - coeff_c2s[217]*gcart[16];
        gsp[12] = coeff_c2s[244]*gcart[4] + coeff_c2s[249]*gcart[9] + coeff_c2s[254]*gcart[14];
        gsp[13] = coeff_c2s[244]*gcart[5] - coeff_c2s[249]*gcart[8] + coeff_c2s[254]*gcart[15];
        gsp[14] = coeff_c2s[280]*gcart[0] + coeff_c2s[283]*gcart[3] + coeff_c2s[286]*gcart[6] + coeff_c2s[293]*gcart[13];
        gsp[15] = coeff_c2s[280]*gcart[1] - coeff_c2s[283]*gcart[2] + coeff_c2s[286]*gcart[7] - coeff_c2s[293]*gcart[12];
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[20]*gcart[0] + coeff_c2s[23]*gcart[3] + coeff_c2s[26]*gcart[6] + coeff_c2s[33]*gcart[13];
        gsp[1 ] = coeff_c2s[20]*gcart[1] - coeff_c2s[23]*gcart[2] + coeff_c2s[26]*gcart[7] - coeff_c2s[33]*gcart[12];
        gsp[2 ] = coeff_c2s[64]*gcart[4] + coeff_c2s[69]*gcart[9] + coeff_c2s[74]*gcart[14];
        gsp[3 ] = coeff_c2s[64]*gcart[5] - coeff_c2s[69]*gcart[8] + coeff_c2s[74]*gcart[15];
        gsp[4 ] = coeff_c2s[100]*gcart[0] + coeff_c2s[103]*gcart[3] + coeff_c2s[106]*gcart[6] + coeff_c2s[110]*gcart[10] + coeff_c2s[113]*gcart[13] + coeff_c2s[117]*gcart[17];
        gsp[5 ] = coeff_c2s[100]*gcart[1] - coeff_c2s[103]*gcart[2] + coeff_c2s[106]*gcart[7] + coeff_c2s[110]*gcart[11] - coeff_c2s[113]*gcart[12] - coeff_c2s[117]*gcart[16];
        gsp[6 ] = coeff_c2s[144]*gcart[4] + coeff_c2s[154]*gcart[14] + coeff_c2s[158]*gcart[18];
        gsp[7 ] = coeff_c2s[144]*gcart[5] + coeff_c2s[154]*gcart[15] + coeff_c2s[158]*gcart[19];
        gsp[8 ] = coeff_c2s[180]*gcart[0] + coeff_c2s[183]*gcart[3] + coeff_c2s[186]*gcart[6] + coeff_c2s[190]*gcart[10] + coeff_c2s[193]*gcart[13] + coeff_c2s[197]*gcart[17];
        gsp[9 ] = coeff_c2s[180]*gcart[1] - coeff_c2s[183]*gcart[2] + coeff_c2s[186]*gcart[7] + coeff_c2s[190]*gcart[11] - coeff_c2s[193]*gcart[12] - coeff_c2s[197]*gcart[16];
        gsp[10] = coeff_c2s[224]*gcart[4] + coeff_c2s[229]*gcart[9] + coeff_c2s[234]*gcart[14];
        gsp[11] = coeff_c2s[224]*gcart[5] - coeff_c2s[229]*gcart[8] + coeff_c2s[234]*gcart[15];
        gsp[12] = coeff_c2s[260]*gcart[0] + coeff_c2s[263]*gcart[3] + coeff_c2s[266]*gcart[6] + coeff_c2s[273]*gcart[13];
        gsp[13] = coeff_c2s[260]*gcart[1] - coeff_c2s[263]*gcart[2] + coeff_c2s[266]*gcart[7] - coeff_c2s[273]*gcart[12];
        gsp[14] = 0;
        gsp[15] = 0;
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
        }
}
static void f_bra_cart2spinor_e1sf(double *gsp, unsigned int dgsp, unsigned int nket,
                                   double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[3].cart2j_lt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[0]*gcart[0] + coeff_c2s[6]*gcart[3];
        gsp[1 ] =-coeff_c2s[3]*gcart[1] - coeff_c2s[13]*gcart[6];
        gsp[2 ] = coeff_c2s[44]*gcart[2] + coeff_c2s[54]*gcart[7];
        gsp[3 ] =-coeff_c2s[49]*gcart[4];
        gsp[4 ] = coeff_c2s[80]*gcart[0] + coeff_c2s[86]*gcart[3] + coeff_c2s[90]*gcart[5];
        gsp[5 ] =-coeff_c2s[83]*gcart[1] - coeff_c2s[93]*gcart[6] - coeff_c2s[97]*gcart[8];
        gsp[6 ] = coeff_c2s[124]*gcart[2] + coeff_c2s[134]*gcart[7] + coeff_c2s[138]*gcart[9];
        gsp[7 ] = 0;
        gsp[8 ] = coeff_c2s[160]*gcart[0] + coeff_c2s[166]*gcart[3] + coeff_c2s[170]*gcart[5];
        gsp[9 ] =-coeff_c2s[163]*gcart[1] - coeff_c2s[173]*gcart[6] - coeff_c2s[177]*gcart[8];
        gsp[10] = coeff_c2s[204]*gcart[2] + coeff_c2s[214]*gcart[7];
        gsp[11] =-coeff_c2s[209]*gcart[4];
        gsp += dgsp * OF_CMPLX;
        gcart += 10;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[24]*gcart[2] + coeff_c2s[34]*gcart[7];
        gsp[1 ] =-coeff_c2s[29]*gcart[4];
        gsp[2 ] = coeff_c2s[60]*gcart[0] + coeff_c2s[66]*gcart[3] + coeff_c2s[70]*gcart[5];
        gsp[3 ] =-coeff_c2s[63]*gcart[1] - coeff_c2s[73]*gcart[6] - coeff_c2s[77]*gcart[8];
        gsp[4 ] = coeff_c2s[104]*gcart[2] + coeff_c2s[114]*gcart[7] + coeff_c2s[118]*gcart[9];
        gsp[5 ] = 0;
        gsp[6 ] = coeff_c2s[140]*gcart[0] + coeff_c2s[146]*gcart[3] + coeff_c2s[150]*gcart[5];
        gsp[7 ] =-coeff_c2s[143]*gcart[1] - coeff_c2s[153]*gcart[6] - coeff_c2s[157]*gcart[8];
        gsp[8 ] = coeff_c2s[184]*gcart[2] + coeff_c2s[194]*gcart[7];
        gsp[9 ] =-coeff_c2s[189]*gcart[4];
        gsp[10] = coeff_c2s[220]*gcart[0] + coeff_c2s[226]*gcart[3];
        gsp[11] =-coeff_c2s[223]*gcart[1] - coeff_c2s[233]*gcart[6];
        gsp += dgsp * OF_CMPLX;
        gcart += 10;
                }
                gcart = gcart0;
                gsp = gsp0 + 12;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[3].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = 0;
        gsp[1 ] = 0;
        gsp[2 ] = coeff_c2s[40]*gcart[0] + coeff_c2s[46]*gcart[3];
        gsp[3 ] =-coeff_c2s[43]*gcart[1] - coeff_c2s[53]*gcart[6];
        gsp[4 ] = coeff_c2s[84]*gcart[2] + coeff_c2s[94]*gcart[7];
        gsp[5 ] =-coeff_c2s[89]*gcart[4];
        gsp[6 ] = coeff_c2s[120]*gcart[0] + coeff_c2s[126]*gcart[3] + coeff_c2s[130]*gcart[5];
        gsp[7 ] =-coeff_c2s[123]*gcart[1] - coeff_c2s[133]*gcart[6] - coeff_c2s[137]*gcart[8];
        gsp[8 ] = coeff_c2s[164]*gcart[2] + coeff_c2s[174]*gcart[7] + coeff_c2s[178]*gcart[9];
        gsp[9 ] = 0;
        gsp[10] = coeff_c2s[200]*gcart[0] + coeff_c2s[206]*gcart[3] + coeff_c2s[210]*gcart[5];
        gsp[11] =-coeff_c2s[203]*gcart[1] - coeff_c2s[213]*gcart[6] - coeff_c2s[217]*gcart[8];
        gsp[12] = coeff_c2s[244]*gcart[2] + coeff_c2s[254]*gcart[7];
        gsp[13] =-coeff_c2s[249]*gcart[4];
        gsp[14] = coeff_c2s[280]*gcart[0] + coeff_c2s[286]*gcart[3];
        gsp[15] =-coeff_c2s[283]*gcart[1] - coeff_c2s[293]*gcart[6];
        gsp += dgsp * OF_CMPLX;
        gcart += 10;
                }
                gcart = gcart0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[20]*gcart[0] + coeff_c2s[26]*gcart[3];
        gsp[1 ] =-coeff_c2s[23]*gcart[1] - coeff_c2s[33]*gcart[6];
        gsp[2 ] = coeff_c2s[64]*gcart[2] + coeff_c2s[74]*gcart[7];
        gsp[3 ] =-coeff_c2s[69]*gcart[4];
        gsp[4 ] = coeff_c2s[100]*gcart[0] + coeff_c2s[106]*gcart[3] + coeff_c2s[110]*gcart[5];
        gsp[5 ] =-coeff_c2s[103]*gcart[1] - coeff_c2s[113]*gcart[6] - coeff_c2s[117]*gcart[8];
        gsp[6 ] = coeff_c2s[144]*gcart[2] + coeff_c2s[154]*gcart[7] + coeff_c2s[158]*gcart[9];
        gsp[7 ] = 0;
        gsp[8 ] = coeff_c2s[180]*gcart[0] + coeff_c2s[186]*gcart[3] + coeff_c2s[190]*gcart[5];
        gsp[9 ] =-coeff_c2s[183]*gcart[1] - coeff_c2s[193]*gcart[6] - coeff_c2s[197]*gcart[8];
        gsp[10] = coeff_c2s[224]*gcart[2] + coeff_c2s[234]*gcart[7];
        gsp[11] =-coeff_c2s[229]*gcart[4];
        gsp[12] = coeff_c2s[260]*gcart[0] + coeff_c2s[266]*gcart[3];
        gsp[13] =-coeff_c2s[263]*gcart[1] - coeff_c2s[273]*gcart[6];
        gsp[14] = 0;
        gsp[15] = 0;
        gsp += dgsp * OF_CMPLX;
        gcart += 10;
                }
        }
}
static void f_bra_cart2spinor_si(double *gsp, unsigned int dgsp, unsigned int nket,
                                 double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[3].cart2j_lt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = coeff_c2s[0]*gcart[0] + coeff_c2s[3]*gcart[3] + coeff_c2s[6]*gcart[6] + coeff_c2s[13]*gcart[13];
        gsp[1 ] = coeff_c2s[0]*gcart[1] - coeff_c2s[3]*gcart[2] + coeff_c2s[6]*gcart[7] - coeff_c2s[13]*gcart[12];
        gsp[2 ] = coeff_c2s[44]*gcart[4] + coeff_c2s[49]*gcart[9] + coeff_c2s[54]*gcart[14];
        gsp[3 ] = coeff_c2s[44]*gcart[5] - coeff_c2s[49]*gcart[8] + coeff_c2s[54]*gcart[15];
        gsp[4 ] = coeff_c2s[80]*gcart[0] + coeff_c2s[83]*gcart[3] + coeff_c2s[86]*gcart[6] + coeff_c2s[90]*gcart[10] + coeff_c2s[93]*gcart[13] + coeff_c2s[97]*gcart[17];
        gsp[5 ] = coeff_c2s[80]*gcart[1] - coeff_c2s[83]*gcart[2] + coeff_c2s[86]*gcart[7] + coeff_c2s[90]*gcart[11] - coeff_c2s[93]*gcart[12] - coeff_c2s[97]*gcart[16];
        gsp[6 ] = coeff_c2s[124]*gcart[4] + coeff_c2s[134]*gcart[14] + coeff_c2s[138]*gcart[18];
        gsp[7 ] = coeff_c2s[124]*gcart[5] + coeff_c2s[134]*gcart[15] + coeff_c2s[138]*gcart[19];
        gsp[8 ] = coeff_c2s[160]*gcart[0] + coeff_c2s[163]*gcart[3] + coeff_c2s[166]*gcart[6] + coeff_c2s[170]*gcart[10] + coeff_c2s[173]*gcart[13] + coeff_c2s[177]*gcart[17];
        gsp[9 ] = coeff_c2s[160]*gcart[1] - coeff_c2s[163]*gcart[2] + coeff_c2s[166]*gcart[7] + coeff_c2s[170]*gcart[11] - coeff_c2s[173]*gcart[12] - coeff_c2s[177]*gcart[16];
        gsp[10] = coeff_c2s[204]*gcart[4] + coeff_c2s[209]*gcart[9] + coeff_c2s[214]*gcart[14];
        gsp[11] = coeff_c2s[204]*gcart[5] - coeff_c2s[209]*gcart[8] + coeff_c2s[214]*gcart[15];
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
                gsp = gsp0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] += coeff_c2s[24]*gcart[4] + coeff_c2s[29]*gcart[9] + coeff_c2s[34]*gcart[14];
        gsp[1 ] += coeff_c2s[24]*gcart[5] - coeff_c2s[29]*gcart[8] + coeff_c2s[34]*gcart[15];
        gsp[2 ] += coeff_c2s[60]*gcart[0] + coeff_c2s[63]*gcart[3] + coeff_c2s[66]*gcart[6] + coeff_c2s[70]*gcart[10] + coeff_c2s[73]*gcart[13] + coeff_c2s[77]*gcart[17];
        gsp[3 ] += coeff_c2s[60]*gcart[1] - coeff_c2s[63]*gcart[2] + coeff_c2s[66]*gcart[7] + coeff_c2s[70]*gcart[11] - coeff_c2s[73]*gcart[12] - coeff_c2s[77]*gcart[16];
        gsp[4 ] += coeff_c2s[104]*gcart[4] + coeff_c2s[114]*gcart[14] + coeff_c2s[118]*gcart[18];
        gsp[5 ] += coeff_c2s[104]*gcart[5] + coeff_c2s[114]*gcart[15] + coeff_c2s[118]*gcart[19];
        gsp[6 ] += coeff_c2s[140]*gcart[0] + coeff_c2s[143]*gcart[3] + coeff_c2s[146]*gcart[6] + coeff_c2s[150]*gcart[10] + coeff_c2s[153]*gcart[13] + coeff_c2s[157]*gcart[17];
        gsp[7 ] += coeff_c2s[140]*gcart[1] - coeff_c2s[143]*gcart[2] + coeff_c2s[146]*gcart[7] + coeff_c2s[150]*gcart[11] - coeff_c2s[153]*gcart[12] - coeff_c2s[157]*gcart[16];
        gsp[8 ] += coeff_c2s[184]*gcart[4] + coeff_c2s[189]*gcart[9] + coeff_c2s[194]*gcart[14];
        gsp[9 ] += coeff_c2s[184]*gcart[5] - coeff_c2s[189]*gcart[8] + coeff_c2s[194]*gcart[15];
        gsp[10] += coeff_c2s[220]*gcart[0] + coeff_c2s[223]*gcart[3] + coeff_c2s[226]*gcart[6] + coeff_c2s[233]*gcart[13];
        gsp[11] += coeff_c2s[220]*gcart[1] - coeff_c2s[223]*gcart[2] + coeff_c2s[226]*gcart[7] - coeff_c2s[233]*gcart[12];
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + 12;
                gsp0 = gsp0 + 12;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[3].cart2j_gt_l;
                for (i = 0; i < nket; i++) {
        gsp[0 ] = 0;
        gsp[1 ] = 0;
        gsp[2 ] = coeff_c2s[40]*gcart[0] + coeff_c2s[43]*gcart[3] + coeff_c2s[46]*gcart[6] + coeff_c2s[53]*gcart[13];
        gsp[3 ] = coeff_c2s[40]*gcart[1] - coeff_c2s[43]*gcart[2] + coeff_c2s[46]*gcart[7] - coeff_c2s[53]*gcart[12];
        gsp[4 ] = coeff_c2s[84]*gcart[4] + coeff_c2s[89]*gcart[9] + coeff_c2s[94]*gcart[14];
        gsp[5 ] = coeff_c2s[84]*gcart[5] - coeff_c2s[89]*gcart[8] + coeff_c2s[94]*gcart[15];
        gsp[6 ] = coeff_c2s[120]*gcart[0] + coeff_c2s[123]*gcart[3] + coeff_c2s[126]*gcart[6] + coeff_c2s[130]*gcart[10] + coeff_c2s[133]*gcart[13] + coeff_c2s[137]*gcart[17];
        gsp[7 ] = coeff_c2s[120]*gcart[1] - coeff_c2s[123]*gcart[2] + coeff_c2s[126]*gcart[7] + coeff_c2s[130]*gcart[11] - coeff_c2s[133]*gcart[12] - coeff_c2s[137]*gcart[16];
        gsp[8 ] = coeff_c2s[164]*gcart[4] + coeff_c2s[174]*gcart[14] + coeff_c2s[178]*gcart[18];
        gsp[9 ] = coeff_c2s[164]*gcart[5] + coeff_c2s[174]*gcart[15] + coeff_c2s[178]*gcart[19];
        gsp[10] = coeff_c2s[200]*gcart[0] + coeff_c2s[203]*gcart[3] + coeff_c2s[206]*gcart[6] + coeff_c2s[210]*gcart[10] + coeff_c2s[213]*gcart[13] + coeff_c2s[217]*gcart[17];
        gsp[11] = coeff_c2s[200]*gcart[1] - coeff_c2s[203]*gcart[2] + coeff_c2s[206]*gcart[7] + coeff_c2s[210]*gcart[11] - coeff_c2s[213]*gcart[12] - coeff_c2s[217]*gcart[16];
        gsp[12] = coeff_c2s[244]*gcart[4] + coeff_c2s[249]*gcart[9] + coeff_c2s[254]*gcart[14];
        gsp[13] = coeff_c2s[244]*gcart[5] - coeff_c2s[249]*gcart[8] + coeff_c2s[254]*gcart[15];
        gsp[14] = coeff_c2s[280]*gcart[0] + coeff_c2s[283]*gcart[3] + coeff_c2s[286]*gcart[6] + coeff_c2s[293]*gcart[13];
        gsp[15] = coeff_c2s[280]*gcart[1] - coeff_c2s[283]*gcart[2] + coeff_c2s[286]*gcart[7] - coeff_c2s[293]*gcart[12];
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
                gsp = gsp0;
                for (i = 0; i < nket; i++) {
        gsp[0 ] += coeff_c2s[20]*gcart[0] + coeff_c2s[23]*gcart[3] + coeff_c2s[26]*gcart[6] + coeff_c2s[33]*gcart[13];
        gsp[1 ] += coeff_c2s[20]*gcart[1] - coeff_c2s[23]*gcart[2] + coeff_c2s[26]*gcart[7] - coeff_c2s[33]*gcart[12];
        gsp[2 ] += coeff_c2s[64]*gcart[4] + coeff_c2s[69]*gcart[9] + coeff_c2s[74]*gcart[14];
        gsp[3 ] += coeff_c2s[64]*gcart[5] - coeff_c2s[69]*gcart[8] + coeff_c2s[74]*gcart[15];
        gsp[4 ] += coeff_c2s[100]*gcart[0] + coeff_c2s[103]*gcart[3] + coeff_c2s[106]*gcart[6] + coeff_c2s[110]*gcart[10] + coeff_c2s[113]*gcart[13] + coeff_c2s[117]*gcart[17];
        gsp[5 ] += coeff_c2s[100]*gcart[1] - coeff_c2s[103]*gcart[2] + coeff_c2s[106]*gcart[7] + coeff_c2s[110]*gcart[11] - coeff_c2s[113]*gcart[12] - coeff_c2s[117]*gcart[16];
        gsp[6 ] += coeff_c2s[144]*gcart[4] + coeff_c2s[154]*gcart[14] + coeff_c2s[158]*gcart[18];
        gsp[7 ] += coeff_c2s[144]*gcart[5] + coeff_c2s[154]*gcart[15] + coeff_c2s[158]*gcart[19];
        gsp[8 ] += coeff_c2s[180]*gcart[0] + coeff_c2s[183]*gcart[3] + coeff_c2s[186]*gcart[6] + coeff_c2s[190]*gcart[10] + coeff_c2s[193]*gcart[13] + coeff_c2s[197]*gcart[17];
        gsp[9 ] += coeff_c2s[180]*gcart[1] - coeff_c2s[183]*gcart[2] + coeff_c2s[186]*gcart[7] + coeff_c2s[190]*gcart[11] - coeff_c2s[193]*gcart[12] - coeff_c2s[197]*gcart[16];
        gsp[10] += coeff_c2s[224]*gcart[4] + coeff_c2s[229]*gcart[9] + coeff_c2s[234]*gcart[14];
        gsp[11] += coeff_c2s[224]*gcart[5] - coeff_c2s[229]*gcart[8] + coeff_c2s[234]*gcart[15];
        gsp[12] += coeff_c2s[260]*gcart[0] + coeff_c2s[263]*gcart[3] + coeff_c2s[266]*gcart[6] + coeff_c2s[273]*gcart[13];
        gsp[13] += coeff_c2s[260]*gcart[1] - coeff_c2s[263]*gcart[2] + coeff_c2s[266]*gcart[7] - coeff_c2s[273]*gcart[12];
        gsp[14] += 0;
        gsp[15] += 0;
        gsp += dgsp * OF_CMPLX;
        gcart += 10 * OF_CMPLX;
                }
        }
}
static void f_ket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                              double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[3].cart2j_lt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] = coeff_c2s[0]*gcart[0*nbra] - coeff_c2s[3]*gcart[2*nbra+1] + coeff_c2s[6]*gcart[6*nbra] - coeff_c2s[13]*gcart[12*nbra+1] + coeff_c2s[24]*gcart[24*nbra] - coeff_c2s[29]*gcart[28*nbra+1] + coeff_c2s[34]*gcart[34*nbra];
        gsp[0*dgsp*OF_CMPLX+1] = coeff_c2s[0]*gcart[0*nbra+1] + coeff_c2s[3]*gcart[2*nbra] + coeff_c2s[6]*gcart[6*nbra+1] + coeff_c2s[13]*gcart[12*nbra] + coeff_c2s[24]*gcart[24*nbra+1] + coeff_c2s[29]*gcart[28*nbra] + coeff_c2s[34]*gcart[34*nbra+1];
        gsp[1*dgsp*OF_CMPLX+0] = coeff_c2s[44]*gcart[4*nbra] - coeff_c2s[49]*gcart[8*nbra+1] + coeff_c2s[54]*gcart[14*nbra] + coeff_c2s[60]*gcart[20*nbra] - coeff_c2s[63]*gcart[22*nbra+1] + coeff_c2s[66]*gcart[26*nbra] + coeff_c2s[70]*gcart[30*nbra] - coeff_c2s[73]*gcart[32*nbra+1] - coeff_c2s[77]*gcart[36*nbra+1];
        gsp[1*dgsp*OF_CMPLX+1] = coeff_c2s[44]*gcart[4*nbra+1] + coeff_c2s[49]*gcart[8*nbra] + coeff_c2s[54]*gcart[14*nbra+1] + coeff_c2s[60]*gcart[20*nbra+1] + coeff_c2s[63]*gcart[22*nbra] + coeff_c2s[66]*gcart[26*nbra+1] + coeff_c2s[70]*gcart[30*nbra+1] + coeff_c2s[73]*gcart[32*nbra] + coeff_c2s[77]*gcart[36*nbra];
        gsp[2*dgsp*OF_CMPLX+0] = coeff_c2s[80]*gcart[0*nbra] - coeff_c2s[83]*gcart[2*nbra+1] + coeff_c2s[86]*gcart[6*nbra] + coeff_c2s[90]*gcart[10*nbra] - coeff_c2s[93]*gcart[12*nbra+1] - coeff_c2s[97]*gcart[16*nbra+1] + coeff_c2s[104]*gcart[24*nbra] + coeff_c2s[114]*gcart[34*nbra] + coeff_c2s[118]*gcart[38*nbra];
        gsp[2*dgsp*OF_CMPLX+1] = coeff_c2s[80]*gcart[0*nbra+1] + coeff_c2s[83]*gcart[2*nbra] + coeff_c2s[86]*gcart[6*nbra+1] + coeff_c2s[90]*gcart[10*nbra+1] + coeff_c2s[93]*gcart[12*nbra] + coeff_c2s[97]*gcart[16*nbra] + coeff_c2s[104]*gcart[24*nbra+1] + coeff_c2s[114]*gcart[34*nbra+1] + coeff_c2s[118]*gcart[38*nbra+1];
        gsp[3*dgsp*OF_CMPLX+0] = coeff_c2s[124]*gcart[4*nbra] + coeff_c2s[134]*gcart[14*nbra] + coeff_c2s[138]*gcart[18*nbra] + coeff_c2s[140]*gcart[20*nbra] - coeff_c2s[143]*gcart[22*nbra+1] + coeff_c2s[146]*gcart[26*nbra] + coeff_c2s[150]*gcart[30*nbra] - coeff_c2s[153]*gcart[32*nbra+1] - coeff_c2s[157]*gcart[36*nbra+1];
        gsp[3*dgsp*OF_CMPLX+1] = coeff_c2s[124]*gcart[4*nbra+1] + coeff_c2s[134]*gcart[14*nbra+1] + coeff_c2s[138]*gcart[18*nbra+1] + coeff_c2s[140]*gcart[20*nbra+1] + coeff_c2s[143]*gcart[22*nbra] + coeff_c2s[146]*gcart[26*nbra+1] + coeff_c2s[150]*gcart[30*nbra+1] + coeff_c2s[153]*gcart[32*nbra] + coeff_c2s[157]*gcart[36*nbra];
        gsp[4*dgsp*OF_CMPLX+0] = coeff_c2s[160]*gcart[0*nbra] - coeff_c2s[163]*gcart[2*nbra+1] + coeff_c2s[166]*gcart[6*nbra] + coeff_c2s[170]*gcart[10*nbra] - coeff_c2s[173]*gcart[12*nbra+1] - coeff_c2s[177]*gcart[16*nbra+1] + coeff_c2s[184]*gcart[24*nbra] - coeff_c2s[189]*gcart[28*nbra+1] + coeff_c2s[194]*gcart[34*nbra];
        gsp[4*dgsp*OF_CMPLX+1] = coeff_c2s[160]*gcart[0*nbra+1] + coeff_c2s[163]*gcart[2*nbra] + coeff_c2s[166]*gcart[6*nbra+1] + coeff_c2s[170]*gcart[10*nbra+1] + coeff_c2s[173]*gcart[12*nbra] + coeff_c2s[177]*gcart[16*nbra] + coeff_c2s[184]*gcart[24*nbra+1] + coeff_c2s[189]*gcart[28*nbra] + coeff_c2s[194]*gcart[34*nbra+1];
        gsp[5*dgsp*OF_CMPLX+0] = coeff_c2s[204]*gcart[4*nbra] - coeff_c2s[209]*gcart[8*nbra+1] + coeff_c2s[214]*gcart[14*nbra] + coeff_c2s[220]*gcart[20*nbra] - coeff_c2s[223]*gcart[22*nbra+1] + coeff_c2s[226]*gcart[26*nbra] - coeff_c2s[233]*gcart[32*nbra+1];
        gsp[5*dgsp*OF_CMPLX+1] = coeff_c2s[204]*gcart[4*nbra+1] + coeff_c2s[209]*gcart[8*nbra] + coeff_c2s[214]*gcart[14*nbra+1] + coeff_c2s[220]*gcart[20*nbra+1] + coeff_c2s[223]*gcart[22*nbra] + coeff_c2s[226]*gcart[26*nbra+1] + coeff_c2s[233]*gcart[32*nbra];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + dgsp*OF_CMPLX*6;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[3].cart2j_gt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] = coeff_c2s[20]*gcart[20*nbra] - coeff_c2s[23]*gcart[22*nbra+1] + coeff_c2s[26]*gcart[26*nbra] - coeff_c2s[33]*gcart[32*nbra+1];
        gsp[0*dgsp*OF_CMPLX+1] = coeff_c2s[20]*gcart[20*nbra+1] + coeff_c2s[23]*gcart[22*nbra] + coeff_c2s[26]*gcart[26*nbra+1] + coeff_c2s[33]*gcart[32*nbra];
        gsp[1*dgsp*OF_CMPLX+0] = coeff_c2s[40]*gcart[0*nbra] - coeff_c2s[43]*gcart[2*nbra+1] + coeff_c2s[46]*gcart[6*nbra] - coeff_c2s[53]*gcart[12*nbra+1] + coeff_c2s[64]*gcart[24*nbra] - coeff_c2s[69]*gcart[28*nbra+1] + coeff_c2s[74]*gcart[34*nbra];
        gsp[1*dgsp*OF_CMPLX+1] = coeff_c2s[40]*gcart[0*nbra+1] + coeff_c2s[43]*gcart[2*nbra] + coeff_c2s[46]*gcart[6*nbra+1] + coeff_c2s[53]*gcart[12*nbra] + coeff_c2s[64]*gcart[24*nbra+1] + coeff_c2s[69]*gcart[28*nbra] + coeff_c2s[74]*gcart[34*nbra+1];
        gsp[2*dgsp*OF_CMPLX+0] = coeff_c2s[84]*gcart[4*nbra] - coeff_c2s[89]*gcart[8*nbra+1] + coeff_c2s[94]*gcart[14*nbra] + coeff_c2s[100]*gcart[20*nbra] - coeff_c2s[103]*gcart[22*nbra+1] + coeff_c2s[106]*gcart[26*nbra] + coeff_c2s[110]*gcart[30*nbra] - coeff_c2s[113]*gcart[32*nbra+1] - coeff_c2s[117]*gcart[36*nbra+1];
        gsp[2*dgsp*OF_CMPLX+1] = coeff_c2s[84]*gcart[4*nbra+1] + coeff_c2s[89]*gcart[8*nbra] + coeff_c2s[94]*gcart[14*nbra+1] + coeff_c2s[100]*gcart[20*nbra+1] + coeff_c2s[103]*gcart[22*nbra] + coeff_c2s[106]*gcart[26*nbra+1] + coeff_c2s[110]*gcart[30*nbra+1] + coeff_c2s[113]*gcart[32*nbra] + coeff_c2s[117]*gcart[36*nbra];
        gsp[3*dgsp*OF_CMPLX+0] = coeff_c2s[120]*gcart[0*nbra] - coeff_c2s[123]*gcart[2*nbra+1] + coeff_c2s[126]*gcart[6*nbra] + coeff_c2s[130]*gcart[10*nbra] - coeff_c2s[133]*gcart[12*nbra+1] - coeff_c2s[137]*gcart[16*nbra+1] + coeff_c2s[144]*gcart[24*nbra] + coeff_c2s[154]*gcart[34*nbra] + coeff_c2s[158]*gcart[38*nbra];
        gsp[3*dgsp*OF_CMPLX+1] = coeff_c2s[120]*gcart[0*nbra+1] + coeff_c2s[123]*gcart[2*nbra] + coeff_c2s[126]*gcart[6*nbra+1] + coeff_c2s[130]*gcart[10*nbra+1] + coeff_c2s[133]*gcart[12*nbra] + coeff_c2s[137]*gcart[16*nbra] + coeff_c2s[144]*gcart[24*nbra+1] + coeff_c2s[154]*gcart[34*nbra+1] + coeff_c2s[158]*gcart[38*nbra+1];
        gsp[4*dgsp*OF_CMPLX+0] = coeff_c2s[164]*gcart[4*nbra] + coeff_c2s[174]*gcart[14*nbra] + coeff_c2s[178]*gcart[18*nbra] + coeff_c2s[180]*gcart[20*nbra] - coeff_c2s[183]*gcart[22*nbra+1] + coeff_c2s[186]*gcart[26*nbra] + coeff_c2s[190]*gcart[30*nbra] - coeff_c2s[193]*gcart[32*nbra+1] - coeff_c2s[197]*gcart[36*nbra+1];
        gsp[4*dgsp*OF_CMPLX+1] = coeff_c2s[164]*gcart[4*nbra+1] + coeff_c2s[174]*gcart[14*nbra+1] + coeff_c2s[178]*gcart[18*nbra+1] + coeff_c2s[180]*gcart[20*nbra+1] + coeff_c2s[183]*gcart[22*nbra] + coeff_c2s[186]*gcart[26*nbra+1] + coeff_c2s[190]*gcart[30*nbra+1] + coeff_c2s[193]*gcart[32*nbra] + coeff_c2s[197]*gcart[36*nbra];
        gsp[5*dgsp*OF_CMPLX+0] = coeff_c2s[200]*gcart[0*nbra] - coeff_c2s[203]*gcart[2*nbra+1] + coeff_c2s[206]*gcart[6*nbra] + coeff_c2s[210]*gcart[10*nbra] - coeff_c2s[213]*gcart[12*nbra+1] - coeff_c2s[217]*gcart[16*nbra+1] + coeff_c2s[224]*gcart[24*nbra] - coeff_c2s[229]*gcart[28*nbra+1] + coeff_c2s[234]*gcart[34*nbra];
        gsp[5*dgsp*OF_CMPLX+1] = coeff_c2s[200]*gcart[0*nbra+1] + coeff_c2s[203]*gcart[2*nbra] + coeff_c2s[206]*gcart[6*nbra+1] + coeff_c2s[210]*gcart[10*nbra+1] + coeff_c2s[213]*gcart[12*nbra] + coeff_c2s[217]*gcart[16*nbra] + coeff_c2s[224]*gcart[24*nbra+1] + coeff_c2s[229]*gcart[28*nbra] + coeff_c2s[234]*gcart[34*nbra+1];
        gsp[6*dgsp*OF_CMPLX+0] = coeff_c2s[244]*gcart[4*nbra] - coeff_c2s[249]*gcart[8*nbra+1] + coeff_c2s[254]*gcart[14*nbra] + coeff_c2s[260]*gcart[20*nbra] - coeff_c2s[263]*gcart[22*nbra+1] + coeff_c2s[266]*gcart[26*nbra] - coeff_c2s[273]*gcart[32*nbra+1];
        gsp[6*dgsp*OF_CMPLX+1] = coeff_c2s[244]*gcart[4*nbra+1] + coeff_c2s[249]*gcart[8*nbra] + coeff_c2s[254]*gcart[14*nbra+1] + coeff_c2s[260]*gcart[20*nbra+1] + coeff_c2s[263]*gcart[22*nbra] + coeff_c2s[266]*gcart[26*nbra+1] + coeff_c2s[273]*gcart[32*nbra];
        gsp[7*dgsp*OF_CMPLX+0] = coeff_c2s[280]*gcart[0*nbra] - coeff_c2s[283]*gcart[2*nbra+1] + coeff_c2s[286]*gcart[6*nbra] - coeff_c2s[293]*gcart[12*nbra+1];
        gsp[7*dgsp*OF_CMPLX+1] = coeff_c2s[280]*gcart[0*nbra+1] + coeff_c2s[283]*gcart[2*nbra] + coeff_c2s[286]*gcart[6*nbra+1] + coeff_c2s[293]*gcart[12*nbra];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
        }
}
static void f_iket_cart2spinor(double *gsp, unsigned int dgsp, unsigned int nbra,
                               double *gcart, unsigned int bas_id, int bas[])
{
        const int kappa = bas(KAPPA_OF, bas_id);
        const double *coeff_c2s;
        double *gsp0 = gsp;
        double *gcart0 = gcart;
        unsigned int i;

        if (kappa >= 0) {
                coeff_c2s = g_c2s[3].cart2j_lt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] =-(coeff_c2s[0]*gcart[0*nbra+1] + coeff_c2s[3]*gcart[2*nbra] + coeff_c2s[6]*gcart[6*nbra+1] + coeff_c2s[13]*gcart[12*nbra] + coeff_c2s[24]*gcart[24*nbra+1] + coeff_c2s[29]*gcart[28*nbra] + coeff_c2s[34]*gcart[34*nbra+1]);
        gsp[0*dgsp*OF_CMPLX+1] =  coeff_c2s[0]*gcart[0*nbra] - coeff_c2s[3]*gcart[2*nbra+1] + coeff_c2s[6]*gcart[6*nbra] - coeff_c2s[13]*gcart[12*nbra+1] + coeff_c2s[24]*gcart[24*nbra] - coeff_c2s[29]*gcart[28*nbra+1] + coeff_c2s[34]*gcart[34*nbra];
        gsp[1*dgsp*OF_CMPLX+0] =-(coeff_c2s[44]*gcart[4*nbra+1] + coeff_c2s[49]*gcart[8*nbra] + coeff_c2s[54]*gcart[14*nbra+1] + coeff_c2s[60]*gcart[20*nbra+1] + coeff_c2s[63]*gcart[22*nbra] + coeff_c2s[66]*gcart[26*nbra+1] + coeff_c2s[70]*gcart[30*nbra+1] + coeff_c2s[73]*gcart[32*nbra] + coeff_c2s[77]*gcart[36*nbra]);
        gsp[1*dgsp*OF_CMPLX+1] =  coeff_c2s[44]*gcart[4*nbra] - coeff_c2s[49]*gcart[8*nbra+1] + coeff_c2s[54]*gcart[14*nbra] + coeff_c2s[60]*gcart[20*nbra] - coeff_c2s[63]*gcart[22*nbra+1] + coeff_c2s[66]*gcart[26*nbra] + coeff_c2s[70]*gcart[30*nbra] - coeff_c2s[73]*gcart[32*nbra+1] - coeff_c2s[77]*gcart[36*nbra+1];
        gsp[2*dgsp*OF_CMPLX+0] =-(coeff_c2s[80]*gcart[0*nbra+1] + coeff_c2s[83]*gcart[2*nbra] + coeff_c2s[86]*gcart[6*nbra+1] + coeff_c2s[90]*gcart[10*nbra+1] + coeff_c2s[93]*gcart[12*nbra] + coeff_c2s[97]*gcart[16*nbra] + coeff_c2s[104]*gcart[24*nbra+1] + coeff_c2s[114]*gcart[34*nbra+1] + coeff_c2s[118]*gcart[38*nbra+1]);
        gsp[2*dgsp*OF_CMPLX+1] =  coeff_c2s[80]*gcart[0*nbra] - coeff_c2s[83]*gcart[2*nbra+1] + coeff_c2s[86]*gcart[6*nbra] + coeff_c2s[90]*gcart[10*nbra] - coeff_c2s[93]*gcart[12*nbra+1] - coeff_c2s[97]*gcart[16*nbra+1] + coeff_c2s[104]*gcart[24*nbra] + coeff_c2s[114]*gcart[34*nbra] + coeff_c2s[118]*gcart[38*nbra];
        gsp[3*dgsp*OF_CMPLX+0] =-(coeff_c2s[124]*gcart[4*nbra+1] + coeff_c2s[134]*gcart[14*nbra+1] + coeff_c2s[138]*gcart[18*nbra+1] + coeff_c2s[140]*gcart[20*nbra+1] + coeff_c2s[143]*gcart[22*nbra] + coeff_c2s[146]*gcart[26*nbra+1] + coeff_c2s[150]*gcart[30*nbra+1] + coeff_c2s[153]*gcart[32*nbra] + coeff_c2s[157]*gcart[36*nbra]);
        gsp[3*dgsp*OF_CMPLX+1] =  coeff_c2s[124]*gcart[4*nbra] + coeff_c2s[134]*gcart[14*nbra] + coeff_c2s[138]*gcart[18*nbra] + coeff_c2s[140]*gcart[20*nbra] - coeff_c2s[143]*gcart[22*nbra+1] + coeff_c2s[146]*gcart[26*nbra] + coeff_c2s[150]*gcart[30*nbra] - coeff_c2s[153]*gcart[32*nbra+1] - coeff_c2s[157]*gcart[36*nbra+1];
        gsp[4*dgsp*OF_CMPLX+0] =-(coeff_c2s[160]*gcart[0*nbra+1] + coeff_c2s[163]*gcart[2*nbra] + coeff_c2s[166]*gcart[6*nbra+1] + coeff_c2s[170]*gcart[10*nbra+1] + coeff_c2s[173]*gcart[12*nbra] + coeff_c2s[177]*gcart[16*nbra] + coeff_c2s[184]*gcart[24*nbra+1] + coeff_c2s[189]*gcart[28*nbra] + coeff_c2s[194]*gcart[34*nbra+1]);
        gsp[4*dgsp*OF_CMPLX+1] =  coeff_c2s[160]*gcart[0*nbra] - coeff_c2s[163]*gcart[2*nbra+1] + coeff_c2s[166]*gcart[6*nbra] + coeff_c2s[170]*gcart[10*nbra] - coeff_c2s[173]*gcart[12*nbra+1] - coeff_c2s[177]*gcart[16*nbra+1] + coeff_c2s[184]*gcart[24*nbra] - coeff_c2s[189]*gcart[28*nbra+1] + coeff_c2s[194]*gcart[34*nbra];
        gsp[5*dgsp*OF_CMPLX+0] =-(coeff_c2s[204]*gcart[4*nbra+1] + coeff_c2s[209]*gcart[8*nbra] + coeff_c2s[214]*gcart[14*nbra+1] + coeff_c2s[220]*gcart[20*nbra+1] + coeff_c2s[223]*gcart[22*nbra] + coeff_c2s[226]*gcart[26*nbra+1] + coeff_c2s[233]*gcart[32*nbra]);
        gsp[5*dgsp*OF_CMPLX+1] =  coeff_c2s[204]*gcart[4*nbra] - coeff_c2s[209]*gcart[8*nbra+1] + coeff_c2s[214]*gcart[14*nbra] + coeff_c2s[220]*gcart[20*nbra] - coeff_c2s[223]*gcart[22*nbra+1] + coeff_c2s[226]*gcart[26*nbra] - coeff_c2s[233]*gcart[32*nbra+1];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
                gcart = gcart0;
                gsp = gsp0 + dgsp*OF_CMPLX*6;
        }
        if (kappa <= 0) {
                coeff_c2s = g_c2s[3].cart2j_gt_l;
                for (i = 0; i < nbra; i++) {
        gsp[0*dgsp*OF_CMPLX+0] =-(coeff_c2s[20]*gcart[20*nbra+1] + coeff_c2s[23]*gcart[22*nbra] + coeff_c2s[26]*gcart[26*nbra+1] + coeff_c2s[33]*gcart[32*nbra]);
        gsp[0*dgsp*OF_CMPLX+1] =  coeff_c2s[20]*gcart[20*nbra] - coeff_c2s[23]*gcart[22*nbra+1] + coeff_c2s[26]*gcart[26*nbra] - coeff_c2s[33]*gcart[32*nbra+1];
        gsp[1*dgsp*OF_CMPLX+0] =-(coeff_c2s[40]*gcart[0*nbra+1] + coeff_c2s[43]*gcart[2*nbra] + coeff_c2s[46]*gcart[6*nbra+1] + coeff_c2s[53]*gcart[12*nbra] + coeff_c2s[64]*gcart[24*nbra+1] + coeff_c2s[69]*gcart[28*nbra] + coeff_c2s[74]*gcart[34*nbra+1]);
        gsp[1*dgsp*OF_CMPLX+1] =  coeff_c2s[40]*gcart[0*nbra] - coeff_c2s[43]*gcart[2*nbra+1] + coeff_c2s[46]*gcart[6*nbra] - coeff_c2s[53]*gcart[12*nbra+1] + coeff_c2s[64]*gcart[24*nbra] - coeff_c2s[69]*gcart[28*nbra+1] + coeff_c2s[74]*gcart[34*nbra];
        gsp[2*dgsp*OF_CMPLX+0] =-(coeff_c2s[84]*gcart[4*nbra+1] + coeff_c2s[89]*gcart[8*nbra] + coeff_c2s[94]*gcart[14*nbra+1] + coeff_c2s[100]*gcart[20*nbra+1] + coeff_c2s[103]*gcart[22*nbra] + coeff_c2s[106]*gcart[26*nbra+1] + coeff_c2s[110]*gcart[30*nbra+1] + coeff_c2s[113]*gcart[32*nbra] + coeff_c2s[117]*gcart[36*nbra]);
        gsp[2*dgsp*OF_CMPLX+1] =  coeff_c2s[84]*gcart[4*nbra] - coeff_c2s[89]*gcart[8*nbra+1] + coeff_c2s[94]*gcart[14*nbra] + coeff_c2s[100]*gcart[20*nbra] - coeff_c2s[103]*gcart[22*nbra+1] + coeff_c2s[106]*gcart[26*nbra] + coeff_c2s[110]*gcart[30*nbra] - coeff_c2s[113]*gcart[32*nbra+1] - coeff_c2s[117]*gcart[36*nbra+1];
        gsp[3*dgsp*OF_CMPLX+0] =-(coeff_c2s[120]*gcart[0*nbra+1] + coeff_c2s[123]*gcart[2*nbra] + coeff_c2s[126]*gcart[6*nbra+1] + coeff_c2s[130]*gcart[10*nbra+1] + coeff_c2s[133]*gcart[12*nbra] + coeff_c2s[137]*gcart[16*nbra] + coeff_c2s[144]*gcart[24*nbra+1] + coeff_c2s[154]*gcart[34*nbra+1] + coeff_c2s[158]*gcart[38*nbra+1]);
        gsp[3*dgsp*OF_CMPLX+1] =  coeff_c2s[120]*gcart[0*nbra] - coeff_c2s[123]*gcart[2*nbra+1] + coeff_c2s[126]*gcart[6*nbra] + coeff_c2s[130]*gcart[10*nbra] - coeff_c2s[133]*gcart[12*nbra+1] - coeff_c2s[137]*gcart[16*nbra+1] + coeff_c2s[144]*gcart[24*nbra] + coeff_c2s[154]*gcart[34*nbra] + coeff_c2s[158]*gcart[38*nbra];
        gsp[4*dgsp*OF_CMPLX+0] =-(coeff_c2s[164]*gcart[4*nbra+1] + coeff_c2s[174]*gcart[14*nbra+1] + coeff_c2s[178]*gcart[18*nbra+1] + coeff_c2s[180]*gcart[20*nbra+1] + coeff_c2s[183]*gcart[22*nbra] + coeff_c2s[186]*gcart[26*nbra+1] + coeff_c2s[190]*gcart[30*nbra+1] + coeff_c2s[193]*gcart[32*nbra] + coeff_c2s[197]*gcart[36*nbra]);
        gsp[4*dgsp*OF_CMPLX+1] =  coeff_c2s[164]*gcart[4*nbra] + coeff_c2s[174]*gcart[14*nbra] + coeff_c2s[178]*gcart[18*nbra] + coeff_c2s[180]*gcart[20*nbra] - coeff_c2s[183]*gcart[22*nbra+1] + coeff_c2s[186]*gcart[26*nbra] + coeff_c2s[190]*gcart[30*nbra] - coeff_c2s[193]*gcart[32*nbra+1] - coeff_c2s[197]*gcart[36*nbra+1];
        gsp[5*dgsp*OF_CMPLX+0] =-(coeff_c2s[200]*gcart[0*nbra+1] + coeff_c2s[203]*gcart[2*nbra] + coeff_c2s[206]*gcart[6*nbra+1] + coeff_c2s[210]*gcart[10*nbra+1] + coeff_c2s[213]*gcart[12*nbra] + coeff_c2s[217]*gcart[16*nbra] + coeff_c2s[224]*gcart[24*nbra+1] + coeff_c2s[229]*gcart[28*nbra] + coeff_c2s[234]*gcart[34*nbra+1]);
        gsp[5*dgsp*OF_CMPLX+1] =  coeff_c2s[200]*gcart[0*nbra] - coeff_c2s[203]*gcart[2*nbra+1] + coeff_c2s[206]*gcart[6*nbra] + coeff_c2s[210]*gcart[10*nbra] - coeff_c2s[213]*gcart[12*nbra+1] - coeff_c2s[217]*gcart[16*nbra+1] + coeff_c2s[224]*gcart[24*nbra] - coeff_c2s[229]*gcart[28*nbra+1] + coeff_c2s[234]*gcart[34*nbra];
        gsp[6*dgsp*OF_CMPLX+0] =-(coeff_c2s[244]*gcart[4*nbra+1] + coeff_c2s[249]*gcart[8*nbra] + coeff_c2s[254]*gcart[14*nbra+1] + coeff_c2s[260]*gcart[20*nbra+1] + coeff_c2s[263]*gcart[22*nbra] + coeff_c2s[266]*gcart[26*nbra+1] + coeff_c2s[273]*gcart[32*nbra]);
        gsp[6*dgsp*OF_CMPLX+1] =  coeff_c2s[244]*gcart[4*nbra] - coeff_c2s[249]*gcart[8*nbra+1] + coeff_c2s[254]*gcart[14*nbra] + coeff_c2s[260]*gcart[20*nbra] - coeff_c2s[263]*gcart[22*nbra+1] + coeff_c2s[266]*gcart[26*nbra] - coeff_c2s[273]*gcart[32*nbra+1];
        gsp[7*dgsp*OF_CMPLX+0] =-(coeff_c2s[280]*gcart[0*nbra+1] + coeff_c2s[283]*gcart[2*nbra] + coeff_c2s[286]*gcart[6*nbra+1] + coeff_c2s[293]*gcart[12*nbra]);
        gsp[7*dgsp*OF_CMPLX+1] =  coeff_c2s[280]*gcart[0*nbra] - coeff_c2s[283]*gcart[2*nbra+1] + coeff_c2s[286]*gcart[6*nbra] - coeff_c2s[293]*gcart[12*nbra+1];
        gsp += OF_CMPLX;
        gcart += OF_CMPLX;
                }
        }
}


static void (*f_bra_spinor_e1sf[6])() = {
        s_bra_cart2spinor_e1sf,
        p_bra_cart2spinor_e1sf,
        d_bra_cart2spinor_e1sf,
        f_bra_cart2spinor_e1sf,
        a_bra_cart2spinor_e1sf,
        a_bra_cart2spinor_e1sf,
};

static void (*f_bra_spinor_sf[6])() = {
        s_bra_cart2spinor_sf,
        p_bra_cart2spinor_sf,
        d_bra_cart2spinor_sf,
        f_bra_cart2spinor_sf,
        a_bra_cart2spinor_sf,
        a_bra_cart2spinor_sf,
};

static void (*f_ket_spinor[6])() = {
        s_ket_cart2spinor,
        p_ket_cart2spinor,
        d_ket_cart2spinor,
        f_ket_cart2spinor,
        a_ket_cart2spinor,
        a_ket_cart2spinor,
};

static void (*f_iket_spinor[6])() = {
        s_iket_cart2spinor,
        p_iket_cart2spinor,
        d_iket_cart2spinor,
        f_iket_cart2spinor,
        a_iket_cart2spinor,
        a_iket_cart2spinor,
};

static void (*f_bra_spinor_si[6])() = {
        s_bra_cart2spinor_si,
        p_bra_cart2spinor_si,
        d_bra_cart2spinor_si,
        f_bra_cart2spinor_si,
        a_bra_cart2spinor_si,
        a_bra_cart2spinor_si,
};

/*************************************************
 *
 * transform matrices
 *
 *************************************************/

#define C2S(KEY) \
void c2s_##KEY(double *opij, const double *gctr, \
               const unsigned int *shls, const int *bas) \
{ \
        const double Z1[] = {1, 0}; \
        KEY(opij, gctr, Z1, shls, bas); \
}

/* c2s transformation * #C(0 1) */
#define C2Si(KEY) \
void c2s_##KEY##i(double *opij, const double *gctr, \
                  const unsigned int *shls, const int *bas) \
{ \
        const double ZI[] = {0, 1}; \
        KEY(opij, gctr, ZI, shls, bas); \
}
/*
 * (i,k,l,j) -> (k,i,j,l)
 */
static void dswap_ik_jl(double *new, const double *old,
                        const unsigned int ni, const unsigned int nj,
                        const unsigned int nk, const unsigned int nl)
{
        unsigned int j, l;
        unsigned int dlo = ni * nk; // shift of (i,k,l++,j)
        unsigned int djo = ni * nk * nl; // shift of (i,k,l,j++)
        unsigned int djn = nk * ni; // shift of (k,i,j++,l)
        unsigned int dln = nk * ni * nj; // shift of (k,i,j,l++)

        for (l = 0; l < nl; l++)
                for (j = 0; j < nj; j++) {
                        dmat_transpose(new + l * dln + j * djn,
                                       old + l * dlo + j * djo, ni, nk);
                }
}

/*
 * (i,k,l,j) -> (k,i,j,l)
 */
static void zswap_ik_jl(double *new, const double *old,
                        const unsigned int ni, const unsigned int nj,
                        const unsigned int nk, const unsigned int nl)
{
        unsigned int j, l;
        unsigned int dlo = ni * nk * OF_CMPLX; // shift of (i,k,l++,j)
        unsigned int djo = ni * nk * nl * OF_CMPLX; // shift of (i,k,l,j++)
        unsigned int djn = nk * ni * OF_CMPLX; // shift of (k,i,j++,l)
        unsigned int dln = nk * ni * nj * OF_CMPLX; // shift of (k,i,j,l++)

        for (l = 0; l < nl; l++)
                for (j = 0; j < nj; j++) {
                        zmat_transpose(new + l * dln + j * djn,
                                       old + l * dlo + j * djo, ni, nk);
                }
}


static void dcopy_ij(double *opij, const double *gctr, 
                     const unsigned int ni, const unsigned int nj,
                     const unsigned int mi, const unsigned int mj)
{
        unsigned int i, j, n;

        n = 0;
        for (j = 0; j < mj; j++) {
                for (i = 0; i < mi; i++) {
                        opij[i] = gctr[n];
                        n++;
                }
                opij += ni;
        }
}

/*
 * fijkl(ic:ic-1+di,jc:jc-1+dj,kc:kc-1+dk,lc:lc-1+dl)
 * fijkl(ni,nj,nk,nl), gctr(mk,mi,mj,ml)
 * gctr(k,i,j,l) -> fijkl(i,j,k,l)
 */
static void dcopy_kijl(double *fijkl, const double *gctr, 
                       const unsigned int ni, const unsigned int nj,
                       const unsigned int nk, const unsigned int nl,
                       const unsigned int mi, const unsigned int mj,
                       const unsigned int mk, const unsigned int ml)
{
        unsigned int i, j, k, l;
        double *pl, *pk, *pj;
        const double *pgctr;

        for (l = 0; l < ml; l++) {
                pl = fijkl + l * nk * ni * nj;
                for (k = 0; k < mk; k++) {
                        pk = pl + k * ni * nj;
                        pgctr = gctr + l * mk * mi * mj + k;
                        for (j = 0; j < mj; j++) {
                                pj = pk + j * ni;
                                for (i = 0; i < mi; i++) {
                                        pj[i] = *pgctr;
                                        pgctr += mk;
                                }
                        }
                }
        }
}

static void zcopy_kijl(double *fijkl, const double *gctr,
                       const unsigned int ni, const unsigned int nj,
                       const unsigned int nk, const unsigned int nl,
                       const unsigned int mi, const unsigned int mj,
                       const unsigned int mk, const unsigned int ml)
{
        unsigned int i, j, k, l;
        double *pl, *pk, *pj;
        const double *pgctr;

        for (l = 0; l < ml; l++) {
                pl = fijkl + l * nk * ni * nj * OF_CMPLX;
                for (k = 0; k < mk; k++) {
                        pk = pl + k * ni * nj * OF_CMPLX;
                        pgctr = gctr + (l * mk * mi * mj + k) * OF_CMPLX;
                        for (j = 0; j < mj; j++) {
                                pj = pk + j * ni * OF_CMPLX;
                                for (i = 0; i < mi * OF_CMPLX; i += OF_CMPLX) {
                                        pj[i+0] = pgctr[0];
                                        pj[i+1] = pgctr[1];
                                        pgctr += mk * OF_CMPLX;
                                }
                        }
                }
        }
}

/*
 * gctr(i,k,l,j) -> fijkl(i,j,k,l)
 */
static void dcopy_iklj(double *fijkl, const double *gctr, 
                       const unsigned int ni, const unsigned int nj,
                       const unsigned int nk, const unsigned int nl,
                       const unsigned int mi, const unsigned int mj,
                       const unsigned int mk, const unsigned int ml)
{
        unsigned int i, j, k, l;
        double *pl, *pk, *pj;
        const double *pgctr;

        for (l = 0; l < ml; l++) {
                pl = fijkl + l * nk * ni * nj;
                for (k = 0; k < mk; k++) {
                        pk = pl + k * ni * nj;
                        pgctr = gctr + l * mi * mk + k * mi;
                        for (j = 0; j < mj; j++) {
                                pj = pk + j * ni;
                                for (i = 0; i < mi; i++) {
                                        pj[i] = pgctr[i];
                                }
                                pgctr += mi * mk * ml;
                        }
                }
        }
}


/*
 * 1e integrals, cartesian to real spheric.
 */
void c2s_sph_1e(double *opij, const double *gctr,
                const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int di = i_l * 2 + 1;
        const unsigned int dj = j_l * 2 + 1;
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nf = nfi * nfj;
        unsigned int ic, jc;
        double *const tmp1 = (double *)malloc(sizeof(double) * di*nfj);

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        (f_bra_sph[i_l])(tmp1, di, nfj, gctr, i_sh, bas);
                        (f_ket_sph[j_l])(opij+ni*jc+ic, ni, di, tmp1, j_sh, bas);
                        gctr += nf;
                }
        free(tmp1);
}


/*
 * 1e integrals, cartesian to spin free spinor.
 */
void c2s_sf_1e(double *opij, const double *gctr,
               const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfj;
        unsigned int ic, jc;
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nf2j * OF_CMPLX);

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        (f_bra_spinor_e1sf[i_l])(tmp2, di, nfj, gctr, i_sh, bas);
                        (f_ket_spinor[j_l])(opij+(ni*jc+ic)*OF_CMPLX,
                                            ni, di, tmp2, j_sh, bas);
                        gctr += nf;
                }

        free(tmp2);
}
void c2s_sf_1ei(double *opij, const double *gctr,
                const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfj;
        unsigned int ic, jc;
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nf2j * OF_CMPLX);

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        (f_bra_spinor_e1sf[i_l])(tmp2, di, nfj, gctr, i_sh, bas);
                        (f_iket_spinor[j_l])(opij+(ni*jc+ic)*OF_CMPLX,
                                             ni, di, tmp2, j_sh, bas);
                        gctr += nf;
                }

        free(tmp2);
}


/*
 * 1e integrals, cartesian to spinor.
 */
void c2s_si_1e(double *opij, const double *gctr,
               const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nf2i = nfi + nfi;
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfj;
        unsigned int ic, jc;
        const double *gc_x = gctr;
        const double *gc_y = gc_x + nf * i_ctr * j_ctr;
        const double *gc_z = gc_y + nf * i_ctr * j_ctr;
        const double *gc_1 = gc_z + nf * i_ctr * j_ctr;
        double *const tmp1 = (double *)malloc(sizeof(double)*nf2i*nf2j*OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double)*di*nf2j*OF_CMPLX);

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        //cmplx( gctr.POS_1, gctr.POS_Z)
                        //cmplx( gctr.POS_Y, gctr.POS_X)
                        dcmplx_pp(nf, tmp1, gc_1, gc_z);
                        dcmplx_pp(nf, tmp1+nf*OF_CMPLX, gc_y, gc_x);
                        //cmplx(-gctr.POS_Y, gctr.POS_X)
                        //cmplx( gctr.POS_1,-gctr.POS_Z)
                        dcmplx_np(nf, tmp1+nfi*nf2j*OF_CMPLX, gc_y, gc_x);
                        dcmplx_pn(nf, tmp1+nfi*nf2j*OF_CMPLX+nf*OF_CMPLX, gc_1, gc_z);
                        (f_bra_spinor_si[i_l])(tmp2, di, nf2j, tmp1, i_sh, bas);
                        (f_ket_spinor[j_l])(opij+(ni*jc+ic)*OF_CMPLX,
                                            ni, di, tmp2, j_sh, bas);

                        gc_x += nf;
                        gc_y += nf;
                        gc_z += nf;
                        gc_1 += nf;
                }
        free(tmp1);
        free(tmp2);
}
void c2s_si_1ei(double *opij, const double *gctr,
                const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nf2i = nfi + nfi;
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfj;
        unsigned int ic, jc;
        const double *gc_x = gctr;
        const double *gc_y = gc_x + nf * i_ctr * j_ctr;
        const double *gc_z = gc_y + nf * i_ctr * j_ctr;
        const double *gc_1 = gc_z + nf * i_ctr * j_ctr;
        double *const tmp1 = (double *)malloc(sizeof(double)*nf2i*nf2j*OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double)*di*nf2j*OF_CMPLX);

        for (jc = 0; jc < nj; jc += dj)
                for (ic = 0; ic < ni; ic += di) {
                        //cmplx( gctr.POS_1, gctr.POS_Z)
                        //cmplx( gctr.POS_Y, gctr.POS_X)
                        dcmplx_pp(nf, tmp1, gc_1, gc_z);
                        dcmplx_pp(nf, tmp1+nf*OF_CMPLX, gc_y, gc_x);
                        //cmplx(-gctr.POS_Y, gctr.POS_X)
                        //cmplx( gctr.POS_1,-gctr.POS_Z)
                        dcmplx_np(nf, tmp1+nfi*nf2j*OF_CMPLX, gc_y, gc_x);
                        dcmplx_pn(nf, tmp1+nfi*nf2j*OF_CMPLX+nf*OF_CMPLX, gc_1, gc_z);
                        (f_bra_spinor_si[i_l])(tmp2, di, nf2j, tmp1, i_sh, bas);
                        (f_iket_spinor[j_l])(opij+(ni*jc+ic)*OF_CMPLX,
                                             ni, di, tmp2, j_sh, bas);

                        gc_x += nf;
                        gc_y += nf;
                        gc_z += nf;
                        gc_1 += nf;
                }
        free(tmp1);
        free(tmp2);
}


/*
 * 2e integrals, cartesian to real spheric.
 *
 * gctr: Cartesian GTO integrals, ordered as <ik|lj>
 */
void c2s_sph_2e1(double *fijkl, const double *gctr,
                 const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = i_l * 2 + 1;
        const unsigned int dj = j_l * 2 + 1;
        const unsigned int dk = k_l * 2 + 1;
        const unsigned int dl = l_l * 2 + 1;
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nk = dk * k_ctr;
        const unsigned int nl = dl * l_ctr;
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf = nfi * nfk * nfl * nfj;
        const unsigned int d_i = di * nfk * nfl;
        const unsigned int d_j = nfk * nfl * nfj;
        const unsigned int d_k = dk * di * dj;
        const unsigned int d_l = di * dj * nfl;
        unsigned int ofj = ni;
        unsigned int ofk = ni * nj;
        unsigned int ofl = nk * ni * nj;
        unsigned int ic, jc, kc, lc;
        double *pfijkl;
        double *const tmp1 = (double *)malloc(sizeof(double) * di*nfk*nfl*nfj);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nfj);

        for (lc = 0; lc < nl; lc += dl) {
                for (kc = 0; kc < nk; kc += dk) {
                        for (jc = 0; jc < nj; jc += dj) {
                                for (ic = 0; ic < ni; ic += di) {

        (f_bra_sph[i_l])(tmp1, di, d_j, gctr, i_sh, bas);
        (f_ket_sph[j_l])(tmp2, d_i, d_i, tmp1, j_sh, bas);
        gctr += nf;

        dswap_ik_jl(tmp1, tmp2, di, dj, nfk, nfl);
        (f_bra_sph[k_l])(tmp2, dk, d_l, tmp1, k_sh, bas);
        (f_ket_sph[l_l])(tmp1, d_k, d_k, tmp2, l_sh, bas);
        pfijkl = fijkl + ofl * lc + ofk * kc + ofj * jc + ic;

        dcopy_kijl(pfijkl, tmp1, ni, nj, nk, nl, di, dj, dk, dl);
                                } } } }

        free(tmp1);
        free(tmp2);
}
void c2s_sph_2e2() {};


/*
 * 2e integrals, cartesian to spin free spinor for electron 1.
 *
 * gctr: Cartesian GTO integrals, ordered as <ik|lj>
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
void c2s_sf_2e1(double *opij, const double *gctr,
                const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfk * nfl * nfj;
        const unsigned int no = di * nfk * nfl * dj;
        const unsigned int d_i = di * nfk * nfl;
        const unsigned int d_j = nfk * nfl * nfj;
        unsigned int i;
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nf2j * OF_CMPLX);

        for (i = 0; i < i_ctr * j_ctr * k_ctr * l_ctr; i++) {
                (f_bra_spinor_e1sf[i_l])(tmp2, di, d_j, gctr, i_sh, bas);
                (f_ket_spinor[j_l])(opij, d_i, d_i, tmp2, j_sh, bas);
                gctr += nf;
                opij += no * OF_CMPLX;
        }

        free(tmp2);
}
void c2s_sf_2e1i(double *opij, const double *gctr,
                 const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfk * nfl * nfj;
        const unsigned int no = di * nfk * nfl * dj;
        const unsigned int d_i = di * nfk * nfl;
        const unsigned int d_j = nfk * nfl * nfj;
        unsigned int i;
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nf2j * OF_CMPLX);

        for (i = 0; i < i_ctr * j_ctr * k_ctr * l_ctr; i++) {
                (f_bra_spinor_e1sf[i_l])(tmp2, di, d_j, gctr, i_sh, bas);
                (f_iket_spinor[j_l])(opij, d_i, d_i, tmp2, j_sh, bas);
                gctr += nf;
                opij += no * OF_CMPLX;
        }

        free(tmp2);
}


/*
 * 2e integrals, cartesian to spin free spinor for electron 2.
 *
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
void c2s_sf_2e2(double *fijkl, const double *opij,
                const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int dk = len_spinor(k_sh, bas);
        const unsigned int dl = len_spinor(l_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nk = dk * k_ctr;
        const unsigned int nl = dl * l_ctr;
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2k = nfk + nfk;
        const unsigned int nf2l = nfl + nfl;
        const unsigned int d_k = dk * di * dj;
        const unsigned int d_l = di * dj * nfl;
        const unsigned int nop = nfk * di * dj * nfl;
        unsigned int ofj = ni;
        unsigned int ofk = ni * nj;
        unsigned int ofl = nk * ni * nj;
        unsigned int ic, jc, kc, lc;
        double *pfijkl;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2k*di*dj*nf2l * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * dk*di*dj*nf2l * OF_CMPLX);

        for (lc = 0; lc < nl; lc += dl) {
                for (kc = 0; kc < nk; kc += dk) {
                        for (jc = 0; jc < nj; jc += dj) {
                                for (ic = 0; ic < ni; ic += di) {
        zswap_ik_jl(tmp1, opij, di, dj, nfk, nfl);
        (f_bra_spinor_sf[k_l])(tmp2, dk, d_l, tmp1, k_sh, bas);
        (f_ket_spinor[l_l])(tmp1, d_k, d_k, tmp2, l_sh, bas);
        pfijkl = fijkl + (ofl * lc + ofk * kc + ofj * jc + ic) * OF_CMPLX;

        zcopy_kijl(pfijkl, tmp1, ni, nj, nk, nl, di, dj, dk, dl);
        opij += nop * OF_CMPLX;
                                } } } }

        free(tmp1);
        free(tmp2);
}
void c2s_sf_2e2i(double *fijkl, const double *opij,
                 const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int dk = len_spinor(k_sh, bas);
        const unsigned int dl = len_spinor(l_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nk = dk * k_ctr;
        const unsigned int nl = dl * l_ctr;
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2k = nfk + nfk;
        const unsigned int nf2l = nfl + nfl;
        const unsigned int d_k = dk * di * dj;
        const unsigned int d_l = di * dj * nfl;
        const unsigned int nop = nfk * di * dj * nfl;
        unsigned int ofj = ni;
        unsigned int ofk = ni * nj;
        unsigned int ofl = nk * ni * nj;
        unsigned int ic, jc, kc, lc;
        double *pfijkl;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2k*di*dj*nf2l * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * dk*di*dj*nf2l * OF_CMPLX);

        for (lc = 0; lc < nl; lc += dl) {
                for (kc = 0; kc < nk; kc += dk) {
                        for (jc = 0; jc < nj; jc += dj) {
                                for (ic = 0; ic < ni; ic += di) {
        zswap_ik_jl(tmp1, opij, di, dj, nfk, nfl);
        (f_bra_spinor_sf[k_l])(tmp2, dk, d_l, tmp1, k_sh, bas);
        (f_iket_spinor[l_l])(tmp1, d_k, d_k, tmp2, l_sh, bas);
        pfijkl = fijkl + (ofl * lc + ofk * kc + ofj * jc + ic) * OF_CMPLX;

        zcopy_kijl(pfijkl, tmp1, ni, nj, nk, nl, di, dj, dk, dl);
        opij += nop * OF_CMPLX;
                                } } } }

        free(tmp1);
        free(tmp2);
}

/*
 * 2e integrals, cartesian to spinor for electron 1.
 *
 * gctr: Cartesian GTO integrals, ordered as <ik|lj>
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
void c2s_si_2e1(double *opij, const double *gctr,
                const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2i = nfi + nfi;
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfk * nfl * nfj;
        const unsigned int no = di * nfk * nfl * dj;
        const unsigned int d_i = di * nfk * nfl;
        const unsigned int d_j = nfk * nfl * nf2j;
        unsigned int i;
        const double *gc_x = gctr;
        const double *gc_y = gc_x + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        const double *gc_z = gc_y + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        const double *gc_1 = gc_z + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2i*nfk*nfl*nf2j * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nf2j * OF_CMPLX);

        for (i = 0; i < i_ctr * j_ctr * k_ctr * l_ctr; i++) {
                //cmplx( gctr.POS_1, gctr.POS_Z)
                //cmplx( gctr.POS_Y, gctr.POS_X)
                dcmplx_pp(nf, tmp1, gc_1, gc_z);
                dcmplx_pp(nf, tmp1+nf*OF_CMPLX, gc_y, gc_x);
                //cmplx(-gctr.POS_Y, gctr.POS_X)
                //cmplx( gctr.POS_1,-gctr.POS_Z)
                dcmplx_np(nf, tmp1+nfi*d_j*OF_CMPLX, gc_y, gc_x);
                dcmplx_pn(nf, tmp1+nfi*d_j*OF_CMPLX+nf*OF_CMPLX, gc_1, gc_z);
                (f_bra_spinor_si[i_l])(tmp2, di, d_j, tmp1, i_sh, bas);
                (f_ket_spinor[j_l])(opij, d_i, d_i, tmp2, j_sh, bas);
                gc_x += nf;
                gc_y += nf;
                gc_z += nf;
                gc_1 += nf;
                opij += no * OF_CMPLX;
        }

        free(tmp1);
        free(tmp2);
}
void c2s_si_2e1i(double *opij, const double *gctr,
                 const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2i = nfi + nfi;
        const unsigned int nf2j = nfj + nfj;
        const unsigned int nf = nfi * nfk * nfl * nfj;
        const unsigned int no = di * nfk * nfl * dj;
        const unsigned int d_i = di * nfk * nfl;
        const unsigned int d_j = nfk * nfl * nf2j;
        unsigned int i;
        const double *gc_x = gctr;
        const double *gc_y = gc_x + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        const double *gc_z = gc_y + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        const double *gc_1 = gc_z + nf * i_ctr * j_ctr * k_ctr * l_ctr;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2i*nfk*nfl*nf2j * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * di*nfk*nfl*nf2j * OF_CMPLX);

        for (i = 0; i < i_ctr * j_ctr * k_ctr * l_ctr; i++) {
                //cmplx( gctr.POS_1, gctr.POS_Z)
                //cmplx( gctr.POS_Y, gctr.POS_X)
                dcmplx_pp(nf, tmp1, gc_1, gc_z);
                dcmplx_pp(nf, tmp1+nf*OF_CMPLX, gc_y, gc_x);
                //cmplx(-gctr.POS_Y, gctr.POS_X)
                //cmplx( gctr.POS_1,-gctr.POS_Z)
                dcmplx_np(nf, tmp1+nfi*d_j*OF_CMPLX, gc_y, gc_x);
                dcmplx_pn(nf, tmp1+nfi*d_j*OF_CMPLX+nf*OF_CMPLX, gc_1, gc_z);
                (f_bra_spinor_si[i_l])(tmp2, di, d_j, tmp1, i_sh, bas);
                (f_iket_spinor[j_l])(opij, d_i, d_i, tmp2, j_sh, bas);
                gc_x += nf;
                gc_y += nf;
                gc_z += nf;
                gc_1 += nf;
                opij += no * OF_CMPLX;
        }

        free(tmp1);
        free(tmp2);
}

/*
 * 2e integrals, cartesian to spinor for electron 2.
 *
 * opij: partial transformed GTO integrals, ordered as <ik|lj>
 */
static void si2e_swap(double *new, const double *oldx, const double *oldy,
                      const double *oldz, const double *old1,
                      const unsigned int ni, const unsigned int nj,
                      const unsigned int nk, const unsigned int nl)
{
        unsigned int i, j, k, l;
        unsigned int dlo = ni * nk * OF_CMPLX; // shift of (i,k,l++,j)
        unsigned int djo = ni * nk * nl * OF_CMPLX; // shift of (i,k,l,j++)
        unsigned int djn = nk * ni * OF_CMPLX; // shift of (k,i,j++,l)
        unsigned int dln = nk * ni * nj * OF_CMPLX; // shift of (k,i,j,l++)
        double *new11 = new;
        double *new12 = new11 + nk * ni * nj * nl * OF_CMPLX;
        double *new21 = new12 + nk * ni * nj * nl * OF_CMPLX;
        double *new22 = new21 + nk * ni * nj * nl * OF_CMPLX;
        double *pn11, *pn12, *pn21, *pn22;
        const double *ox, *oy, *oz, *o1;
        const double *pox, *poy, *poz, *po1;

        //tmp1(k    ,i,j,l    ) = opij(m,n,POS_1) + IZ1*opij(m,n,POS_Z)
        //tmp1(k    ,i,j,l+nfl) = opij(m,n,POS_Y) + IZ1*opij(m,n,POS_X)
        //tmp1(k+nfk,i,j,l    ) =-opij(m,n,POS_Y) + IZ1*opij(m,n,POS_X)
        //tmp1(k+nfk,i,j,l+nfl) = opij(m,n,POS_1) - IZ1*opij(m,n,POS_Z)
        for (l = 0; l < nl; l++)
                for (j = 0; j < nj; j++) {
                        pn11 = new11 + l * dln + j * djn;
                        pn12 = new12 + l * dln + j * djn;
                        pn21 = new21 + l * dln + j * djn;
                        pn22 = new22 + l * dln + j * djn;
                        ox = oldx + l * dlo + j * djo;
                        oy = oldy + l * dlo + j * djo;
                        oz = oldz + l * dlo + j * djo;
                        o1 = old1 + l * dlo + j * djo;
                        for (i = 0; i < ni * OF_CMPLX; i += OF_CMPLX) {
                                pox = ox + i;
                                poy = oy + i;
                                poz = oz + i;
                                po1 = o1 + i;
                                for (k = 0; k < nk * OF_CMPLX; k += OF_CMPLX) {
                                        pn11[k  ] = po1[0] - poz[1];
                                        pn11[k+1] = po1[1] + poz[0];
                                        pn12[k  ] = poy[0] - pox[1];
                                        pn12[k+1] = poy[1] + pox[0];
                                        pn21[k  ] =-poy[0] - pox[1];
                                        pn21[k+1] =-poy[1] + pox[0];
                                        pn22[k  ] = po1[0] + poz[1];
                                        pn22[k+1] = po1[1] - poz[0];
                                        pox += ni * OF_CMPLX;
                                        poy += ni * OF_CMPLX;
                                        poz += ni * OF_CMPLX;
                                        po1 += ni * OF_CMPLX;
                                }
                                pn11 += nk * OF_CMPLX;
                                pn12 += nk * OF_CMPLX;
                                pn21 += nk * OF_CMPLX;
                                pn22 += nk * OF_CMPLX;
                        }
                }
}
void c2s_si_2e2(double *fijkl, const double *opij,
                const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int dk = len_spinor(k_sh, bas);
        const unsigned int dl = len_spinor(l_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nk = dk * k_ctr;
        const unsigned int nl = dl * l_ctr;
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2k = nfk + nfk;
        const unsigned int nf2l = nfl + nfl;
        const unsigned int d_k = dk * di * dj;
        const unsigned int d_l = di * dj * nf2l;
        const unsigned int nop = nfk * di * dj * nfl;
        unsigned int ofj = ni;
        unsigned int ofk = ni * nj;
        unsigned int ofl = nk * ni * nj;
        unsigned int ic, jc, kc, lc;
        double *pfijkl;
        const double *ox = opij;
        const double *oy = ox + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        const double *oz = oy + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        const double *o1 = oz + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2k*di*dj*nf2l * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * dk*di*dj*nf2l * OF_CMPLX);

        for (lc = 0; lc < nl; lc += dl) {
                for (kc = 0; kc < nk; kc += dk) {
                        for (jc = 0; jc < nj; jc += dj) {
                                for (ic = 0; ic < ni; ic += di) {
        si2e_swap(tmp1, ox, oy, oz, o1, di, dj, nfk, nfl);
        (f_bra_spinor_si[k_l])(tmp2, dk, d_l, tmp1, k_sh, bas);
        (f_ket_spinor[l_l])(tmp1, d_k, d_k, tmp2, l_sh, bas);
        pfijkl = fijkl + (ofl * lc + ofk * kc + ofj * jc + ic) * OF_CMPLX;

        zcopy_kijl(pfijkl, tmp1, ni, nj, nk, nl, di, dj, dk, dl);

        ox += nop * OF_CMPLX;
        oy += nop * OF_CMPLX;
        oz += nop * OF_CMPLX;
        o1 += nop * OF_CMPLX;
                                } } } }

        free(tmp1);
        free(tmp2);
}
void c2s_si_2e2i(double *fijkl, const double *opij,
                 const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int di = len_spinor(i_sh, bas);
        const unsigned int dj = len_spinor(j_sh, bas);
        const unsigned int dk = len_spinor(k_sh, bas);
        const unsigned int dl = len_spinor(l_sh, bas);
        const unsigned int ni = di * i_ctr;
        const unsigned int nj = dj * j_ctr;
        const unsigned int nk = dk * k_ctr;
        const unsigned int nl = dl * l_ctr;
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int nf2k = nfk + nfk;
        const unsigned int nf2l = nfl + nfl;
        const unsigned int d_k = dk * di * dj;
        const unsigned int d_l = di * dj * nf2l;
        const unsigned int nop = nfk * di * dj * nfl;
        unsigned int ofj = ni;
        unsigned int ofk = ni * nj;
        unsigned int ofl = nk * ni * nj;
        unsigned int ic, jc, kc, lc;
        double *pfijkl;
        const double *ox = opij;
        const double *oy = ox + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        const double *oz = oy + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        const double *o1 = oz + nop * i_ctr * j_ctr * k_ctr * l_ctr * OF_CMPLX;
        double *const tmp1 = (double *)malloc(sizeof(double) * nf2k*di*dj*nf2l * OF_CMPLX);
        double *const tmp2 = (double *)malloc(sizeof(double) * dk*di*dj*nf2l * OF_CMPLX);

        for (lc = 0; lc < nl; lc += dl) {
                for (kc = 0; kc < nk; kc += dk) {
                        for (jc = 0; jc < nj; jc += dj) {
                                for (ic = 0; ic < ni; ic += di) {
        si2e_swap(tmp1, ox, oy, oz, o1, di, dj, nfk, nfl);
        (f_bra_spinor_si[k_l])(tmp2, dk, d_l, tmp1, k_sh, bas);
        (f_iket_spinor[l_l])(tmp1, d_k, d_k, tmp2, l_sh, bas);
        pfijkl = fijkl + (ofl * lc + ofk * kc + ofj * jc + ic) * OF_CMPLX;

        zcopy_kijl(pfijkl, tmp1, ni, nj, nk, nl, di, dj, dk, dl);

        ox += nop * OF_CMPLX;
        oy += nop * OF_CMPLX;
        oz += nop * OF_CMPLX;
        o1 += nop * OF_CMPLX;
                                } } } }

        free(tmp1);
        free(tmp2);
}

/*
 * 1e integrals, reorder cartesian integrals.
 */
void c2s_cart_1e(double *opij, const double *gctr,
                 const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nf = nfi * nfj;
        const unsigned int ni = nfi * i_ctr;
        const unsigned int nj = nfj * j_ctr;
        unsigned int ic, jc;
        double *popij;

        for (jc = 0; jc < nj; jc += nfj)
                for (ic = 0; ic < ni; ic += nfi) {
                        popij = opij + ni * jc + ic;
                        dcopy_ij(popij, gctr, ni, nj, nfi, nfj);
                        gctr += nf;
                }
}

/*
 * 2e integrals, reorder cartesian integrals.
 */
void c2s_cart_2e1(double *fijkl, const double *gctr,
                  const unsigned int *shls, const int *bas)
{
        const unsigned int i_sh = shls[0];
        const unsigned int j_sh = shls[1];
        const unsigned int k_sh = shls[2];
        const unsigned int l_sh = shls[3];
        const unsigned int i_l = bas(ANG_OF, i_sh);
        const unsigned int j_l = bas(ANG_OF, j_sh);
        const unsigned int k_l = bas(ANG_OF, k_sh);
        const unsigned int l_l = bas(ANG_OF, l_sh);
        const unsigned int i_ctr = bas(NCTR_OF, i_sh);
        const unsigned int j_ctr = bas(NCTR_OF, j_sh);
        const unsigned int k_ctr = bas(NCTR_OF, k_sh);
        const unsigned int l_ctr = bas(NCTR_OF, l_sh);
        const unsigned int nfi = len_cart(i_l);
        const unsigned int nfj = len_cart(j_l);
        const unsigned int nfk = len_cart(k_l);
        const unsigned int nfl = len_cart(l_l);
        const unsigned int ni = nfi * i_ctr;
        const unsigned int nj = nfj * j_ctr;
        const unsigned int nk = nfk * k_ctr;
        const unsigned int nl = nfl * l_ctr;
        const unsigned int nf = nfk * nfi * nfj * nfl;
        unsigned int ofj = ni;
        unsigned int ofk = ni * nj;
        unsigned int ofl = nk * ni * nj;
        unsigned int ic, jc, kc, lc;
        double *pfijkl;

        for (lc = 0; lc < nl; lc += nfl)
                for (kc = 0; kc < nk; kc += nfk)
                        for (jc = 0; jc < nj; jc += nfj)
                                for (ic = 0; ic < ni; ic += nfi) {
        pfijkl = fijkl + ofl * lc + ofk * kc + ofj * jc + ic;
        dcopy_kijl(pfijkl, gctr, ni, nj, nk, nl, nfi, nfj, nfk, nfl);
        gctr += nf;
                                }
}
void c2s_cart_2e2() {};

